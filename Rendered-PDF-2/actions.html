<!DOCTYPE html>
<html lang="en-US"><head><meta charset="utf-8"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><link href="https://selwynpolit.github.io/d9book/assets/css/just-the-docs-default.css" rel="stylesheet"/> <script async="" src="https://www.googletagmanager.com/gtag/js?id=8V22RQEJ71"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '8V22RQEJ71', { 'anonymize_ip': true }); </script> <script src="https://selwynpolit.github.io/d9book/assets/js/vendor/lunr.min.js"></script> <script src="https://selwynpolit.github.io/d9book/assets/js/just-the-docs.js"></script><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://selwynpolit.github.io/d9book/assets/images/favicon.ico" rel="icon" type="image/x-icon"/><title>Actions | Drupal Book</title><meta content="Jekyll v4.3.2" name="generator"><meta content="Actions" property="og:title"><meta content="en_US" property="og:locale"><meta content="Drupal at your fingertips" name="description"/><meta content="Drupal at your fingertips" property="og:description"/><link href="https://selwynpolit.github.io/d9book/d9book/actions" rel="canonical"><meta content="https://selwynpolit.github.io/d9book/d9book/actions" property="og:url"/><meta content="Drupal Book" property="og:site_name"/><meta content="website" property="og:type"/><meta content="summary" name="twitter:card"/><meta content="Actions" property="twitter:title"/> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Drupal at your fingertips","headline":"Actions","url":"https://selwynpolit.github.io/d9book/d9book/actions"}</script><body> <a class="skip-to-main" href="https://selwynpolit.github.io/d9book/actions#main-content">Skip to main content</a> <svg class="d-none" xmlns="http://www.w3.org/2000/svg"> <symbol id="svg-link" viewbox="0 0 24 24"><title>Link</title><svg class="feather feather-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"><title>Menu</title><svg class="feather feather-menu" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><line x1="3" x2="21" y1="12" y2="12"></line><line x1="3" x2="21" y1="6" y2="6"></line><line x1="3" x2="21" y1="18" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"><title>Expand</title><svg class="feather feather-chevron-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol class="feather feather-external-link" fill="none" height="24" id="svg-external-link" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"><title>Document</title><svg class="feather feather-file" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"><title>Search</title><svg class="feather feather-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"> <circle cx="11" cy="11" r="8"></circle><line x1="21" x2="16.65" y1="21" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewbox="0 0 16 16"><title>Copy</title><svg class="bi bi-clipboard" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewbox="0 0 16 16"><title>Copied</title><svg class="bi bi-clipboard-check-fill" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a class="site-title lh-tight" href="https://selwynpolit.github.io/d9book/"> Drupal Book </a> <a class="site-button" href="https://selwynpolit.github.io/d9book/actions" id="menu-button"> <svg class="icon" viewbox="0 0 24 24"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" class="site-nav" id="site-nav"><ul class="nav-list"><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/">Home</a><li class="nav-list-item active"><a class="nav-list-link active" href="https://selwynpolit.github.io/d9book/actions">Actions</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/attribution">Attribution</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/bq">Batch and Queue</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/blocks">Blocks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/caching">Caching</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/composer">Composer</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/config">Config</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/cron">Cron</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dates">Dates and Times</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/debugging">Debugging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/development">Development</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/drush">Drush</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/email">Email</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/entities">Entities</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/forms">Forms</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/general">General</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/off-island">Getting off the Island</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/hooks">Hooks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/learn">Learning</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/links">Links</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/logging">Logging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/menus">Menus</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/migrate">Migrate</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/modals">Modals</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/nodes-and-fields">Nodes and Fields</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/queries">Queries</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/redirects">Redirects</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/render">Render Arrays</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/routes">Routes</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/security">Security</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/services">Services</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/state">State</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/taxonomy">Taxonomy</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dtt">Tests</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/twig">Twig</a></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><ul class="nav-list"><li class="nav-list-item external"> <a class="nav-list-link external" href="https://github.com/selwynpolit/d9book/fork"> Fork me on GitHub <svg aria-labelledby="svg-external-link-title" viewbox="0 0 24 24"><use xlink:href="#svg-external-link"></use></svg> </a></li></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div class="main-header" id="main-header"><div class="search"><div class="search-input-wrap"> <input aria-label="Search Drupal Book" autocomplete="off" class="search-input" id="search-input" placeholder="Search Drupal Book" tabindex="0" type="text"/> <label class="search-label" for="search-input"><svg class="search-icon" viewbox="0 0 24 24"><use xlink:href="#svg-search"></use></svg></label></div><div class="search-results" id="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a class="site-button" href="https://twitter.com/selwynpolit" rel="noopener noreferrer" target="_blank"> <img alt="Twitter logo" src="https://atuin.ru/demo/simple-icons/icons/twitter.svg" style="width: 30px; height: 30px;" title="Author in Twitter"/> </a><li class="aux-nav-list-item"> <a class="site-button" href="https://github.com/selwynpolit/d9book/tree/gh-pages" rel="noopener noreferrer" target="_blank"> <img alt="GitHub logo" src="https://atuin.ru/demo/simple-icons/icons/github.svg" style="width: 30px; height: 30px;" title="D9Book on GitHub"/> </a></li></li></ul></nav></div><div class="main-content-wrap" id="main-content-wrap"><div class="main-content" id="main-content" role="main"><h1 class="no_toc fw-500" id="actions"> <a aria-labelledby="actions" class="anchor-heading" href="https://selwynpolit.github.io/d9book/actions#actions"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Actions</h1><h2 class="no_toc text-delta" id="table-of-contentse"> <a aria-labelledby="table-of-contentse" class="anchor-heading" href="https://selwynpolit.github.io/d9book/actions#table-of-contentse"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Table of contentse</h2><ul id="markdown-toc"><li><a href="https://selwynpolit.github.io/d9book/actions#overview" id="markdown-toc-overview">Overview</a><li><a href="https://selwynpolit.github.io/d9book/actions#custom-actions" id="markdown-toc-custom-actions">Custom Actions</a><li><a href="https://selwynpolit.github.io/d9book/actions#archive-node-action-simple" id="markdown-toc-archive-node-action-simple">Archive Node Action (simple)</a><li><a href="https://selwynpolit.github.io/d9book/actions#update-node-title-custom-action-plugin-with-configuration" id="markdown-toc-update-node-title-custom-action-plugin-with-configuration">Update Node Title Custom Action Plugin with Configuration</a><li><a href="https://selwynpolit.github.io/d9book/actions#reference" id="markdown-toc-reference">Reference</a></li></li></li></li></li></ul><p><img alt="views" src="https://api.visitor.plantree.me/visitor-badge/pv?label=views&amp;color=informational&amp;namespace=d9book&amp;key=actions.md"/></p><hr/><h2 id="overview"> <a aria-labelledby="overview" class="anchor-heading" href="https://selwynpolit.github.io/d9book/actions#overview"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Overview</h2><p>The Actions module is a core module in Drupal 9 that allows site builders and developers to create automated workflows by defining actions and triggers. In Drupal, actions refer to a set of tasks or operations that can be performed on a site. For example, an action can be sending an email, publishing content, or updating a database record.</p><p>With the Actions module, you can create a customized workflow that can be triggered by a specific event. For example, when a user submits a form on your website, you can trigger an action to send an email notification to the site administrator. You can also chain multiple actions together to create complex workflows.</p><p>The Actions module provides a user-friendly interface for defining and managing actions. You can create custom actions using PHP code (see below) or use pre-defined actions provided by Drupal core or contributed modules. The module also provides a way to organize and categorize actions, making it easy to find and use them in your workflows.</p><p>TL;DR: The Actions module provides a powerful and flexible way to automate tasks on your website by defining actions and triggers, allowing you to create customized workflows that improve your site’s functionality and user experience. - ChatGPT (with minor tweaks on my part.)</p><p>From the config page in Drupal:</p><blockquote><p>There are two types of actions: simple and advanced. Simple actions do not require any additional configuration and are listed here automatically. Advanced actions need to be created and configured before they can be used because they have options that need to be specified; for example, sending an email to a specified address or unpublishing content containing certain words. To create an advanced action, select the action from the drop-down list in the advanced action section below and click the Create button.</p></blockquote><p class="note">The <a href="https://www.drupal.org/project/eca">ECA module</a> can use Drupal core actions (and events) if you need to do even more.</p><h2 id="custom-actions"> <a aria-labelledby="custom-actions" class="anchor-heading" href="https://selwynpolit.github.io/d9book/actions#custom-actions"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Custom Actions</h2><p>Here, A Drupal action is a fuctionality which performs specific action when executed. For example, Archive Node or Make Content Sticky.</p><p>Actions use the annotation class <code class="language-plaintext highlighter-rouge">Drupal\Core\Annotation\Action</code>, and extend <code class="language-plaintext highlighter-rouge">Drupal\Core\Action\ActionBase</code> or <code class="language-plaintext highlighter-rouge">Drupal\Core\Action\ConfigurableActionBase</code> (if the action is configurable.)</p><p>Action Plugin definition is defined in Plugin Annotation. It has 3 required keys</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cd">/**
 * Provides an Archive Node Action.
 *
 * @Action(
 *   id = "action_plugin_examples_archive_node",
 *   label = @Translation("Archive Node"),
 *   type = "node",
 *   category = @Translation("Custom")
 * )
 */</span>

</code></pre></div></div><p>id –&gt; ID of the Action Plugin</p><p>label –&gt; Name of the Action Plugin</p><p>type –&gt; Entity type to which the Action Plugin belongs to</p><p>category –&gt; (optional) Category of the Action Plugin</p><h2 id="archive-node-action-simple"> <a aria-labelledby="archive-node-action-simple" class="anchor-heading" href="https://selwynpolit.github.io/d9book/actions#archive-node-action-simple"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Archive Node Action (simple)</h2><p>This is a simple action which requires no configuration. When it is run, it changes the alias of the node to /archive/<year>/<old alias="">. It also sets the title to have the word `Archive` in the front of it. Finally it disables the sticky and promoted flags. [It is also on gitlab here.](https://git.drupalcode.org/sandbox/Bhanu951-3103712/-/blob/8.x-dev/action_plugin_examples/src/Plugin/Action/ArchiveNode.php)</old></year></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">Drupal\action_plugin_examples\Plugin\Action</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Drupal\Core\Action\ActionBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Session\AccountInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Plugin\ContainerFactoryPluginInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\DependencyInjection\ContainerInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\pathauto\PathautoState</span><span class="p">;</span>

<span class="cd">/**
 * Provides an Archive Node Action.
 *
 * @Action(
 *   id = "action_plugin_examples_archive_node",
 *   label = @Translation("Archive Node"),
 *   type = "node",
 *   category = @Translation("Custom")
 * )
 */</span>
<span class="kd">class</span> <span class="nc">ArchiveNode</span> <span class="kd">extends</span> <span class="nc">ActionBase</span> <span class="kd">implements</span> <span class="nc">ContainerFactoryPluginInterface</span> <span class="p">{</span>


  <span class="cd">/**
   * The Messenger service.
   *
   * @var \Drupal\Core\Messenger\MessengerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$messenger</span><span class="p">;</span>

  <span class="cd">/**
   * Logger service.
   *
   * @var \Drupal\Core\Logger\LoggerChannelFactoryInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$logger</span><span class="p">;</span>

  <span class="cd">/**
   * The path alias manager.
   *
   * @var \Drupal\path_alias\AliasManagerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$aliasManager</span><span class="p">;</span>

  <span class="cd">/**
   * Language manager for retrieving the default Langcode.
   *
   * @var \Drupal\Core\Language\LanguageManagerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$languageManager</span><span class="p">;</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">create</span><span class="p">(</span><span class="kt">ContainerInterface</span> <span class="nv">$container</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$configuration</span><span class="p">,</span> <span class="nv">$plugin_id</span><span class="p">,</span> <span class="nv">$plugin_definition</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">static</span><span class="p">(</span><span class="nv">$configuration</span><span class="p">,</span> <span class="nv">$plugin_id</span><span class="p">,</span> <span class="nv">$plugin_definition</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">logger</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'logger.factory'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'action_plugin_examples'</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">messenger</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'messenger'</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">aliasManager</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'path_alias.manager'</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">languageManager</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'language_manager'</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$instance</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">access</span><span class="p">(</span><span class="nv">$node</span><span class="p">,</span> <span class="kt">AccountInterface</span> <span class="nv">$account</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="nv">$return_as_object</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="p">{</span>
    <span class="cd">/** @var \Drupal\node\NodeInterface $node */</span>
    <span class="nv">$access</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">access</span><span class="p">(</span><span class="s1">'update'</span><span class="p">,</span> <span class="nv">$account</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">)</span>
      <span class="o">-&gt;</span><span class="nf">andIf</span><span class="p">(</span><span class="nv">$node</span><span class="o">-&gt;</span><span class="n">title</span><span class="o">-&gt;</span><span class="nf">access</span><span class="p">(</span><span class="s1">'edit'</span><span class="p">,</span> <span class="nv">$account</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$return_as_object</span> <span class="o">?</span> <span class="nv">$access</span> <span class="o">:</span> <span class="nv">$access</span><span class="o">-&gt;</span><span class="nf">isAllowed</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">execute</span><span class="p">(</span><span class="nv">$node</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span> <span class="p">{</span>

    <span class="cd">/** @var \Drupal\node\NodeInterface $node */</span>

    <span class="nv">$language</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">languageManager</span><span class="o">-&gt;</span><span class="nf">getCurrentLanguage</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getId</span><span class="p">();</span>

    <span class="nv">$old_alias</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">aliasManager</span><span class="o">-&gt;</span><span class="nf">getAliasByPath</span><span class="p">(</span><span class="s1">'/node/'</span> <span class="mf">.</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">(),</span> <span class="nv">$language</span><span class="p">);</span>

    <span class="nv">$title</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">getTitle</span><span class="p">();</span>
    <span class="nv">$date</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="n">created</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
    <span class="nv">$year</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y'</span><span class="p">,</span> <span class="nv">$date</span><span class="p">);</span>
    <span class="c1">// $old_alias = $node-&gt;path-&gt;alias;</span>
    <span class="nv">$new_title</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'[Archive] | @title'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'@title'</span> <span class="o">=&gt;</span> <span class="nv">$title</span><span class="p">]);</span>
    <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">setTitle</span><span class="p">(</span><span class="nv">$new_title</span><span class="p">);</span>
    <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">setSticky</span><span class="p">(</span><span class="kc">FALSE</span><span class="p">);</span>
    <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">setPromoted</span><span class="p">(</span><span class="kc">FALSE</span><span class="p">);</span>

    <span class="nv">$new_alias</span> <span class="o">=</span> <span class="s1">'/archive/'</span> <span class="mf">.</span> <span class="nv">$year</span> <span class="mf">.</span> <span class="nv">$old_alias</span><span class="p">;</span>
    <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">set</span><span class="p">(</span><span class="s2">"path"</span><span class="p">,</span> <span class="p">[</span>
      <span class="s1">'alias'</span> <span class="o">=&gt;</span> <span class="nv">$new_alias</span><span class="p">,</span>
      <span class="s1">'langcode'</span> <span class="o">=&gt;</span> <span class="nv">$language</span><span class="p">,</span>
      <span class="s1">'pathauto'</span> <span class="o">=&gt;</span> <span class="nc">PathautoState</span><span class="o">::</span><span class="no">SKIP</span><span class="p">,</span>
    <span class="p">]);</span>

    <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">save</span><span class="p">();</span>

    <span class="nv">$message</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Node with NID : @id Archived.'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'@id'</span> <span class="o">=&gt;</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">()]);</span>

    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">logger</span><span class="o">-&gt;</span><span class="nf">notice</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">messenger</span><span class="o">-&gt;</span><span class="nf">addMessage</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>

  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>In order to get Action Plugin Discoverable you need to add <code class="language-plaintext highlighter-rouge">system.action.&lt;plugin_id&gt;.yml</code> which is placed in <code class="language-plaintext highlighter-rouge">config/install</code></p><p>The structure of the <code class="language-plaintext highlighter-rouge">.yml</code> file is shown below:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">langcode</span><span class="pi">:</span> <span class="s">en</span>
<span class="na">status</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">id</span><span class="pi">:</span> <span class="s">action_plugin_examples_archive_node</span>
<span class="na">label</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Archive</span><span class="nv"> </span><span class="s">Node'</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">node</span>
<span class="na">plugin</span><span class="pi">:</span> <span class="s">action_plugin_examples_archive_node</span>
</code></pre></div></div><p>Created Action Plugin can be viewed on the <code class="language-plaintext highlighter-rouge">/admin/content</code> page.</p><p><img alt="actions-list" src="https://github.com/bhanu951/d9book/assets/8525040/40d4e78a-b0e8-40e1-bd7d-58998fab3168" width="1476"/></p><h2 id="update-node-title-custom-action-plugin-with-configuration"> <a aria-labelledby="update-node-title-custom-action-plugin-with-configuration" class="anchor-heading" href="https://selwynpolit.github.io/d9book/actions#update-node-title-custom-action-plugin-with-configuration"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Update Node Title Custom Action Plugin with Configuration</h2><p>This example updates a node title. It gets the new title info from configuration. <a href="https://git.drupalcode.org/sandbox/Bhanu951-3103712/-/blob/8.x-dev/action_plugin_examples/src/Plugin/Action/UpdateNodeTitle.php">It is also here on Gitlab.</a></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">Drupal\action_plugin_examples\Plugin\Action</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Drupal\Core\Action\ConfigurableActionBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormStateInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Session\AccountInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Plugin\ContainerFactoryPluginInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\DependencyInjection\ContainerInterface</span><span class="p">;</span>

<span class="cd">/**
 * Provides an Update Node Title Action.
 *
 * @Action(
 *   id = "action_plugin_examples_update_node_title",
 *   label = @Translation("Update Node title"),
 *   type = "node",
 *   category = @Translation("Custom")
 * )
 */</span>
<span class="kd">class</span> <span class="nc">UpdateNodeTitle</span> <span class="kd">extends</span> <span class="nc">ConfigurableActionBase</span> <span class="kd">implements</span> <span class="nc">ContainerFactoryPluginInterface</span> <span class="p">{</span>

  <span class="cd">/**
   * The Messenger service.
   *
   * @var \Drupal\Core\Messenger\MessengerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$messenger</span><span class="p">;</span>

  <span class="cd">/**
   * Logger service.
   *
   * @var \Drupal\Core\Logger\LoggerChannelFactoryInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$logger</span><span class="p">;</span>

  <span class="cd">/**
   * The path alias manager.
   *
   * @var \Drupal\path_alias\AliasManagerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$aliasManager</span><span class="p">;</span>

  <span class="cd">/**
   * Language manager for retrieving the default Langcode.
   *
   * @var \Drupal\Core\Language\LanguageManagerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$languageManager</span><span class="p">;</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">create</span><span class="p">(</span><span class="kt">ContainerInterface</span> <span class="nv">$container</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$configuration</span><span class="p">,</span> <span class="nv">$plugin_id</span><span class="p">,</span> <span class="nv">$plugin_definition</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">static</span><span class="p">(</span><span class="nv">$configuration</span><span class="p">,</span> <span class="nv">$plugin_id</span><span class="p">,</span> <span class="nv">$plugin_definition</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">logger</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'logger.factory'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'action_plugin_examples'</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">messenger</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'messenger'</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">aliasManager</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'path_alias.manager'</span><span class="p">);</span>
    <span class="nv">$instance</span><span class="o">-&gt;</span><span class="n">languageManager</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'language_manager'</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$instance</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">defaultConfiguration</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'Updated New Title'</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">buildConfigurationForm</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'New Title'</span><span class="p">),</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'textfield'</span><span class="p">,</span>
      <span class="s1">'#required'</span> <span class="o">=&gt;</span> <span class="kc">TRUE</span><span class="p">,</span>
      <span class="s1">'#default_value'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">configuration</span><span class="p">[</span><span class="s1">'title'</span><span class="p">],</span>
    <span class="p">];</span>
    <span class="k">return</span> <span class="nv">$form</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">submitConfigurationForm</span><span class="p">(</span><span class="kt">array</span> <span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">configuration</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">getValue</span><span class="p">(</span><span class="s1">'title'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">access</span><span class="p">(</span><span class="nv">$node</span><span class="p">,</span> <span class="kt">AccountInterface</span> <span class="nv">$account</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="nv">$return_as_object</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="p">{</span>
    <span class="cd">/** @var \Drupal\node\NodeInterface $node */</span>
    <span class="nv">$access</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">access</span><span class="p">(</span><span class="s1">'update'</span><span class="p">,</span> <span class="nv">$account</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">)</span>
      <span class="o">-&gt;</span><span class="nf">andIf</span><span class="p">(</span><span class="nv">$node</span><span class="o">-&gt;</span><span class="n">title</span><span class="o">-&gt;</span><span class="nf">access</span><span class="p">(</span><span class="s1">'edit'</span><span class="p">,</span> <span class="nv">$account</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$return_as_object</span> <span class="o">?</span> <span class="nv">$access</span> <span class="o">:</span> <span class="nv">$access</span><span class="o">-&gt;</span><span class="nf">isAllowed</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">execute</span><span class="p">(</span><span class="nv">$node</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="cd">/** @var \Drupal\node\NodeInterface $node */</span>
    <span class="nv">$old_title</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">getTitle</span><span class="p">();</span>
    <span class="nv">$updated_title</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'@new_title @old_title'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'@old_title'</span> <span class="o">=&gt;</span> <span class="nv">$old_title</span><span class="p">,</span> <span class="s1">'@new_title'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">configuration</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]]);</span>

    <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">setTitle</span><span class="p">(</span><span class="nv">$updated_title</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">save</span><span class="p">();</span>

    <span class="nv">$message</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Node Title for Node with NID : @id Updated.'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'@id'</span> <span class="o">=&gt;</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">()]);</span>

    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">logger</span><span class="o">-&gt;</span><span class="nf">notice</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">messenger</span><span class="o">-&gt;</span><span class="nf">addMessage</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>

</code></pre></div></div><p>The Schema for Action Plugin <code class="language-plaintext highlighter-rouge">action_plugin_examples.schema.yml</code> which is in <code class="language-plaintext highlighter-rouge">config/schema</code>:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">action_plugin_examples.configuration.action_plugin_examples_update_node_title</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">mapping</span>
  <span class="na">label</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Configuration</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">"Update</span><span class="nv"> </span><span class="s">node</span><span class="nv"> </span><span class="s">title"</span><span class="nv"> </span><span class="s">action'</span>
  <span class="na">mapping</span><span class="pi">:</span>
    <span class="na">title</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
      <span class="na">label</span><span class="pi">:</span> <span class="s">Title</span>
</code></pre></div></div><p>Action Plugin Definition <code class="language-plaintext highlighter-rouge">system.action.&lt;plugin_id&gt;.yml</code> is in <code class="language-plaintext highlighter-rouge">config/install</code>:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">langcode</span><span class="pi">:</span> <span class="s">en</span>
<span class="na">status</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">dependencies</span><span class="pi">:</span>
  <span class="na">module</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">node</span>
    <span class="pi">-</span> <span class="s">pathauto</span>
<span class="na">id</span><span class="pi">:</span> <span class="s">action_plugin_examples_update_node_title</span>
<span class="na">label</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Update</span><span class="nv"> </span><span class="s">Node</span><span class="nv"> </span><span class="s">Title'</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">node</span>
<span class="na">plugin</span><span class="pi">:</span> <span class="s">action_plugin_examples_update_node_title</span>
<span class="na">configuration</span><span class="pi">:</span>
  <span class="na">title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Updated</span><span class="nv"> </span><span class="s">New</span><span class="nv"> </span><span class="s">Title'</span>
</code></pre></div></div><p>Note. You need to install the core module Actions first to be able to configure action plugins in UI.</p><p>Configuration Page <code class="language-plaintext highlighter-rouge">/admin/config/system/actions</code></p><p>On the top of the page your new plugin should be present in the select list for creating advanced actions. When you select the plugin you should see the configuration form of your plugin:</p><p>See the <a href="https://www.drupal.org/node/2020549">change record: Actions are now plugins, configured actions are configuration entities</a></p><h2 id="reference"> <a aria-labelledby="reference" class="anchor-heading" href="https://selwynpolit.github.io/d9book/actions#reference"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Reference</h2><ul><li><a href="https://www.drupal.org/docs/8/core/modules/action/overview">Actions UI module overview updated January 2023</a><li><a href="https://www.drupal.org/node/2020549">Change Record - Actions are now plugins, configured actions are configuration entities</a><li><a href="https://www.drupal.org/project/eca">ECA: Event-Condition-Action - no-code solution to orchestrate your Drupal site</a></li></li></li></ul><hr/> <script async="" crossorigin="anonymous" data-category="Q&amp;A" data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyMjY2NDE4" data-emit-metadata="0" data-input-position="bottom" data-lang="en" data-mapping="title" data-reactions-enabled="1" data-repo="selwynpolit/d9book" data-repo-id="MDEwOlJlcG9zaXRvcnkzMjUxNTQ1Nzg=" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"> </script><hr/><footer><p><a href="https://selwynpolit.github.io/d9book/actions#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0"><span xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"> <a href="http://www.selwynpolit.github.io/d9book" property="dct:title" rel="cc:attributionURL">Drupal at your fingertips</a> by <a href="http://www.drupal.org/u/selwynpolit" property="cc:attributionName" rel="cc:attributionURL dct:creator">Selwyn Polit</a> is licensed under <a href="http://creativecommons.org/licenses/by/4.0/" rel="license noopener noreferrer" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height:16px!important;vertical-align:text-bottom;"/> <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height:16px!important;vertical-align:text-bottom;"/> </a></span></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0 mr-2"> Page last modified: <span class="d-inline-block">May 13 2023</span>.</p><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/selwynpolit/d9book/tree/gh-pages/book/actions.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
</body></link></meta></meta></meta></head></html>