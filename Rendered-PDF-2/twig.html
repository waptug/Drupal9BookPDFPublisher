<!DOCTYPE html>
<html lang="en-US"><head><meta charset="utf-8"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><link href="https://selwynpolit.github.io/d9book/assets/css/just-the-docs-default.css" rel="stylesheet"/> <script async="" src="https://www.googletagmanager.com/gtag/js?id=8V22RQEJ71"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '8V22RQEJ71', { 'anonymize_ip': true }); </script> <script src="https://selwynpolit.github.io/d9book/assets/js/vendor/lunr.min.js"></script> <script src="https://selwynpolit.github.io/d9book/assets/js/just-the-docs.js"></script><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://selwynpolit.github.io/d9book/assets/images/favicon.ico" rel="icon" type="image/x-icon"/><title>Twig | Drupal Book</title><meta content="Jekyll v4.3.2" name="generator"><meta content="Twig" property="og:title"><meta content="en_US" property="og:locale"><meta content="Drupal at your fingertips" name="description"/><meta content="Drupal at your fingertips" property="og:description"/><link href="https://selwynpolit.github.io/d9book/d9book/twig" rel="canonical"><meta content="https://selwynpolit.github.io/d9book/d9book/twig" property="og:url"/><meta content="Drupal Book" property="og:site_name"/><meta content="website" property="og:type"/><meta content="summary" name="twitter:card"/><meta content="Twig" property="twitter:title"/> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Drupal at your fingertips","headline":"Twig","url":"https://selwynpolit.github.io/d9book/d9book/twig"}</script><body> <a class="skip-to-main" href="https://selwynpolit.github.io/d9book/twig#main-content">Skip to main content</a> <svg class="d-none" xmlns="http://www.w3.org/2000/svg"> <symbol id="svg-link" viewbox="0 0 24 24"><title>Link</title><svg class="feather feather-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"><title>Menu</title><svg class="feather feather-menu" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><line x1="3" x2="21" y1="12" y2="12"></line><line x1="3" x2="21" y1="6" y2="6"></line><line x1="3" x2="21" y1="18" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"><title>Expand</title><svg class="feather feather-chevron-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol class="feather feather-external-link" fill="none" height="24" id="svg-external-link" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"><title>Document</title><svg class="feather feather-file" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"><title>Search</title><svg class="feather feather-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"> <circle cx="11" cy="11" r="8"></circle><line x1="21" x2="16.65" y1="21" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewbox="0 0 16 16"><title>Copy</title><svg class="bi bi-clipboard" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewbox="0 0 16 16"><title>Copied</title><svg class="bi bi-clipboard-check-fill" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a class="site-title lh-tight" href="https://selwynpolit.github.io/d9book/"> Drupal Book </a> <a class="site-button" href="https://selwynpolit.github.io/d9book/twig" id="menu-button"> <svg class="icon" viewbox="0 0 24 24"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" class="site-nav" id="site-nav"><ul class="nav-list"><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/">Home</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/actions">Actions</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/attribution">Attribution</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/bq">Batch and Queue</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/blocks">Blocks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/caching">Caching</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/composer">Composer</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/config">Config</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/cron">Cron</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dates">Dates and Times</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/debugging">Debugging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/development">Development</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/drush">Drush</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/email">Email</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/entities">Entities</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/forms">Forms</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/general">General</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/off-island">Getting off the Island</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/hooks">Hooks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/learn">Learning</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/links">Links</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/logging">Logging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/menus">Menus</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/migrate">Migrate</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/modals">Modals</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/nodes-and-fields">Nodes and Fields</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/queries">Queries</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/redirects">Redirects</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/render">Render Arrays</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/routes">Routes</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/security">Security</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/services">Services</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/state">State</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/taxonomy">Taxonomy</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dtt">Tests</a><li class="nav-list-item active"><a class="nav-list-link active" href="https://selwynpolit.github.io/d9book/twig">Twig</a></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><ul class="nav-list"><li class="nav-list-item external"> <a class="nav-list-link external" href="https://github.com/selwynpolit/d9book/fork"> Fork me on GitHub <svg aria-labelledby="svg-external-link-title" viewbox="0 0 24 24"><use xlink:href="#svg-external-link"></use></svg> </a></li></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div class="main-header" id="main-header"><div class="search"><div class="search-input-wrap"> <input aria-label="Search Drupal Book" autocomplete="off" class="search-input" id="search-input" placeholder="Search Drupal Book" tabindex="0" type="text"/> <label class="search-label" for="search-input"><svg class="search-icon" viewbox="0 0 24 24"><use xlink:href="#svg-search"></use></svg></label></div><div class="search-results" id="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a class="site-button" href="https://twitter.com/selwynpolit" rel="noopener noreferrer" target="_blank"> <img alt="Twitter logo" src="https://atuin.ru/demo/simple-icons/icons/twitter.svg" style="width: 30px; height: 30px;" title="Author in Twitter"/> </a><li class="aux-nav-list-item"> <a class="site-button" href="https://github.com/selwynpolit/d9book/tree/gh-pages" rel="noopener noreferrer" target="_blank"> <img alt="GitHub logo" src="https://atuin.ru/demo/simple-icons/icons/github.svg" style="width: 30px; height: 30px;" title="D9Book on GitHub"/> </a></li></li></ul></nav></div><div class="main-content-wrap" id="main-content-wrap"><div class="main-content" id="main-content" role="main"><h1 class="no_toc fw-500" id="twig"> <a aria-labelledby="twig" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#twig"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> TWIG</h1><h2 class="no_toc text-delta" id="table-of-contents"> <a aria-labelledby="table-of-contents" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#table-of-contents"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ul id="markdown-toc"><li><a href="https://selwynpolit.github.io/d9book/twig#overview" id="markdown-toc-overview">Overview</a><ul><li><a href="https://selwynpolit.github.io/d9book/twig#theme-system-overview" id="markdown-toc-theme-system-overview">Theme System Overview</a><li><a href="https://selwynpolit.github.io/d9book/twig#twig-templating-engine" id="markdown-toc-twig-templating-engine">Twig Templating Engine</a></li></li></ul><li><a href="https://selwynpolit.github.io/d9book/twig#displaying-data" id="markdown-toc-displaying-data">Displaying Data</a><ul><li><a href="https://selwynpolit.github.io/d9book/twig#fields-or-logic" id="markdown-toc-fields-or-logic">Fields or Logic</a><li><a href="https://selwynpolit.github.io/d9book/twig#which-template-which-variables" id="markdown-toc-which-template-which-variables">Which template, which variables?</a><li><a href="https://selwynpolit.github.io/d9book/twig#display-fields-or-variables" id="markdown-toc-display-fields-or-variables">Display fields or variables</a><li><a href="https://selwynpolit.github.io/d9book/twig#node-title-with-and-without-a-link" id="markdown-toc-node-title-with-and-without-a-link">Node Title with and without a link</a><li><a href="https://selwynpolit.github.io/d9book/twig#fields" id="markdown-toc-fields">Fields</a><li><a href="https://selwynpolit.github.io/d9book/twig#paragraph-field" id="markdown-toc-paragraph-field">Paragraph field</a><li><a href="https://selwynpolit.github.io/d9book/twig#loop-thru-paragraph-reference-fields" id="markdown-toc-loop-thru-paragraph-reference-fields">Loop thru paragraph reference fields</a><li><a href="https://selwynpolit.github.io/d9book/twig#body" id="markdown-toc-body">Body</a><li><a href="https://selwynpolit.github.io/d9book/twig#multi-value-fields" id="markdown-toc-multi-value-fields">Multi-value fields</a><li><a href="https://selwynpolit.github.io/d9book/twig#fields-with-html" id="markdown-toc-fields-with-html">Fields with HTML</a><li><a href="https://selwynpolit.github.io/d9book/twig#the-datetime-a-node-is-published-updated-or-created" id="markdown-toc-the-datetime-a-node-is-published-updated-or-created">The date/time a node is published, updated or created</a><li><a href="https://selwynpolit.github.io/d9book/twig#format-a-date-field" id="markdown-toc-format-a-date-field">Format a date field</a><li><a href="https://selwynpolit.github.io/d9book/twig#smart-date-field-formatting" id="markdown-toc-smart-date-field-formatting">Smart date field formatting</a><li><a href="https://selwynpolit.github.io/d9book/twig#entity-reference-field" id="markdown-toc-entity-reference-field">Entity Reference field</a><li><a href="https://selwynpolit.github.io/d9book/twig#entity-reference-destination-content" id="markdown-toc-entity-reference-destination-content">Entity reference destination content</a><li><a href="https://selwynpolit.github.io/d9book/twig#taxonomy-term" id="markdown-toc-taxonomy-term">Taxonomy term</a><li><a href="https://selwynpolit.github.io/d9book/twig#render-a-block" id="markdown-toc-render-a-block">Render a block</a><li><a href="https://selwynpolit.github.io/d9book/twig#render-a-list-created-in-the-template_preprocess_node" id="markdown-toc-render-a-list-created-in-the-template_preprocess_node">Render a list created in the template_preprocess_node()</a><li><a href="https://selwynpolit.github.io/d9book/twig#links" id="markdown-toc-links">Links</a><li><a href="https://selwynpolit.github.io/d9book/twig#links-to-other-pages-on-site" id="markdown-toc-links-to-other-pages-on-site">Links to other pages on site</a><li><a href="https://selwynpolit.github.io/d9book/twig#link-to-a-user-using-user-id" id="markdown-toc-link-to-a-user-using-user-id">Link to a user using user id</a><li><a href="https://selwynpolit.github.io/d9book/twig#external-link-in-a-field-via-an-entity-reference" id="markdown-toc-external-link-in-a-field-via-an-entity-reference">External link in a field via an entity reference</a><li><a href="https://selwynpolit.github.io/d9book/twig#render-an-internal-link-programatically" id="markdown-toc-render-an-internal-link-programatically">Render an internal link programatically</a><li><a href="https://selwynpolit.github.io/d9book/twig#render-an-image-with-an-image-style" id="markdown-toc-render-an-image-with-an-image-style">Render an image with an image style</a><li><a href="https://selwynpolit.github.io/d9book/twig#hide-if-there-is-no-content-in-a-field-or-image" id="markdown-toc-hide-if-there-is-no-content-in-a-field-or-image">Hide if there is no content in a field or image</a><li><a href="https://selwynpolit.github.io/d9book/twig#hide-if-there-is-no-image-present" id="markdown-toc-hide-if-there-is-no-image-present">Hide if there is no image present</a><li><a href="https://selwynpolit.github.io/d9book/twig#attributes" id="markdown-toc-attributes">Attributes</a><li><a href="https://selwynpolit.github.io/d9book/twig#output-the-content-but-leave-off-the-field_image" id="markdown-toc-output-the-content-but-leave-off-the-field_image">Output the content but leave off the field_image</a><li><a href="https://selwynpolit.github.io/d9book/twig#add-a-class" id="markdown-toc-add-a-class">Add a class</a><li><a href="https://selwynpolit.github.io/d9book/twig#add-a-class-conditionally" id="markdown-toc-add-a-class-conditionally">Add a class conditionally</a><li><a href="https://selwynpolit.github.io/d9book/twig#links-to-other-pages-on-site-1" id="markdown-toc-links-to-other-pages-on-site-1">Links to other pages on site</a><li><a href="https://selwynpolit.github.io/d9book/twig#loopindex-in-a-paragraph-twig-template" id="markdown-toc-loopindex-in-a-paragraph-twig-template">Loop.index in a paragraph twig template</a><li><a href="https://selwynpolit.github.io/d9book/twig#loop-thru-an-array-of-items-with-a-separator" id="markdown-toc-loop-thru-an-array-of-items-with-a-separator">Loop thru an array of items with a separator</a></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><li><a href="https://selwynpolit.github.io/d9book/twig#add-javascript-into-a-twig-template" id="markdown-toc-add-javascript-into-a-twig-template">Add Javascript into a twig template</a><li><a href="https://selwynpolit.github.io/d9book/twig#controllogic" id="markdown-toc-controllogic">Control/Logic</a><ul><li><a href="https://selwynpolit.github.io/d9book/twig#concatenate-values-into-a-string-with-join" id="markdown-toc-concatenate-values-into-a-string-with-join">Concatenate values into a string with join</a><li><a href="https://selwynpolit.github.io/d9book/twig#include-partial-templates" id="markdown-toc-include-partial-templates">Include partial templates</a><li><a href="https://selwynpolit.github.io/d9book/twig#loop-through-entity-reference-items" id="markdown-toc-loop-through-entity-reference-items">Loop through entity reference items</a><li><a href="https://selwynpolit.github.io/d9book/twig#if-or" id="markdown-toc-if-or">IF OR</a><li><a href="https://selwynpolit.github.io/d9book/twig#test-if-a-formatted-text-field-is-empty" id="markdown-toc-test-if-a-formatted-text-field-is-empty">Test if a formatted text field is empty</a><li><a href="https://selwynpolit.github.io/d9book/twig#test-empty-variable" id="markdown-toc-test-empty-variable">Test empty variable</a><li><a href="https://selwynpolit.github.io/d9book/twig#conditionals-empty-defined-even" id="markdown-toc-conditionals-empty-defined-even">Conditionals (empty, defined, even)</a><li><a href="https://selwynpolit.github.io/d9book/twig#test-if-a-paragraph-is-empty-using-striptags" id="markdown-toc-test-if-a-paragraph-is-empty-using-striptags">Test if a paragraph is empty using striptags</a><li><a href="https://selwynpolit.github.io/d9book/twig#comparing-strings" id="markdown-toc-comparing-strings">Comparing strings</a><li><a href="https://selwynpolit.github.io/d9book/twig#include-other-templates-as-partials" id="markdown-toc-include-other-templates-as-partials">Include other templates as partials</a><li><a href="https://selwynpolit.github.io/d9book/twig#check-if-an-attribute-has-a-class" id="markdown-toc-check-if-an-attribute-has-a-class">Check if an attribute has a class</a><li><a href="https://selwynpolit.github.io/d9book/twig#remove-an-attribute" id="markdown-toc-remove-an-attribute">Remove an attribute</a><li><a href="https://selwynpolit.github.io/d9book/twig#convert-attributes-to-array" id="markdown-toc-convert-attributes-to-array">Convert attributes to array</a></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><li><a href="https://selwynpolit.github.io/d9book/twig#views" id="markdown-toc-views">Views</a><ul><li><a href="https://selwynpolit.github.io/d9book/twig#render-a-view-with-contextual-filter" id="markdown-toc-render-a-view-with-contextual-filter">Render a view with contextual filter</a><li><a href="https://selwynpolit.github.io/d9book/twig#count-how-many-rows-returned-from-a-view" id="markdown-toc-count-how-many-rows-returned-from-a-view">Count how many rows returned from a view</a><li><a href="https://selwynpolit.github.io/d9book/twig#if-view-results-empty-show-a-different-view" id="markdown-toc-if-view-results-empty-show-a-different-view">If view results empty, show a different view</a><li><a href="https://selwynpolit.github.io/d9book/twig#selectively-pass-1-termid-or-2-to-a-view-as-the-contextual-filter" id="markdown-toc-selectively-pass-1-termid-or-2-to-a-view-as-the-contextual-filter">Selectively pass 1 termid or 2 to a view as the contextual filter</a><li><a href="https://selwynpolit.github.io/d9book/twig#views-templates" id="markdown-toc-views-templates">Views templates</a><li><a href="https://selwynpolit.github.io/d9book/twig#inject-variables" id="markdown-toc-inject-variables">Inject variables</a><ul><li><a href="https://selwynpolit.github.io/d9book/twig#same-field-used-twice" id="markdown-toc-same-field-used-twice">Same field used twice</a></li></ul><li><a href="https://selwynpolit.github.io/d9book/twig#concatenate-values-into-a-string-with-join-1" id="markdown-toc-concatenate-values-into-a-string-with-join-1">Concatenate values into a string with join</a><li><a href="https://selwynpolit.github.io/d9book/twig#loop-through-entity-reference-items-1" id="markdown-toc-loop-through-entity-reference-items-1">Loop through entity reference items</a></li></li></li></li></li></li></li></li></ul><li><a href="https://selwynpolit.github.io/d9book/twig#twig-filters-and-functions" id="markdown-toc-twig-filters-and-functions">Twig filters and functions</a><li><a href="https://selwynpolit.github.io/d9book/twig#twig-tweak" id="markdown-toc-twig-tweak">Twig Tweak</a><ul><li><a href="https://selwynpolit.github.io/d9book/twig#documentation" id="markdown-toc-documentation">Documentation</a><li><a href="https://selwynpolit.github.io/d9book/twig#display-a-block-with-twig_tweak" id="markdown-toc-display-a-block-with-twig_tweak">Display a block with twig_tweak</a><li><a href="https://selwynpolit.github.io/d9book/twig#display-filter-form-block" id="markdown-toc-display-filter-form-block">Display filter form block</a><li><a href="https://selwynpolit.github.io/d9book/twig#embed-view-in-twig-template" id="markdown-toc-embed-view-in-twig-template">Embed view in twig template</a><li><a href="https://selwynpolit.github.io/d9book/twig#some-tricky-quotes-magic" id="markdown-toc-some-tricky-quotes-magic">Some tricky quotes magic</a></li></li></li></li></li></ul><li><a href="https://selwynpolit.github.io/d9book/twig#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a><ul><li><a href="https://selwynpolit.github.io/d9book/twig#enable-twig-debugging-and-disable-caches" id="markdown-toc-enable-twig-debugging-and-disable-caches">Enable Twig debugging and disable caches</a><li><a href="https://selwynpolit.github.io/d9book/twig#debugging---dump-a-variable" id="markdown-toc-debugging---dump-a-variable">Debugging - Dump a variable</a><li><a href="https://selwynpolit.github.io/d9book/twig#dump-taxonomy-reference-field" id="markdown-toc-dump-taxonomy-reference-field">Dump taxonomy reference field</a><li><a href="https://selwynpolit.github.io/d9book/twig#using-kint-or-dump-to-display-variable-in-a-template" id="markdown-toc-using-kint-or-dump-to-display-variable-in-a-template">Using kint or dump to display variable in a template</a><li><a href="https://selwynpolit.github.io/d9book/twig#502-bad-gateway-error" id="markdown-toc-502-bad-gateway-error">502 bad gateway error</a><li><a href="https://selwynpolit.github.io/d9book/twig#views-error" id="markdown-toc-views-error">Views error</a><li><a href="https://selwynpolit.github.io/d9book/twig#striptags-when-twig-debug-info-causes-if-to-fail" id="markdown-toc-striptags-when-twig-debug-info-causes-if-to-fail">Striptags (when twig debug info causes if to fail)</a></li></li></li></li></li></li></li></ul><li><a href="https://selwynpolit.github.io/d9book/twig#reference" id="markdown-toc-reference">Reference</a></li></li></li></li></li></li></li></li></li></ul><p><img alt="views" src="https://api.visitor.plantree.me/visitor-badge/pv?label=views&amp;color=informational&amp;namespace=d9book&amp;key=twig.md"/></p><hr/><p>Drupal 10 uses <strong>Twig 3</strong>. Drupal 9 uses Twig 2. Drupal 8 used Twig 1.</p><h2 id="overview"> <a aria-labelledby="overview" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#overview"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Overview</h2><h3 id="theme-system-overview"> <a aria-labelledby="theme-system-overview" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#theme-system-overview"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Theme System Overview</h3><p>Drupal's theme system allows a theme to have nearly complete control over the appearance of the site, which includes both the markup and the CSS used to style the markup. For this system to work, instead of writing HTML markup directly, modules return "render arrays", which are structured hierarchical arrays that include the data to be rendered into HTML, and options that affect the markup. Render arrays are ultimately rendered into HTML or other output formats by recursive calls to <a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21RendererInterface.php/function/RendererInterface%3A%3Arender/10">\Drupal\Core\Render\RendererInterface::render</a>(), traversing the depth of the render array hierarchy. At each level, the theme system is invoked to do the actual rendering. See the documentation of <a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21RendererInterface.php/function/RendererInterface%3A%3Arender/10">\Drupal\Core\Render\RendererInterface::render</a>() and the <a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21theme.api.php/group/theme_render/10">Theme system and Render API topic</a> for more information about render arrays and rendering.</p><h3 id="twig-templating-engine"> <a aria-labelledby="twig-templating-engine" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#twig-templating-engine"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Twig Templating Engine</h3><p>Drupal uses the templating engine Twig. Twig offers developers a fast, secure, and flexible method for building templates for Drupal 8 sites. Twig does not require front-end developers to know PHP to build and manipulate Drupal themes.</p><p>For more on theming in Drupal see <a href="https://www.drupal.org/docs/theming-drupal">https://www.drupal.org/docs/theming-drupal</a> .</p><p>For further Twig documentation see <a href="https://twig.symfony.com/doc/2.x%20/">https://twig.symfony.com/doc/2.x</a> and <a href="https://twig.symfony.com/doc/3.x">https://twig.symfony.com/doc/3.x</a></p><p>Note. Drupal 10 uses <strong>Twig 3</strong>, Drupal 9 uses Twig 2 and Drupal 8 used Twig 1.</p><h2 id="displaying-data"> <a aria-labelledby="displaying-data" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#displaying-data"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Displaying Data</h2><h3 id="fields-or-logic"> <a aria-labelledby="fields-or-logic" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#fields-or-logic"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Fields or Logic</h3><p>Twig can do things that PHP can’t such as whitespacing control, sandboxing, automatic HTML escaping, manual contextual output escaping, inclusion of custom functions and filters that only affect templates.</p><p>Double curly braces are used to output a variable. E.g.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.title</span> <span class="cp">}}</span>
</code></pre></div></div><p>Brace and percent are used to put logic into Twig templates e.g. if, then, else or for loops. E.g.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.price</span> <span class="ow">is</span> <span class="nb">defined</span> <span class="cp">%}</span>
  <span class="nt">&lt;h2&gt;</span>Price: <span class="cp">{{</span> <span class="nv">content.price</span> <span class="cp">}}</span> <span class="nt">&lt;/h2&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><p>Use brace and pound symbol (hash) for comments e.g.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">{# this section displays the voting details #}</span>
</code></pre></div></div><p>Here are some of the Twig functions that you can use in twig templates: <a href="https://www.drupal.org/docs/8/theming/twig/functions-in-twig-templates">https://www.drupal.org/docs/8/theming/twig/functions-in-twig-templates</a> There are lots of them e.g.</p><ul><li><code class="language-plaintext highlighter-rouge">file_url($uri)</code><li><code class="language-plaintext highlighter-rouge">link($text, $uri, $attributes)</code><li><code class="language-plaintext highlighter-rouge">path($name, $parameters, $options)</code><li><code class="language-plaintext highlighter-rouge">url($name, $parameters, $options)</code></li></li></li></li></ul><p>And even more Twig fun at <a href="https://twig.symfony.com/doc/3.x/functions/index.html">https://twig.symfony.com/doc/3.x/functions/index.html</a></p><h3 id="which-template-which-variables"> <a aria-labelledby="which-template-which-variables" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#which-template-which-variables"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Which template, which variables?</h3><p>There is usually one <code class="language-plaintext highlighter-rouge">page.tpl.php</code> and <em>multiple</em> node templates. One node template per content type. Eg. <code class="language-plaintext highlighter-rouge">node-news-story.html.twig</code>, <code class="language-plaintext highlighter-rouge">node-event.html.twig</code>. There can also be field specific templates e.g. <code class="language-plaintext highlighter-rouge">web/themes/custom/txg/templates/field/field--field-3-column-links.html.twig</code></p><p>In the <code class="language-plaintext highlighter-rouge">page.html.twig</code>, you can refer to variables as <code class="language-plaintext highlighter-rouge">page.content</code> or <code class="language-plaintext highlighter-rouge">node.label</code></p><p>whereas node templates expect <code class="language-plaintext highlighter-rouge">content.field_image</code> or <code class="language-plaintext highlighter-rouge">node.field_myfield</code></p><p>Note. If you don’t see a field output for a node, try specifying the preface <code class="language-plaintext highlighter-rouge">node.</code> instead of <code class="language-plaintext highlighter-rouge">content.</code>.</p><p>Field specific template are usually very simple and refer to</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">items</span> <span class="cp">}}</span>
</code></pre></div></div><p>and</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">item.content</span> <span class="cp">}}</span> 
</code></pre></div></div><p>e.g. from txg/web/themes/contrib/zurb_foundation/templates/page.html.twig</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;section&gt;</span>
  <span class="cp">{{</span> <span class="nv">page.content</span> <span class="cp">}}</span>
<span class="nt">&lt;/section&gt;</span>
</code></pre></div></div><p>And from <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/templates/content/page--node--event.html.twig</code> I accidentally started implementing this in the page template. See below for the node template.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">drupal_field</span><span class="p">(</span><span class="s1">'field_image'</span><span class="p">,</span> <span class="s1">'node'</span><span class="p">)</span> <span class="cp">}}</span>

<span class="nt">&lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">node.label</span> <span class="cp">}}</span><span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div&gt;</span>For: <span class="cp">{{</span> <span class="nv">node.field_for.0.value</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>DATE: <span class="cp">{{</span> <span class="nv">node.field_event_date.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'n/j/Y'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>Time: <span class="cp">{{</span> <span class="nv">node.field_event_date.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'h:ia'</span><span class="p">)</span> <span class="cp">}}</span> - <span class="cp">{{</span> <span class="nv">node.field_event_date.0.end_value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'h:ia'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div&gt;</span>
  Location:
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">node.field_event_location_link.0.url</span> <span class="cp">%}</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_event_location_link.0.url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_event_location.0.value</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>
    <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="cp">{{</span> <span class="nv">node.field_event_location.0.value</span> <span class="cp">}}</span>
    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="nt">&lt;/div&gt;</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">node.field_event_cta_link.0.url</span> <span class="cp">%}</span>
  CTA:<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"button"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_event_cta_link.0.url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_event_cta_link.0.title</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><p>Here is the same basic stuff (as above) but implemented in the node template at <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/templates/content/node--event.html.twig</code>:</p><blockquote><p>Note. That <code class="language-plaintext highlighter-rouge">node.label</code> becomes <code class="language-plaintext highlighter-rouge">label</code> and <code class="language-plaintext highlighter-rouge">node.field_for</code> becomes <code class="language-plaintext highlighter-rouge">content.field_for</code>.</p></blockquote><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">label</span> <span class="cp">}}</span><span class="nt">&lt;/h1&gt;</span>
<span class="cp">{{</span> <span class="nv">content.field_image</span> <span class="cp">}}</span>
<span class="nt">&lt;div&gt;</span>Node: <span class="cp">{{</span> <span class="nv">node.id</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>For: <span class="cp">{{</span> <span class="nv">content.field_for</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>DATE: <span class="cp">{{</span> <span class="nv">node.field_event_date.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'n/j/Y'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>Time: <span class="cp">{{</span> <span class="nv">node.field_event_date.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'h:ia'</span><span class="p">)</span> <span class="cp">}}</span> - <span class="cp">{{</span> <span class="nv">node.field_event_date.0.end_value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'h:ia'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>
  Location:
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">node.field_event_location_link.0.url</span> <span class="cp">%}</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_event_location_link.0.url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_event_location.0.value</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>
  <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="cp">{{</span> <span class="nv">node.field_event_location.0.value</span> <span class="cp">}}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="nt">&lt;/div&gt;</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">node.field_event_cta_link.0.url</span> <span class="cp">%}</span>
  CTA:<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"button"</span><span class="nt">&gt;</span> <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_event_cta_link.0.url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_event_cta_link.0.title</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="display-fields-or-variables"> <a aria-labelledby="display-fields-or-variables" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#display-fields-or-variables"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Display fields or variables</h3><p>Using <code class="language-plaintext highlighter-rouge">node.field_myfield</code> will bypass the rendering and display any markup in the field. Using <code class="language-plaintext highlighter-rouge">content.field_myfield</code> uses the rendering system and is the preferred way to display your content.</p><p>This will display all the content rendered</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="node-title-with-and-without-a-link"> <a aria-labelledby="node-title-with-and-without-a-link" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#node-title-with-and-without-a-link"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Node Title with and without a link</h3><p>Render node title (or label) (with markup – so it may include &lt;span&gt; tags)</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">label</span> <span class="cp">}}</span>
</code></pre></div></div><p>Render node label (without markup – no html in this version)</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.label</span> <span class="cp">}}</span>
</code></pre></div></div><p>Render link to node</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">label</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>
</code></pre></div></div><p>// Or a little more complex..</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"title"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">label</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;span&gt;</span><span class="cp">{{</span> <span class="nv">content.field_vendor_ref</span> <span class="cp">}}</span><span class="nt">&lt;/span&gt;&lt;/div&gt;</span>
</code></pre></div></div><h3 id="fields"> <a aria-labelledby="fields" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#fields"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Fields</h3><p>There are many ways to limit things and only show some of the content. Mostly often you will need to show specific fields. Note. This will include rendered info such as labels etc.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_yomama</span> <span class="cp">}}</span>
</code></pre></div></div><p>or</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_ref_topic</span> <span class="cp">}}</span>
</code></pre></div></div><p>Any field – just jam <code class="language-plaintext highlighter-rouge">content.</code> in front of it</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_intl_students_and_scholars</span> <span class="cp">}}</span>
</code></pre></div></div><p>You can also grab node specific fields if <code class="language-plaintext highlighter-rouge">content.</code> type fields don’t do the trick.</p><p>In a node template, you can display specific node fields by prefacing them with <code class="language-plaintext highlighter-rouge">node</code> e.g.:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.id</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">node.label</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">node.field_date.value</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">node.field_date.end_value</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="paragraph-field"> <a aria-labelledby="paragraph-field" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#paragraph-field"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Paragraph field</h3><p>These still work fine: <code class="language-plaintext highlighter-rouge">content.field_abc</code> or <code class="language-plaintext highlighter-rouge">node.field_ref_topic</code> but instead of <code class="language-plaintext highlighter-rouge">node</code>, you preface fields with <code class="language-plaintext highlighter-rouge">paragraph</code> like this:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>termid0: <span class="cp">{{</span> <span class="nv">paragraph.field_ref_tax.0.target_id</span> <span class="cp">}}</span>
termid1: <span class="cp">{{</span> <span class="nv">paragraph.field_ref_tax.1.target_id</span> <span class="cp">}}</span>
</code></pre></div></div><p>and we get this result if we have selected two terms 13 and 16.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>termid0: 13
termid1: 16
</code></pre></div></div><p>To dump a taxonomy reference field for debugging purposes use the code below. The pre tags format it a little nicer than if we don’t have them.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;</span>
<span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">paragraph.field_ref_tax.value</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/pre&gt;</span>
</code></pre></div></div><h3 id="loop-thru-paragraph-reference-fields"> <a aria-labelledby="loop-thru-paragraph-reference-fields" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#loop-thru-paragraph-reference-fields"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Loop thru paragraph reference fields</h3><p>Here we go looping thru all the values in a multi-value reference field.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">for</span> <span class="nv">tax</span> <span class="ow">in</span> <span class="nv">paragraph.field_ref_tax</span> <span class="cp">%}</span>
  <span class="nt">&lt;div&gt;</span>target_id: <span class="cp">{{</span> <span class="nv">tax.target_id</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</code></pre></div></div><p>It’s the same as outputting these guys:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>termid0: <span class="cp">{{</span> <span class="nv">paragraph.field_ref_tax.0.target_id</span> <span class="cp">}}</span>
termid1: <span class="cp">{{</span> <span class="nv">paragraph.field_ref_tax.1.target_id</span> <span class="cp">}}</span>
</code></pre></div></div><p>and to make this more useful, here we build a string of them to pass to a view.</p><p>From: dirt/web/themes/custom/dirt_bootstrap/templates/paragraphs/paragraph--news-preview.html.twig</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">{# Figure out parameters to pass to view for news items #}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">params</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">paragraph.field_ref_tax_two</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">params</span> <span class="o">=</span> <span class="nv">params</span> <span class="err">~</span> <span class="nv">item.target_id</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">loop.last</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">set</span> <span class="nv">params</span> <span class="o">=</span> <span class="nv">params</span> <span class="err">~</span> <span class="s1">'+'</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
params: <span class="cp">{{</span> <span class="nv">params</span> <span class="cp">}}</span>
</code></pre></div></div><p>This will output something like: 5+6+19</p><h3 id="body"> <a aria-labelledby="body" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#body"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Body</h3><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.body</span> <span class="cp">}}</span>
</code></pre></div></div><p>Or</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.body.value</span> <span class="cp">}}</span>
</code></pre></div></div><p>And for summary</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.body.summary</span> <span class="o">| </span><span class="nf">raw</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="multi-value-fields"> <a aria-labelledby="multi-value-fields" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#multi-value-fields"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Multi-value fields</h3><p>Fields that you preface with <code class="language-plaintext highlighter-rouge">node.</code> can also handle an index (the <code class="language-plaintext highlighter-rouge">0</code> below) i.e. to indicate the first value in a multi-value field, 1 to indicate the second etc.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_iso_n3_country_code.0.value</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="fields-with-html"> <a aria-labelledby="fields-with-html" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#fields-with-html"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Fields with HTML</h3><p>If a field has html that you want rendered, use the keyword raw. Be aware this has security considerations which you can mitigate using <a href="https://twig.symfony.com/doc/3.x/filters/striptags.html">striptags</a> filters:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div&gt;</span>How to order: <span class="cp">{{</span> <span class="nv">how_to_order</span><span class="o">|</span><span class="nf">raw</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><p>And maybe you want to only allow &lt;b&gt; tags</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">word</span><span class="o">|</span><span class="nf">striptags</span><span class="p">(</span><span class="s1">'&lt;b&gt;'</span><span class="p">)</span><span class="o">|</span><span class="nf">raw</span> <span class="cp">}}</span>
</code></pre></div></div><p>Or several tags. In this case &lt;b&gt;&lt;a&gt;&lt;pre&gt;</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">word</span><span class="o">|</span><span class="nf">striptags</span><span class="p">(</span><span class="s1">'&lt;b&gt;,&lt;a&gt;,&lt;pre&gt;'</span><span class="p">)</span><span class="o">|</span><span class="nf">raw</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="the-datetime-a-node-is-published-updated-or-created"> <a aria-labelledby="the-datetime-a-node-is-published-updated-or-created" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#the-datetime-a-node-is-published-updated-or-created"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> The date/time a node is published, updated or created</h3><p>Each of these calls return a datetime value in string form which can be massaged by the twig date() function for formatting.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;</span>
Created:   <span class="cp">{{</span> <span class="nv">node.created.value</span> <span class="cp">}}</span>
Created:   <span class="cp">{{</span> <span class="nv">node.createdtime</span> <span class="cp">}}</span>
Created:   <span class="cp">{{</span> <span class="nv">node.created.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">)</span> <span class="cp">}}</span>

Modified:  <span class="cp">{{</span> <span class="nv">node.changed.value</span> <span class="cp">}}</span>
Modified:  <span class="cp">{{</span> <span class="nv">node.changedtime</span> <span class="cp">}}</span>
Modified:  <span class="cp">{{</span> <span class="nv">node.changed.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">)</span> <span class="cp">}}</span>

Published: <span class="cp">{{</span> <span class="nv">node.published_at.value</span> <span class="cp">}}</span>
Published: <span class="cp">{{</span> <span class="nv">node.published_at.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/pre&gt;</span>
</code></pre></div></div><p>Here is the output you might see. Note. The first published is apparently blank because I didn’t use the drupal scheduling to publish the node (maybe?) and the second one seems to have defaulted to today’s date.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Created: 1604034000
Created: 1604034000
Created: 2020-10-30
Modified: 1604528207
Modified: 1604528207
Modified: 2020-11-04
Published:
Published: 2020-11-20
</code></pre></div></div><p>Updated/changed</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">post_date</span> <span class="o">=</span> <span class="nv">node.changedtime</span> <span class="cp">%}</span>
</code></pre></div></div><p>Created (same as authored on date on node edit form):</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.createdtime</span> <span class="cp">}}</span>
</code></pre></div></div><p>And pretty formatted like Sep 2, 2023</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.createdtime</span><span class="err">\</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'M d, Y'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Also</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"date"</span><span class="nt">&gt;</span>Date posted: <span class="cp">{{</span> <span class="nv">node.getCreatedTime</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'m/d/Y'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"date"</span><span class="nt">&gt;</span>Date posted: <span class="cp">{{</span> <span class="nv">node.getChangedTime</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'m/d/Y'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><p>Node published date:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Date published: <span class="cp">{{</span> <span class="nv">_context.node.published_at.value</span> <span class="cp">}}</span>
Date published: <span class="cp">{{</span> <span class="nv">node.published_at.value</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="format-a-date-field"> <a aria-labelledby="format-a-date-field" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#format-a-date-field"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Format a date field</h3><p>Use the field’s format settings; include wrappers. This example includes wrappers.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_blog_date</span> <span class="cp">}}</span>
</code></pre></div></div><p>The examples below do not include wrappers.</p><p>Use the field’s format settings. This will use the format defined in <code class="language-plaintext highlighter-rouge">Content type » Manage Displays »Your View Mode</code>.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_blog_date.0</span> <span class="cp">}}</span>
</code></pre></div></div><p>Using Twig date filter and a defined Drupal date format</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_blog_date.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'U'</span><span class="p">)</span><span class="o">|</span><span class="nf">format_date</span><span class="p">(</span><span class="s1">'short_mdyyyy'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Use Twig date filter</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_blog_date.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'n/j/Y'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="smart-date-field-formatting"> <a aria-labelledby="smart-date-field-formatting" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#smart-date-field-formatting"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Smart date field formatting</h3><p>When using the <a href="https://www.drupal.org/project/smart_date">smart date</a> module, dates are stored as timestamps so you have to use the twig date function to format them. If you just put this in your template:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_when</span> <span class="cp">}}</span>
</code></pre></div></div><p>The output will include whichever formatting you specify in Drupal. While I assume there is a way to pass a <a href="https://www.drupal.org/project/smart_date">smart date</a> formatting string to twig, I haven't discovered it yet. Here are ways to format a <a href="https://www.drupal.org/project/smart_date">smart date</a>.</p><p>Specify the index (the 0 indicating the first value, or 1 for the second) e.g. node.field.0.value and pipe the twig <a href="https://twig.symfony.com/doc/3.x/filters/date.html">date</a> function for formatting:</p><p>Date as in July 18, 2023</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_when.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'F j, Y'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>End date</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_when.0.end_value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'F j, Y'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Timezone as in America/Chicago</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_when.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'e'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Timezone as in CDT</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_when.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'T'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Day of the week</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_when.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'l'</span><span class="p">)</span> <span class="cp">}}</span> <span class="c">{# day of week #}</span>
</code></pre></div></div><p>Hide the end date if it is the same as the start date</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">start</span> <span class="o">=</span> <span class="nv">node.field_when.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'l F j, Y'</span><span class="p">)</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">end</span> <span class="o">=</span> <span class="nv">node.field_when.0.end_value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'l F j, Y'</span><span class="p">)</span> <span class="cp">%}</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"date"</span><span class="nt">&gt;</span> <span class="cp">{{</span> <span class="nv">start</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">start</span> <span class="ow">is</span> <span class="nv">same</span> <span class="k">as</span><span class="p">(</span><span class="nv">end</span><span class="p">)</span> <span class="cp">%}</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"date"</span><span class="nt">&gt;</span> <span class="cp">{{</span> <span class="nv">end</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="entity-reference-field"> <a aria-labelledby="entity-reference-field" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#entity-reference-field"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Entity Reference field</h3><p>If you have an entity reference field such as field_ref_topic (entity reference to topic content) you have to specify the target_id like this. If you have only 1 reference, use the <code class="language-plaintext highlighter-rouge">.0</code>, for the second one use <code class="language-plaintext highlighter-rouge">.1</code> and so on.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_ref_topic.0.target_id</span> <span class="cp">}}</span>
</code></pre></div></div><p>Note. This will show the node id of the entity reference field. See below to see the content that the entity reference field points to.</p><h3 id="entity-reference-destination-content"> <a aria-labelledby="entity-reference-destination-content" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#entity-reference-destination-content"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Entity reference destination content</h3><p>If you have an entity reference and you want to display the content from the node that is referenced i.e. if you have a contract with a reference to the vendor node and you want to display information from the vendor node on the contract you can dereference fields in the entity destination:</p><p>From <code class="language-plaintext highlighter-rouge">dirt/web/themes/custom/dirt_bootstrap/templates/content/node--contract--vendor-list.html.twig</code>:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">node.field_sf_contract_ref.entity.field_contract_overview.value</span> <span class="cp">}}</span>
</code></pre></div></div><p>Or</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_sf_contract_ref.entity.field_contract_overview</span> <span class="cp">}}</span>
</code></pre></div></div><p>The field in the contract node is called <code class="language-plaintext highlighter-rouge">field_sf_contract_ref</code>. The field in the referenced entity is called field_contract_overview. Notice how with the <code class="language-plaintext highlighter-rouge">node.</code> style, you must specify <code class="language-plaintext highlighter-rouge">.value</code> at the end.</p><p>Here is an example of a taxonomy term where the title of the term will be displayed.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;</span>
Dump category:
<span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">node.field_ref_tax.entity.label</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/pre&gt;</span>
</code></pre></div></div><h3 id="taxonomy-term"> <a aria-labelledby="taxonomy-term" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#taxonomy-term"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Taxonomy term</h3><p>Here is an example of displaying a taxonomy term.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;</span>
Dump category: <span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">node.field_ref_tax.entity.label</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/pre&gt;</span>
</code></pre></div></div><h3 id="render-a-block"> <a aria-labelledby="render-a-block" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#render-a-block"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Render a block</h3><p>Example block with a machine name of <code class="language-plaintext highlighter-rouge">block---system-powered-by-block.html.twig</code> from a custom theme</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span>
  <span class="k">set</span> <span class="nv">classes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'block'</span><span class="p">,</span>
    <span class="s1">'block-'</span> <span class="err">~</span> <span class="nv">configuration.provider</span><span class="o">|</span><span class="nf">clean_class</span><span class="p">,</span>
    <span class="s1">'block-'</span> <span class="err">~</span> <span class="nv">plugin_id</span><span class="o">|</span><span class="nf">clean_class</span><span class="p">,</span>
  <span class="p">]</span>
<span class="cp">%}</span>
<span class="nt">&lt;div</span><span class="cp">{{</span> <span class="nv">attributes.addClass</span><span class="p">(</span><span class="nv">classes</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
  <span class="cp">{{</span> <span class="nv">title_prefix</span> <span class="cp">}}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">label</span> <span class="cp">%}</span>
    <span class="nt">&lt;h2</span><span class="cp">{{</span> <span class="nv">title_attributes</span> <span class="cp">}}</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">label</span> <span class="cp">}}</span><span class="nt">&lt;/h2&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">title_suffix</span> <span class="cp">}}</span>
  <span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
    <span class="cp">{{</span> <span class="nv">content</span> <span class="cp">}}</span>
  <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
  also powered by <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://austinprogressivecalendar.com"</span><span class="nt">&gt;</span>Austin Progressive Calendar<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><h3 id="render-a-list-created-in-the-template_preprocess_node"> <a aria-labelledby="render-a-list-created-in-the-template_preprocess_node" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#render-a-list-created-in-the-template_preprocess_node"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Render a list created in the template_preprocess_node()</h3><p>Here we create a list in the function:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">burger_theme_preprocess_node</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$variables</span><span class="p">)</span> <span class="p">{</span>

  <span class="nv">$burger_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Cheesburger'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Mushroomburger'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Chickenburger'</span><span class="p">],</span>
  <span class="p">];</span>
  <span class="nv">$variables</span><span class="p">[</span><span class="s1">'burgers'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$burger_list</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>and render it in the <code class="language-plaintext highlighter-rouge">node--article--full.html.twig</code></p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ol&gt;</span>
  <span class="cp">{%</span> <span class="k">for</span> <span class="nv">burger</span> <span class="ow">in</span> <span class="nv">burgers</span> <span class="cp">%}</span>
  <span class="nt">&lt;li&gt;</span><span class="cp">{{</span> <span class="nv">burger</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="cp">}}</span><span class="nt">&lt;/li&gt;</span>
  <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/ol&gt;</span>
</code></pre></div></div><h3 id="links"> <a aria-labelledby="links" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#links"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Links</h3><p>There are a bajillion kertrillion or more ways to render a link</p><p>Link field (URL)</p><p>This is the simplest way. Just set the display mode to link</p><p><img alt="Suggest Button" src="https://selwynpolit.github.io/d9book/assets/images/suggest_button.png"/></p><p>And output the link without a label.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_suggest_button</span> <span class="cp">}}</span>
</code></pre></div></div><p>If you need a little more control you might use this version which allows classes etc. We are adding several classes onto the anchor to make it look like a button. In this case with an internal link, it shows up using the alias of the link i.e. it shows <code class="language-plaintext highlighter-rouge">/contracts</code> instead of <code class="language-plaintext highlighter-rouge">node/7</code> when you hover over the link.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;&lt;a</span> <span class="na">class=</span><span class="s">"btn secondary navy centered"</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_suggest_button.0.url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_suggest_button.0.title</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;&lt;/p&gt;</span>
</code></pre></div></div><p>Using <code class="language-plaintext highlighter-rouge">.uri</code> causes the link (internal only. External links are fine) to show up as <code class="language-plaintext highlighter-rouge">node/7</code> when you hover over the link.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;p&gt;&lt;a</span> <span class="na">class=</span><span class="s">"btn secondary navy centered"</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_suggest_button.uri</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_suggest_button.0.title</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;&lt;/p&gt;</span>

</code></pre></div></div><p>Don’t try this as it won’t work:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//bad
<span class="cp">{{</span> <span class="nv">node.field_suggest_button.url</span> <span class="cp">}}</span>.
//bad
</code></pre></div></div><p>Want to use the text from a different field? No problem.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"title"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_link.uri</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_contract_number.value</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
</code></pre></div></div><h3 id="links-to-other-pages-on-site"> <a aria-labelledby="links-to-other-pages-on-site" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#links-to-other-pages-on-site"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Links to other pages on site</h3><p>Absolute link:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">url</span><span class="p">(</span><span class="s1">'entity.node.canonical'</span><span class="p">,</span> <span class="err">{</span><span class="nv">node</span><span class="err">:</span> <span class="nv">3223</span><span class="err">}</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>Link to Weather Balloon node 3223 <span class="nt">&lt;/a&gt;</span>
</code></pre></div></div><p>Relative link</p><p>See path vs url:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">path</span><span class="p">(</span><span class="s1">'entity.node.canonical'</span><span class="p">,</span> <span class="err">{</span><span class="nv">node</span><span class="err">:</span> <span class="nv">3223</span><span class="err">}</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>Link to Weather Balloon node 3223 <span class="nt">&lt;/a&gt;</span>
</code></pre></div></div><h3 id="link-to-a-user-using-user-id"> <a aria-labelledby="link-to-a-user-using-user-id" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#link-to-a-user-using-user-id"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Link to a user using user id</h3><p>You can link to users using the following:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">url</span><span class="p">(</span><span class="s1">'entity.user.canonical'</span><span class="p">,</span> <span class="err">{</span><span class="nv">user</span><span class="err">:</span> <span class="nv">1</span><span class="err">}</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>Link to user 1 <span class="nt">&lt;/a&gt;</span>
</code></pre></div></div><h3 id="external-link-in-a-field-via-an-entity-reference"> <a aria-labelledby="external-link-in-a-field-via-an-entity-reference" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#external-link-in-a-field-via-an-entity-reference"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> External link in a field via an entity reference</h3><p>Here we have a node with an entity reference field (<code class="language-plaintext highlighter-rouge">field_sf_contract_ref</code>) to another entity.</p><p>In a preprocess function, you can grab the link. Note, you can just grab the <code class="language-plaintext highlighter-rouge">first()</code> one. Later on you can see that in the twig template, you can specify the first one with <code class="language-plaintext highlighter-rouge">.0</code></p><p>From dirt/web/themes/custom/dirt_bootstrap/dirt_bootstrap.theme</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$vendor_url</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="n">field_sf_contract_ref</span><span class="o">-&gt;</span><span class="n">entity</span><span class="o">-&gt;</span><span class="n">field_vendor_url</span><span class="o">-&gt;</span><span class="nf">first</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$vendor_url</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$vendor_url</span> <span class="o">=</span> <span class="nv">$vendor_url</span><span class="o">-&gt;</span><span class="nf">getUrl</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$vendor_url</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$variables</span><span class="p">[</span><span class="s1">'vendor_url'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$vendor_url</span><span class="o">-&gt;</span><span class="nf">getUri</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>And in the template we retrieve the URI with <code class="language-plaintext highlighter-rouge">.uri</code>:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;&lt;a</span> <span class="na">class=</span><span class="s">"styled-link ext"</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_sf_contract_ref.entity.field_vendor_url.uri</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>Vendor Website<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>
</code></pre></div></div><p>Here we check if there is a target value and output that also. E.g. <code class="language-plaintext highlighter-rouge">target="_blank"</code> and also display the title – this is the anchor title as in the words “Vendor Website” below</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://www.duckduckgo.com"</span><span class="nt">&gt;</span>Vendor Website<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>
</code></pre></div></div><p>From <code class="language-plaintext highlighter-rouge">inside-marthe/themes/custom/dp/templates/paragraph/paragraph--sidebar-product-card.html.twig</code> we wrap some stuff in a link:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span><span class="nv">content.field_link.0</span><span class="p">[</span><span class="s1">'#url'</span><span class="p">]</span><span class="cp">}}</span><span class="s">"</span> <span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_link.0</span><span class="p">[</span><span class="s1">'#options'</span><span class="p">][</span><span class="s1">'attributes'</span><span class="p">][</span><span class="s1">'target'</span><span class="p">]</span> <span class="cp">%}</span> <span class="na">target=</span><span class="s">"</span><span class="cp">{{</span><span class="nv">content.field_link.0</span><span class="p">[</span><span class="s1">'#options'</span><span class="p">][</span><span class="s1">'attributes'</span><span class="p">][</span><span class="s1">'target'</span><span class="p">]</span><span class="cp">}}</span><span class="s">"</span> <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span> <span class="na">class=</span><span class="s">"button"</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">content.field_link.0</span><span class="p">[</span><span class="s1">'#title'</span><span class="p">]</span><span class="cp">}}</span>
  <span class="cp">{{</span> <span class="nv">content.field_image</span> <span class="cp">}}</span>
  <span class="nt">&lt;h2</span> <span class="na">class=</span><span class="s">"module-header"</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">content.field_text</span><span class="cp">}}</span><span class="nt">&lt;/h2&gt;</span>
  <span class="cp">{{</span><span class="nv">content.field_text2</span><span class="cp">}}</span>
<span class="nt">&lt;/a&gt;</span>

</code></pre></div></div><p>And from <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/templates/content/node--event--card.html.twig</code> if there is a url, display the link with the url, otherwise just display the title for the link. I’m not 100% sure this is really valid. Can you put in a title and no link?</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">node.field_event_location_link.0.url</span> <span class="cp">%}</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">node.field_event_location_link.0.url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">node.field_event_location.0.value</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">node.field_event_location.0.value</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

</code></pre></div></div><h3 id="render-an-internal-link-programatically"> <a aria-labelledby="render-an-internal-link-programatically" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#render-an-internal-link-programatically"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Render an internal link programatically</h3><p>Here we want to render an internal link to a page on our Drupal site (as opposed to a link to another site.) We grab the link in a preprocess function. Extract out the title and the URI.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$instructions_node</span> <span class="o">=</span> <span class="nc">Node</span><span class="o">::</span><span class="nf">load</span><span class="p">(</span><span class="nv">$order_type_instructions_nid</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$instructions_node</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$order_link</span> <span class="o">=</span> <span class="nv">$instructions_node</span><span class="o">-&gt;</span><span class="n">field_link</span><span class="o">-&gt;</span><span class="nf">first</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$order_link</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$uri</span> <span class="o">=</span> <span class="nv">$order_link</span><span class="o">-&gt;</span><span class="n">uri</span><span class="p">;</span>
    <span class="nv">$variables</span><span class="p">[</span><span class="s1">'order_link_title'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$order_link</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">;</span>
    <span class="nv">$order_url</span> <span class="o">=</span> <span class="nv">$order_link</span><span class="o">-&gt;</span><span class="nf">getUrl</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$order_url</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$variables</span><span class="p">[</span><span class="s1">'order_type_link'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$order_url</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>We can put the pieces in the twig template like this</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">order_type_link</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">order_link_title</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>

</code></pre></div></div><h3 id="render-an-image-with-an-image-style"> <a aria-labelledby="render-an-image-with-an-image-style" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#render-an-image-with-an-image-style"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Render an image with an image style</h3><p>From <code class="language-plaintext highlighter-rouge">inside-marthe/themes/custom/dp/templates/paragraph/paragraph--sidebar-resource.html.twig</code></p><p>Here we use sidebar_standard image style</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;aside</span> <span class="na">class=</span><span class="s">"module module--featured"</span> <span class="na">data-interchange=</span><span class="s">"[</span><span class="cp">{{</span> <span class="nv">content.field_image.0</span><span class="p">[</span><span class="s1">'#item'</span><span class="p">]</span><span class="err">.</span><span class="nv">entity.uri.value</span> <span class="o">| </span><span class="nf">image_style</span><span class="p">(</span><span class="s1">'sidebar_standard'</span><span class="p">)</span> <span class="cp">}}</span><span class="s">, small]"</span><span class="nt">&gt;</span>

</code></pre></div></div><p>Or for a media field, set the image style on the display mode and use this:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">content.field_banner_image.0</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="hide-if-there-is-no-content-in-a-field-or-image"> <a aria-labelledby="hide-if-there-is-no-content-in-a-field-or-image" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#hide-if-there-is-no-content-in-a-field-or-image"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Hide if there is no content in a field or image</h3><p>From inside-marthe/themes/custom/dp/templates/content/node--video-detail.html.twig I check to see if there are any values in this array <code class="language-plaintext highlighter-rouge">related_lessons_nid</code>s and display the view.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">related_lessons_nids</span><span class="o">|</span><span class="nf">length</span> <span class="cp">%}</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"section section--featured"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"grid-container"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h2</span> <span class="na">class=</span><span class="s">"section-header text-center large-text-left"</span><span class="nt">&gt;</span>Related Lessons<span class="nt">&lt;/h2&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"grid-x grid-margin-x"</span> <span class="na">data-equalizer</span> <span class="na">data-equalize-on=</span><span class="s">"large"</span><span class="nt">&gt;</span>
        <span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'video'</span><span class="p">,</span> <span class="s1">'embed_collection_related_lessons'</span><span class="p">,</span> <span class="nv">related_lessons_nids</span><span class="o">|</span><span class="nf">join</span><span class="p">(</span><span class="s1">', '</span><span class="p">))</span> <span class="cp">}}</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><p>Not empty:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_myfield</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">empty</span> <span class="cp">%}</span>
  <span class="c">{# Do something here #}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="hide-if-there-is-no-image-present"> <a aria-labelledby="hide-if-there-is-no-image-present" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#hide-if-there-is-no-image-present"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Hide if there is no image present</h3><p>If there is an image (and it is renderable) display the image</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_teacher_commentary_image</span><span class="o">|</span><span class="nf">render</span> <span class="cp">%}</span>
  <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"</span><span class="cp">{{</span><span class="nv">file_url</span><span class="p">(</span> <span class="nv">content.field_teacher_commentary_image</span><span class="p">[</span><span class="s1">'#items'</span><span class="p">]</span><span class="err">.</span><span class="nv">entity.uri.value</span> <span class="p">)</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">width=</span><span class="s">"420"</span> <span class="na">height=</span><span class="s">"255"</span> <span class="na">alt=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"left"</span><span class="nt">&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="attributes"> <a aria-labelledby="attributes" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#attributes"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Attributes</h3><p>From <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes">https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes</a>:</p><p>Elements in HTML have <strong>attributes</strong>; these are additional values that configure the elements or adjust their behavior in various ways to meet the criteria the users want.</p><p>Read more about using attributes in templates <a href="https://www.drupal.org/docs/8/theming-drupal-8/using-attributes-in-templates">https://www.drupal.org/docs/8/theming-drupal-8/using-attributes-in-templates</a></p><p>To add a data attribute use:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">attributes.setAttribute</span><span class="p">(</span><span class="s1">'data-myname'</span><span class="p">,</span><span class="s1">'tommy'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>e.g.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;article</span><span class="cp">{{</span> <span class="nv">attributes.addClass</span><span class="p">(</span><span class="nv">classes</span><span class="p">)</span><span class="err">.</span><span class="nv">setAttribute</span><span class="p">(</span><span class="s1">'my-name'</span><span class="p">,</span> <span class="s1">'Selwyn'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
</code></pre></div></div><p>Produces:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;article</span>
  <span class="na">data-history-node-id=</span><span class="s">"3224"</span>
  <span class="na">data-quickedit-entity-id=</span><span class="s">"node/3224"</span>
  <span class="na">role=</span><span class="s">"article"</span>
  <span class="na">class=</span><span class="s">"contextual-region node node--type-article node--promoted node--view-mode-full"</span>
  <span class="na">about=</span><span class="s">"/burger1"</span>
  <span class="na">typeof=</span><span class="s">"schema:Article"</span>
  <span class="na">my-name=</span><span class="s">"Selwyn"</span>
  <span class="na">data-quickedit-entity-instance-id=</span><span class="s">"0"</span>
<span class="nt">&gt;&lt;/article&gt;</span>
</code></pre></div></div><p>More useful examples at <a href="https://www.drupal.org/docs/8/theming-drupal-8/using-attributes-in-templates">https://www.drupal.org/docs/8/theming-drupal-8/using-attributes-in-templates</a> such as:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'red'</span><span class="p">,</span> <span class="s1">'green'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">]</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">my_id</span> <span class="o">=</span> <span class="s1">'specific-id'</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">image_src</span> <span class="o">=</span> <span class="s1">'https://www.drupal.org/files/powered-blue-135x42.png'</span> <span class="cp">%}</span>

<span class="nt">&lt;img</span><span class="cp">{{</span> <span class="nv">attributes.addClass</span><span class="p">(</span><span class="nv">classes</span><span class="p">)</span><span class="err">.</span><span class="nv">removeClass</span><span class="p">(</span><span class="s1">'green'</span><span class="p">)</span><span class="err">.</span><span class="nv">setAttribute</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="nv">my_id</span><span class="p">)</span><span class="err">.</span><span class="nv">setAttribute</span><span class="p">(</span><span class="s1">'src'</span><span class="p">,</span> <span class="nv">image_src</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
</code></pre></div></div><p>Which outputs the following:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;img</span>
  <span class="na">id=</span><span class="s">"specific-id"</span>
  <span class="na">class=</span><span class="s">"red blue"</span>
  <span class="na">src=</span><span class="s">"https://www.drupal.org/files/powered-blue-135x42.png"</span>
<span class="nt">/&gt;</span>
</code></pre></div></div><p>Check if an attribute has a class</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">attributes.hasClass</span><span class="p">(</span><span class="err">$</span><span class="nv">class</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Remove an attribute</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">attributes.removeAttribute</span><span class="p">()</span> <span class="cp">}}</span>
</code></pre></div></div><p>Convert attributes to array</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">attributes.toArray</span> <span class="p">()</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="output-the-content-but-leave-off-the-field_image"> <a aria-labelledby="output-the-content-but-leave-off-the-field_image" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#output-the-content-but-leave-off-the-field_image"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Output the content but leave off the field_image</h3><p>From <code class="language-plaintext highlighter-rouge">very/web/themes/very/templates/node--teaser.html.twig</code>:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span><span class="cp">{{</span> <span class="nv">content_attributes.addClass</span><span class="p">(</span><span class="s1">'content'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
  <span class="cp">{{</span> <span class="nv">content</span><span class="o">|</span><span class="nf">without</span><span class="p">(</span><span class="s1">'field_image'</span><span class="p">)</span><span class="o">|</span><span class="nf">render</span><span class="o">|</span><span class="nf">striptags</span> <span class="cp">}}</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><h3 id="add-a-class"> <a aria-labelledby="add-a-class" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#add-a-class"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Add a class</h3><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span><span class="cp">{{</span> <span class="nv">content_attributes.addClass</span><span class="p">(</span><span class="s1">'node__content'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
</code></pre></div></div><h3 id="add-a-class-conditionally"> <a aria-labelledby="add-a-class-conditionally" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#add-a-class-conditionally"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Add a class conditionally</h3><p>From <code class="language-plaintext highlighter-rouge">very/web/themes/very/templates/node--teaser.html.twig</code></p><p>For an unpublished node, wrap this class around the word unpublished</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">node.published</span> <span class="cp">%}</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"node--unpublished"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="s1">'Unpublished'</span><span class="o">|</span><span class="nf">t</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="links-to-other-pages-on-site-1"> <a aria-labelledby="links-to-other-pages-on-site-1" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#links-to-other-pages-on-site-1"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Links to other pages on site</h3><p>Absolute:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">url</span><span class="p">(</span><span class="s1">'entity.node.canonical'</span><span class="p">,</span> <span class="err">{</span><span class="nv">node</span><span class="err">:</span> <span class="nv">3223</span><span class="err">}</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>Link to WEA node 3223 <span class="nt">&lt;/a&gt;</span>
</code></pre></div></div><p>Relative (see path vs url):</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">path</span><span class="p">(</span><span class="s1">'entity.node.canonical'</span><span class="p">,</span> <span class="err">{</span><span class="nv">node</span><span class="err">:</span> <span class="nv">3223</span><span class="err">}</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>Link to WEA node 3223 <span class="nt">&lt;/a&gt;</span>
</code></pre></div></div><p>Could also link to users using</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">url</span><span class="p">(</span><span class="s1">'entity.user.canonical'</span><span class="p">,</span> <span class="err">{</span><span class="nv">user</span><span class="err">:</span> <span class="nv">1</span><span class="err">}</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>Link to user 1 <span class="nt">&lt;/a&gt;</span>
</code></pre></div></div><h3 id="loopindex-in-a-paragraph-twig-template"> <a aria-labelledby="loopindex-in-a-paragraph-twig-template" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#loopindex-in-a-paragraph-twig-template"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Loop.index in a paragraph twig template</h3><p>From: <code class="language-plaintext highlighter-rouge">web/themes/custom/dprime/templates/field/field--paragraph--field-links--sidebar-cta.html.twig</code></p><p>Notice the use of <code class="language-plaintext highlighter-rouge">loop.index</code> to only output this for the first item</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">items</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">loop.index</span> <span class="o">==</span> <span class="nv">1</span> <span class="cp">%}</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell medium-6"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span><span class="nv">item.content</span><span class="p">[</span><span class="s1">'#url'</span><span class="p">]</span><span class="cp">}}</span><span class="s">"</span> <span class="na">class=</span><span class="s">"button </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">loop.index</span> <span class="o">==</span> <span class="nv">2</span> <span class="cp">%}</span><span class="s">hollow </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="s">button--light m-b-0"</span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">item.content</span><span class="p">[</span><span class="s1">'#options'</span><span class="p">][</span><span class="s1">'attributes'</span><span class="p">][</span><span class="s1">'target'</span><span class="p">]</span> <span class="cp">%}</span> <span class="na">target=</span><span class="s">"</span><span class="cp">{{</span><span class="nv">item.content</span><span class="p">[</span><span class="s1">'#options'</span><span class="p">][</span><span class="s1">'attributes'</span><span class="p">][</span><span class="s1">'target'</span><span class="p">]</span><span class="cp">}}</span><span class="s">"</span> <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">item.content</span><span class="p">[</span><span class="s1">'#title'</span><span class="p">]</span><span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="loop-thru-an-array-of-items-with-a-separator"> <a aria-labelledby="loop-thru-an-array-of-items-with-a-separator" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#loop-thru-an-array-of-items-with-a-separator"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Loop thru an array of items with a separator</h3><p>This loads all the authors and adds <code class="language-plaintext highlighter-rouge">and</code> between them except for the last one:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div&gt;</span>
  <span class="cp">{%</span><span class="o">-</span> <span class="k">if</span> <span class="nv">content.author</span> <span class="o">-</span><span class="cp">%}</span>
      by
    <span class="cp">{%</span><span class="o">-</span> <span class="k">for</span> <span class="nv">author</span> <span class="ow">in</span> <span class="nv">content.author</span> <span class="o">-</span><span class="cp">%}</span>
      <span class="cp">{%</span> <span class="k">if</span> <span class="nv">loop.last</span> <span class="cp">%}</span>
        <span class="cp">{%</span> <span class="k">set</span> <span class="nv">separator</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
      <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
        <span class="cp">{%</span> <span class="k">set</span> <span class="nv">separator</span> <span class="o">=</span> <span class="s1">' and '</span> <span class="cp">%}</span>
      <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
      <span class="cp">{{</span> <span class="nv">author</span> <span class="cp">}}</span> <span class="cp">{{</span> <span class="nv">separator</span> <span class="cp">}}</span>
    <span class="cp">{%</span><span class="o">-</span> <span class="k">endfor</span> <span class="o">-</span><span class="cp">%}</span>
  <span class="cp">{%</span><span class="o">-</span> <span class="k">endif</span> <span class="o">-</span><span class="cp">%}</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><p>This version inserts commas:</p><p>From <code class="language-plaintext highlighter-rouge">org/docroot/themes/custom/org/templates/field/field--node--field-categories--opinion.html.twig</code></p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">label_hidden</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">multiple</span> <span class="cp">%}</span>
      <span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">items</span> <span class="cp">%}</span>
        <span class="cp">{%</span><span class="k">if</span> <span class="nv">loop.index</span> <span class="o">&gt;</span> <span class="nv">1</span> <span class="cp">%}</span>, <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}{{</span> <span class="nv">item.content</span> <span class="cp">}}</span>
      <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">items</span> <span class="cp">%}</span>
      <span class="cp">{%</span><span class="k">if</span> <span class="nv">loop.index</span> <span class="o">&gt;</span> <span class="nv">1</span> <span class="cp">%}</span>, <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}{{</span> <span class="nv">item.content</span> <span class="cp">}}</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="nt">&lt;div</span><span class="cp">{{</span> <span class="nv">title_attributes</span> <span class="cp">}}</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">label</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">items</span> <span class="cp">%}</span>
      <span class="cp">{%</span><span class="k">if</span> <span class="nv">loop.index</span> <span class="o">&gt;</span> <span class="nv">1</span> <span class="cp">%}</span>, <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}{{</span> <span class="nv">item.content</span> <span class="cp">}}</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h2 id="add-javascript-into-a-twig-template"> <a aria-labelledby="add-javascript-into-a-twig-template" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#add-javascript-into-a-twig-template"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Add Javascript into a twig template</h2><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
  <span class="kd">function</span> <span class="nf">hidePRSnippet</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">average_rating</span> <span class="o">&lt;</span> <span class="mf">3.5</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">average_rating</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pr-reviewsnippet</span><span class="dl">'</span><span class="p">).</span><span class="nf">remove</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">powerReviewsConfig</span> <span class="o">=</span> <span class="cp">{{</span> <span class="nv">accPowerreviews</span> <span class="o">| </span><span class="nf">raw</span><span class="cp">}}</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">powerReviewsConfig</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">powerReviewsConfig</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nf">hasOwnProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">components</span><span class="dl">'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">powerReviewsConfig</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">components</span><span class="p">.</span><span class="nf">hasOwnProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">ReviewSnippet</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">powerReviewsConfig</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="dl">'</span><span class="s1">on_render</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">hidePRSnippet</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">POWERREVIEWS</span><span class="p">.</span><span class="nx">display</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="nx">powerReviewsConfig</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div><h2 id="controllogic"> <a aria-labelledby="controllogic" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#controllogic"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Control/Logic</h2><h3 id="concatenate-values-into-a-string-with-join"> <a aria-labelledby="concatenate-values-into-a-string-with-join" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#concatenate-values-into-a-string-with-join"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Concatenate values into a string with join</h3><p>This would typically be used when passing a series of node id's to a view to filter its output.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="p">[</span><span class="nv">node.field_ref_unit.0.target_id</span><span class="p">,</span><span class="nv">node.field_ref_unit.1.target_id</span><span class="p">,</span><span class="nv">node.field_ref_unit.2.target_id</span><span class="p">,</span><span class="nv">node.field_ref_unit.3.target_id</span><span class="p">]</span><span class="o">|</span><span class="nf">join</span><span class="p">(</span><span class="s1">'+'</span><span class="p">)</span> <span class="cp">%}</span>
</code></pre></div></div><p>This produces <code class="language-plaintext highlighter-rouge">1+2+3+4</code></p><h3 id="include-partial-templates"> <a aria-labelledby="include-partial-templates" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#include-partial-templates"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Include partial templates</h3><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">include</span> <span class="s1">'@txg/partials/searchfilterform.html.twig'</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="loop-through-entity-reference-items"> <a aria-labelledby="loop-through-entity-reference-items" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#loop-through-entity-reference-items"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Loop through entity reference items</h3><p>In <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/templates/content/node--news-story.html.twig</code> I need to loop through a bunch of entity reference values and build a string of id+id+id… (with an undefined number) so</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">node.field_ref_unit</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="nv">blah</span> <span class="err">~</span> <span class="nv">item.target_id</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">loop.last</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="nv">blah</span> <span class="err">~</span> <span class="s1">'+'</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>

<span class="nt">&lt;div&gt;</span>blah:<span class="cp">{{</span> <span class="nv">blah</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>node id: <span class="cp">{{</span> <span class="nv">node.id</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'related_news_for_news_story'</span><span class="p">,</span> <span class="s1">'block_unit'</span><span class="p">,</span> <span class="nv">node.id</span><span class="p">,</span> <span class="nv">blah</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="if-or"> <a aria-labelledby="if-or" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#if-or"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> IF OR</h3><p>If there is a value in <code class="language-plaintext highlighter-rouge">field_event_date</code> or <code class="language-plaintext highlighter-rouge">field_display_date</code>, then display it/them.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span><span class="cp">{{</span> <span class="nv">content_attributes.addClass</span><span class="p">(</span><span class="s1">'teaser__content'</span><span class="p">)</span> <span class="cp">}}</span><span class="nt">&gt;</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_event_date</span> <span class="ow">or</span> <span class="nv">content.field_display_date</span> <span class="cp">%}</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"teaser__date"</span><span class="nt">&gt;</span>
      <span class="cp">{{</span> <span class="nv">content.field_event_date</span><span class="o">|</span><span class="nf">render</span><span class="o">|</span><span class="nf">striptags</span> <span class="cp">}}</span>
      <span class="cp">{{</span> <span class="nv">content.field_display_date</span><span class="o">|</span><span class="nf">render</span><span class="o">|</span><span class="nf">striptags</span> <span class="cp">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>  
</code></pre></div></div><h3 id="test-if-a-formatted-text-field-is-empty"> <a aria-labelledby="test-if-a-formatted-text-field-is-empty" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#test-if-a-formatted-text-field-is-empty"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Test if a formatted text field is empty</h3><p>To check a body field or other formatted text field, use |render to render it first.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.body</span><span class="o">|</span><span class="nf">render</span>  <span class="cp">%}</span>
  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"scroll"</span> <span class="na">href=</span><span class="s">"#section-overview"</span><span class="nt">&gt;</span>Overview<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="test-empty-variable"> <a aria-labelledby="test-empty-variable" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#test-empty-variable"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Test empty variable</h3><p>This code checks if a variable is empty using <a href="https://twig.symfony.com/doc/3.x/tests/empty.html">empty</a> test if the attributes variable is not set. From <a href="https://www.drupal.org/project/drupal/issues/2558079">https://www.drupal.org/project/drupal/issues/2558079</a>:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">attributes</span> <span class="ow">is</span> <span class="nb">empty</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">link</span><span class="p">(</span><span class="nv">item.title</span><span class="p">,</span> <span class="nv">item.url</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span>  <span class="k">else</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">link</span><span class="p">(</span><span class="nv">item.title</span><span class="p">,</span> <span class="nv">item.url</span><span class="p">,</span> <span class="nv">attributes</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><p>You can also use:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">blah</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">empty</span> <span class="cp">%}</span>
  <span class="cp">{{</span><span class="nv">content.name</span><span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="conditionals-empty-defined-even"> <a aria-labelledby="conditionals-empty-defined-even" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#conditionals-empty-defined-even"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Conditionals (empty, defined, even)</h3><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">rows</span> <span class="cp">%}</span>
  <span class="cp">{{</span><span class="nv">rows</span><span class="cp">}}</span>
<span class="cp">{%</span> <span class="nv">elseif</span> <span class="nb">empty</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">empty</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">var</span> <span class="ow">is</span> <span class="nb">defined</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">content.name</span><span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="cp">{%</span><span class="k">if</span> <span class="nv">var</span> <span class="ow">is</span> <span class="nb">even</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">content.name</span><span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><p>e.g. from <code class="language-plaintext highlighter-rouge">inside-marthe/themes/custom/dp/templates/paragraph/paragraph--highlight-card.html.twig</code></p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">showCat</span> <span class="o">=</span> <span class="nv">TRUE</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">view_mode</span> <span class="o">==</span> <span class="s1">'overview'</span> <span class="ow">or</span> <span class="nv">view_mode</span> <span class="o">==</span> <span class="s1">'home'</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">showCat</span> <span class="o">=</span> <span class="nv">FALSE</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cell medium-4 home-highlight-card m-b-3"</span> <span class="na">data-equalizer-watch</span><span class="nt">&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{%</span> <span class="k">spaceless</span> <span class="cp">%}{{</span> <span class="nv">content.field_link.0</span> <span class="cp">}}{%</span> <span class="k">endspaceless</span> <span class="cp">%}</span><span class="s">"</span> <span class="na">class=</span><span class="s">"card h-100"</span> <span class="na">data-interchange=</span><span class="s">"[</span><span class="cp">{{</span> <span class="nv">content.field_image.0</span><span class="p">[</span><span class="s1">'#item'</span><span class="p">]</span><span class="err">.</span><span class="nv">entity.uri.value</span> <span class="o">| </span><span class="nf">image_style</span><span class="p">(</span><span class="s1">'highlight_card_standard'</span><span class="p">)</span> <span class="cp">}}</span><span class="s">, small]"</span> <span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_link.0</span><span class="p">[</span><span class="s1">'#options'</span><span class="p">][</span><span class="s1">'attributes'</span><span class="p">][</span><span class="s1">'target'</span><span class="p">]</span> <span class="cp">%}</span> <span class="na">target=</span><span class="s">"</span><span class="cp">{{</span><span class="nv">content.field_link.0</span><span class="p">[</span><span class="s1">'#options'</span><span class="p">][</span><span class="s1">'attributes'</span><span class="p">][</span><span class="s1">'target'</span><span class="p">]</span><span class="cp">}}</span><span class="s">"</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card-content"</span><span class="nt">&gt;</span>
      <span class="cp">{%</span>  <span class="k">if</span> <span class="nv">showCat</span> <span class="cp">%}</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"card-label"</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">content.field_text2</span><span class="cp">}}</span><span class="nt">&lt;/span&gt;</span>
      <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
      <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"card-header"</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">content.field_text</span><span class="cp">}}</span><span class="nt">&lt;/h3&gt;</span>
      <span class="cp">{{</span><span class="nv">content.field_description</span><span class="cp">}}</span>
      <span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_button_text</span><span class="o">|</span><span class="nf">render</span> <span class="cp">%}</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"button full-width show-on-hover"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">content.field_button_text</span> <span class="cp">}}</span><span class="nt">&lt;/span&gt;</span>
      <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"button full-width show-on-hover"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">content.field_text</span><span class="o">|</span><span class="nf">render</span> <span class="cp">}}</span><span class="nt">&lt;/span&gt;</span>
      <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><h3 id="test-if-a-paragraph-is-empty-using-striptags"> <a aria-labelledby="test-if-a-paragraph-is-empty-using-striptags" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#test-if-a-paragraph-is-empty-using-striptags"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Test if a paragraph is empty using striptags</h3><p>From <code class="language-plaintext highlighter-rouge">/inside-marthe/themes/custom/dp/templates/content/node--video-collection.html.twig</code>:</p><p>Normally you wouldn’t need the striptags, but when twig debugging is enabled, the render information includes debug tags. See https://www.drupal.org/project/drupal/issues/2547559#comment-12103048</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_related_lessons</span><span class="o">|</span><span class="nf">render</span><span class="o">|</span><span class="nf">striptags</span><span class="o">|</span><span class="nf">trim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">empty</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">content.field_related_lessons</span><span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><p>Or this much simpler version which also comes from the same issue page above (it doesn’t seem to work as well as the version above):</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_related_lessons.value</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">content.field_related_lessons</span><span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="comparing-strings"> <a aria-labelledby="comparing-strings" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#comparing-strings"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Comparing strings</h3><p>For complicated strings, you have to use the Twig <a href="https://twig.symfony.com/doc/3.x/tests/sameas.html">same as</a> function because using <code class="language-plaintext highlighter-rouge">if x == y</code> doesn't work. See the commented out part where I tried <code class="language-plaintext highlighter-rouge">==</code>:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">start</span> <span class="o">=</span> <span class="nv">node.field_when.0.value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'l F j, Y'</span><span class="p">)</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">end</span> <span class="o">=</span> <span class="nv">node.field_when.0.end_value</span><span class="o">|</span><span class="nf">date</span><span class="p">(</span><span class="s1">'l F j, Y'</span><span class="p">)</span> <span class="cp">%}</span>
<span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"date"</span><span class="nt">&gt;</span> <span class="cp">{{</span> <span class="nv">start</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="c">{#{% if not start == end %}#}</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">start</span> <span class="ow">is</span> <span class="nv">same</span> <span class="k">as</span><span class="p">(</span><span class="nv">end</span><span class="p">)</span> <span class="cp">%}</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"date"</span><span class="nt">&gt;</span> <span class="cp">{{</span> <span class="nv">end</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="include-other-templates-as-partials"> <a aria-labelledby="include-other-templates-as-partials" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#include-other-templates-as-partials"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Include other templates as partials</h3><p>In <code class="language-plaintext highlighter-rouge">very/web/themes/very/templates/node--featured.html.twig</code></p><p>You can re-use templates. Just put them in the partials directory (you don’t have to but it is a good convention) and include them.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">include</span><span class="p">(</span><span class="s1">'node--teaser.html.twig'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="check-if-an-attribute-has-a-class"> <a aria-labelledby="check-if-an-attribute-has-a-class" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#check-if-an-attribute-has-a-class"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Check if an attribute has a class</h3><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">attributes.hasClass</span><span class="p">(</span><span class="err">$</span><span class="nv">class</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="remove-an-attribute"> <a aria-labelledby="remove-an-attribute" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#remove-an-attribute"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Remove an attribute</h3><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">attributes.removeAttribute</span><span class="p">()</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="convert-attributes-to-array"> <a aria-labelledby="convert-attributes-to-array" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#convert-attributes-to-array"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Convert attributes to array</h3><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">attributes.toArray</span> <span class="p">()</span> <span class="cp">}}</span>
</code></pre></div></div><h2 id="views"> <a aria-labelledby="views" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#views"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Views</h2><h3 id="render-a-view-with-contextual-filter"> <a aria-labelledby="render-a-view-with-contextual-filter" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#render-a-view-with-contextual-filter"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Render a view with contextual filter</h3><blockquote><p>Pro tip: Create <code class="language-plaintext highlighter-rouge">embed</code> displays (rather than blocks or pages) so users don’t see these blocks appearing in the block management page. see <a href="https://drupal.stackexchange.com/questions/287209/what-does-the-embed-display-type-do">https://drupal.stackexchange.com/questions/287209/what-does-the-embed-display-type-do</a></p></blockquote><p>To use a field value in a view as an argument, using <a href="https://www.drupal.org/project/twig_tweak">twig_tweak</a>, you can render the view and its arguments/parameters. In the example below, these are the contextual filters defined in the view.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'map_data_for_a_country'</span><span class="p">,</span> <span class="s1">'block_stats'</span><span class="p">,</span> <span class="nv">node.field_iso_n3_country_code.0.value</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><blockquote><p>Note. Using content.field as a parameter doesn’t work because content.fields get rendered so they are usually filled with HTML or labels or both. Parameters need to simply be numbers or strings.</p></blockquote><p>Other examples. Here an entity reference field is passed as a parameter. This works for taxonomy terms like this also.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'news_stories_for_a_topic'</span><span class="p">,</span><span class="s1">'block_1'</span><span class="p">,</span> <span class="nv">node.field_ref_topic.0.target_id</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Or</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'resellers_for_this_vendor'</span><span class="p">,</span> <span class="s1">'embed_1'</span><span class="p">,</span> <span class="nv">node.field_vendor_id.value</span> <span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>Note. If you ever see a 502 bad gateway error when embedding a drupal_view, delete the display and create a new one and it may just work fine.</p><h3 id="count-how-many-rows-returned-from-a-view"> <a aria-labelledby="count-how-many-rows-returned-from-a-view" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#count-how-many-rows-returned-from-a-view"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Count how many rows returned from a view</h3><p>https://www.drupal.org/docs/8/modules/twig-tweak/twig-tweak-and-views</p><p>Check if View has Results</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">view</span> <span class="o">=</span> <span class="nv">drupal_view_result</span><span class="p">(</span><span class="s1">'related'</span><span class="p">,</span> <span class="s1">'block_1'</span><span class="p">)</span><span class="o">|</span><span class="nf">length</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">view</span> <span class="o">&gt;</span> <span class="nv">0</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'related'</span><span class="p">,</span> <span class="s1">'block_1'</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="if-view-results-empty-show-a-different-view"> <a aria-labelledby="if-view-results-empty-show-a-different-view" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#if-view-results-empty-show-a-different-view"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> If view results empty, show a different view</h3><p>In <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/templates/content/node--news-story.html.twig</code> we show units (the first view) but if there aren’t any, show <code class="language-plaintext highlighter-rouge">aofs</code> (the second view.)</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">drupal_view_result</span><span class="p">(</span><span class="s1">'related_news_for_news_story'</span><span class="p">,</span> <span class="s1">'block_unit'</span><span class="p">,</span> <span class="nv">node.id</span><span class="p">,</span> <span class="nv">unit_ids</span><span class="p">)</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'related_news_for_news_story'</span><span class="p">,</span> <span class="s1">'block_unit'</span><span class="p">,</span> <span class="nv">node.id</span><span class="p">,</span> <span class="nv">unit_ids</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="nv">elseif</span> <span class="nv">drupal_view_result</span><span class="p">(</span><span class="s1">'related_news_aof'</span><span class="p">,</span> <span class="s1">'block_aof'</span><span class="p">,</span> <span class="nv">node.id</span><span class="p">,</span> <span class="nv">aof_ids</span><span class="p">)</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'related_news_aof'</span><span class="p">,</span> <span class="s1">'block_aof'</span><span class="p">,</span> <span class="nv">node.id</span><span class="p">,</span> <span class="nv">aof_ids</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h3 id="selectively-pass-1-termid-or-2-to-a-view-as-the-contextual-filter"> <a aria-labelledby="selectively-pass-1-termid-or-2-to-a-view-as-the-contextual-filter" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#selectively-pass-1-termid-or-2-to-a-view-as-the-contextual-filter"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Selectively pass 1 termid or 2 to a view as the contextual filter</h3><p>In the view, you can allow multiple terms for a <code class="language-plaintext highlighter-rouge">contextual filter</code></p><p>From: <a href="https://drupal.stackexchange.com/questions/78701/views-multiple-contextual-filters-taxonomy">https://drupal.stackexchange.com/questions/78701/views-multiple-contextual-filters-taxonomy</a>:</p><p>Instead of Content: The name of Taxonomy (taxonomy_vocabulary_#) you need to select Content: Has taxonomy term ID <em>Contextual filter</em> and enable <em>Allow multiple values</em> to able to use multiple values in the form of 1+2+3 (for OR) or 1,2,3 (for AND).</p><p>Then in the template, check if there is a second value and build the arguments in the form id+id (e.g. “13+16”) In this example, I have to assume the setup allows only 2 taxonomy terms to be entered. See below for an unlimited amount of terms.</p><p>From <code class="language-plaintext highlighter-rouge">/Users/selwyn/Sites/dirt/web/themes/custom/dirt_bootstrap/templates/paragraphs/paragraph--upcoming-events.html.twig</code>:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">{# if there is a second category, pass it separated by + #}</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">paragraph.field_ref_tax.1.target_id</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">args</span> <span class="o">=</span> <span class="nv">paragraph.field_ref_tax.1.target_id</span><span class="err">~</span><span class="s1">'+'</span><span class="err">~</span><span class="nv">paragraph.field_ref_tax.1.target_id</span>  <span class="cp">%}</span>
  args: <span class="cp">{{</span> <span class="nv">args</span> <span class="cp">}}</span>
  <span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'events'</span><span class="p">,</span> <span class="s1">'embed_2'</span><span class="p">,</span> <span class="nv">paragraph.field_ref_tax.0.target_id</span><span class="err">~</span><span class="s1">'+'</span><span class="err">~</span><span class="nv">paragraph.field_ref_tax.1.target_id</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'events'</span><span class="p">,</span> <span class="s1">'embed_2'</span><span class="p">,</span> <span class="nv">paragraph.field_ref_tax.0.target_id</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><p>Or even nicer, we could loop thru an unlimited number of terms, build a string of them to pass to a view.</p><p>From: <code class="language-plaintext highlighter-rouge">/Users/selwyn/Sites/dirt/web/themes/custom/dirt_bootstrap/templates/paragraphs/paragraph--news-preview.html.twig</code></p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">{# Figure out parameters to pass to view for news items #}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">params</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">paragraph.field_ref_tax_two</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">params</span> <span class="o">=</span> <span class="nv">params</span> <span class="err">~</span> <span class="nv">item.target_id</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">loop.last</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">set</span> <span class="nv">params</span> <span class="o">=</span> <span class="nv">params</span> <span class="err">~</span> <span class="s1">'+'</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
params: <span class="cp">{{</span> <span class="nv">params</span> <span class="cp">}}</span>
</code></pre></div></div><p>This will output something like: <code class="language-plaintext highlighter-rouge">5+6+19</code></p><p>And pass the output to a view like this:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'news'</span><span class="p">,</span> <span class="s1">'embed_2'</span><span class="p">,</span> <span class="nv">params</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="views-templates"> <a aria-labelledby="views-templates" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#views-templates"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Views templates</h3><p>Using machine names for the view, you can copy the base view templates (just like in Drupal 7) to make specific templates.</p><p>From <a href="https://www.drupal.org/docs/theming-drupal/twig-in-drupal/twig-template-naming-conventions">https://www.drupal.org/docs/theming-drupal/twig-in-drupal/twig-template-naming-conventions</a>:</p><p>Using a View named foobar with its style: unformatted and row style: Fields, and using display:Page.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>views-view--foobar--page.html.twig
views-view--page.html.twig
views-view--foobar.html.twig
views-view.html.twig

views-view-unformatted--foobar--page.html.twig
views-view-unformatted--page.html.twig
views-view-unformatted--foobar.html.twig
views-view-unformatted.html.twig

views-view-fields--foobar--page.html.twig
views-view-fields--page.html.twig
views-view-fields--foobar.html.twig
views-view-fields.html.twig
</code></pre></div></div><p>or for <code class="language-plaintext highlighter-rouge">views-view-list.html.twig</code>, you could use <code class="language-plaintext highlighter-rouge">views-view-list---foobar.html.twig</code></p><p>e.g. <code class="language-plaintext highlighter-rouge">/Users/selwyn/Sites/dirt/web/themes/custom/dirt_bootstrap/templates/views/views-view-list--resource-library.html.twig</code></p><h3 id="inject-variables"> <a aria-labelledby="inject-variables" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#inject-variables"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Inject variables</h3><p>You can inject variables into a view using <code class="language-plaintext highlighter-rouge">hook_preprocess_views_view</code>() eg. from <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/txg.theme</code>. The code below used to was load up various items to populate the select dropdown controls in the view:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">txg_preprocess_views_view</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$variables</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$view</span> <span class="o">=</span> <span class="nv">$variables</span><span class="p">[</span><span class="s1">'view'</span><span class="p">];</span>
  <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$view</span><span class="o">-&gt;</span><span class="n">storage</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">();</span>
  <span class="nv">$display_id</span> <span class="o">=</span> <span class="nv">$view</span><span class="o">-&gt;</span><span class="n">current_display</span><span class="p">;</span>

  <span class="c1">// Build /newsroom/search</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$id</span> <span class="o">==</span> <span class="s1">'news_events_search'</span> <span class="o">&amp;&amp;</span> <span class="nv">$display_id</span> <span class="o">==</span> <span class="s1">'page_news'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$variables</span><span class="p">[</span><span class="s1">'filter_data'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">generate_search_filter_data</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>Here is the code that builds the data for the select controls:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cd">/**
 * Populate dropdowns.
 *
 * Builds the search filter data to populate select dropdowns on
 * /newsroom, /newsroom-search etc. pages.
 *
 * @return array
 *   Array of values for dropdown.
 *
 * @throws \Drupal\Component\Plugin\Exception\InvalidPluginDefinitionException
 * @throws \Drupal\Component\Plugin\Exception\PluginNotFoundException
 */</span>
<span class="k">function</span> <span class="n">generate_search_filter_data</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// Grab the Get parameters.</span>
  <span class="nv">$country_nid</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">query</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'country'</span><span class="p">);</span>
  <span class="nv">$aof_nid</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">query</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'aof'</span><span class="p">);</span>
  <span class="nv">$unit_nid</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">query</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'unit'</span><span class="p">);</span>
  <span class="nv">$continent_arg</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">query</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'continent'</span><span class="p">);</span>
  <span class="nv">$topic_tid</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">query</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'topic'</span><span class="p">);</span>

  <span class="c1">// Office: AOF and child units from main menu.</span>
  <span class="nv">$office_nid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$aof_nid</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$aof_nid</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$office_nid</span> <span class="o">=</span> <span class="nv">$aof_nid</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$unit_nid</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$unit_nid</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$office_nid</span> <span class="o">=</span> <span class="nv">$unit_nid</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nv">$storage</span> <span class="o">=</span> <span class="nf">get_offices</span><span class="p">(</span><span class="nv">$office_nid</span><span class="p">);</span>
  <span class="nv">$data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'office'</span><span class="p">,</span>
    <span class="s1">'info'</span> <span class="o">=&gt;</span> <span class="nv">$storage</span><span class="p">,</span>
  <span class="p">];</span>

  <span class="c1">// Topic taxonomy terms.</span>
  <span class="nv">$vid</span> <span class="o">=</span> <span class="s1">'topic'</span><span class="p">;</span>
  <span class="nv">$terms</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">entityTypeManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getStorage</span><span class="p">(</span><span class="s1">'taxonomy_term'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">loadTree</span><span class="p">(</span><span class="nv">$vid</span><span class="p">);</span>
  <span class="nv">$storage</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$terms</span> <span class="k">as</span> <span class="nv">$term</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$storage</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">"value"</span> <span class="o">=&gt;</span> <span class="nv">$term</span><span class="o">-&gt;</span><span class="n">tid</span><span class="p">,</span>
      <span class="s2">"title"</span> <span class="o">=&gt;</span> <span class="nv">$term</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span>
    <span class="p">];</span>
  <span class="p">}</span>
  <span class="c1">// Update the select to show the current value from the url.</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$storage</span> <span class="k">as</span> <span class="o">&amp;</span><span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$item</span><span class="p">[</span><span class="s1">'value'</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$topic_tid</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$item</span><span class="p">[</span><span class="s1">'selected'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'selected'</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nv">$data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'topic'</span><span class="p">,</span>
    <span class="s1">'info'</span> <span class="o">=&gt;</span> <span class="nv">$storage</span><span class="p">,</span>
  <span class="p">];</span>

  <span class="c1">// Continent.</span>
  <span class="nv">$continents</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'Africa'</span><span class="p">,</span> <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'Africa'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'Antarctica'</span><span class="p">,</span> <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'Antarctica'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'Asia'</span><span class="p">,</span> <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'Asia'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'Europe'</span><span class="p">,</span> <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'Europe'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'North America'</span><span class="p">,</span> <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'north%20america'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'Oceania'</span><span class="p">,</span> <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'Oceania'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'South America'</span><span class="p">,</span> <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'south%20america'</span><span class="p">],</span>
  <span class="p">];</span>
  <span class="c1">// Update the select to show the current value from the url.</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$continents</span> <span class="k">as</span> <span class="o">&amp;</span><span class="nv">$continent</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$continent_arg</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$continent</span><span class="p">[</span><span class="s1">'title'</span><span class="p">])</span> <span class="o">==</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$continent_arg</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$continent</span><span class="p">[</span><span class="s1">'selected'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'selected'</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nv">$data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'continent'</span><span class="p">,</span>
    <span class="s1">'info'</span> <span class="o">=&gt;</span> <span class="nv">$continents</span><span class="p">,</span>
  <span class="p">];</span>

  <span class="c1">// Country.</span>
  <span class="nv">$data_storage</span> <span class="o">=</span> <span class="nc">Drupal</span><span class="o">::</span><span class="nf">entityTypeManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getStorage</span><span class="p">(</span><span class="s1">'node'</span><span class="p">);</span>
  <span class="nv">$query</span> <span class="o">=</span> <span class="nc">Drupal</span><span class="o">::</span><span class="nf">entityQuery</span><span class="p">(</span><span class="s1">'node'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nf">condition</span><span class="p">(</span><span class="s1">'status'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nf">condition</span><span class="p">(</span><span class="s1">'type'</span><span class="p">,</span> <span class="s1">'country'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nb">sort</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'ASC'</span><span class="p">);</span>
  <span class="nv">$nids</span> <span class="o">=</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="nf">execute</span><span class="p">();</span>
  <span class="nv">$nodes</span> <span class="o">=</span> <span class="nv">$data_storage</span><span class="o">-&gt;</span><span class="nf">loadMultiple</span><span class="p">(</span><span class="nv">$nids</span><span class="p">);</span>
  <span class="nv">$storage</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$nodes</span> <span class="k">as</span> <span class="nv">$node</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$storage</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">getTitle</span><span class="p">(),</span>
      <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">(),</span>
    <span class="p">];</span>
  <span class="p">}</span>
  <span class="c1">// Set the default country so it appears in the select dropdown.</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$storage</span> <span class="k">as</span> <span class="o">&amp;</span><span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$item</span><span class="p">[</span><span class="s1">'value'</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$country_nid</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$item</span><span class="p">[</span><span class="s1">'selected'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'selected'</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nv">$data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'country'</span><span class="p">,</span>
    <span class="s1">'info'</span> <span class="o">=&gt;</span> <span class="nv">$storage</span><span class="p">,</span>
  <span class="p">];</span>

  <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>Here the output for all views uses the <code class="language-plaintext highlighter-rouge">views-view.html.twig</code> template</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- BEGIN OUTPUT from 'core/themes/classy/templates/views/views-view.html.twig' --&gt;</span>
</code></pre></div></div><p>If we want to override the <code class="language-plaintext highlighter-rouge">frontpage</code> view we can copy the template from above to our theme and rename it <code class="language-plaintext highlighter-rouge">views-view--frontpage.html.twig</code></p><p>Notice that it will override all displays (in this case the page and the <code class="language-plaintext highlighter-rouge">feed</code> displays – “page_1” and “feed_1” respectively) so we can be more specific</p><p>Rename it to <code class="language-plaintext highlighter-rouge">views-view--frontpage--page_1.html.twig</code></p><p>From <a href="https://api.drupal.org/api/drupal/core%21modules%21views%21views.theme.inc/group/views_templates/8.5.x">https://api.drupal.org/api/drupal/core%21modules%21views%21views.theme.inc/group/views_templates/8.5.x</a></p><p>All views templates can be overridden with a variety of names, using the view, the display ID of the view, the display type of the view, or some combination thereof.</p><p>For each view, there will be a minimum of two templates used. The first is used for all views: <a href="https://api.drupal.org/api/drupal/core%21modules%21views%21templates%21views-view.html.twig/8.2.x">views-view.html.twig</a>.</p><p>The second template is determined by the style selected for the view. Note that certain aspects of the view can also change which style is used; for example, arguments which provide a summary view might change the style to one of the special summary styles.</p><p>The default style for all views is <a href="https://api.drupal.org/api/drupal/core%21modules%21views%21templates%21views-view-unformatted.html.twig/8.2.x">views-view-unformatted.html.twig</a>.</p><p>Many styles will then farm out the actual display of each row to a row style; the default row style is <code class="language-plaintext highlighter-rouge">views-view-fields.html.twig</code>.</p><p>Here is an example of all the templates that will be tried in the following case:</p><p>View: foobar Style: unformatted Row style: Fields. Display:Page.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-	views-view--foobar--page.html.twig
-	views-view--page.html.twig
-	views-view--foobar.html.twig
-	views-view.html.twig
-	views-view-unformatted--foobar--page.html.twig
-	views-view-unformatted--page.html.twig
-	views-view-unformatted--foobar.html.twig
-	views-view-unformatted.html.twig
-	views-view-fields--foobar--page.html.twig
-	views-view-fields--page.html.twig
-	views-view-fields--foobar.html.twig
-	views-view-fields.html.twig
</code></pre></div></div><p class="important">When adding a new template to your theme, be sure to flush the theme registry cache!</p><p>From <a href="https://api.drupal.org/api/drupal/core%21modules%21views%21views.theme.inc/function/template_preprocess_views_view_field/8.2.x">https://api.drupal.org/api/drupal/core%21modules%21views%21views.theme.inc/function/template_preprocess_views_view_field/8.2.x</a>:</p><p>When changing the value of a field in a view, use <code class="language-plaintext highlighter-rouge">preprocess_views_view_field()</code>.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">mytheme_preprocess_views_view_field</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$variables</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$view</span> <span class="o">=</span> <span class="nv">$variables</span><span class="p">[</span><span class="s1">'view'</span><span class="p">];</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$view</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'my_view'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$variables</span><span class="p">[</span><span class="s1">'field'</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">field</span> <span class="o">==</span> <span class="s1">'field_my_field'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$my_field_value</span> <span class="o">=</span> <span class="nv">$variables</span><span class="p">[</span><span class="s1">'field'</span><span class="p">]</span><span class="o">-&gt;</span><span class="nf">getValue</span><span class="p">(</span><span class="nv">$variables</span><span class="p">[</span><span class="s1">'row'</span><span class="p">]);</span>
      <span class="nv">$my_altered_value</span> <span class="o">=</span> <span class="s1">'xx'</span><span class="p">;</span>
      <span class="nv">$variables</span><span class="p">[</span><span class="s1">'output'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$my_altered_value</span><span class="p">;</span> <span class="c1">// Default variable in Twig file is "output"</span>
      <span class="c1">// OR</span>
      <span class="nv">$variables</span><span class="p">[</span><span class="s1">'my_output'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$my_altered_value</span><span class="p">;</span> <span class="c1">// New variable in Twig file (views-view-field--my-view--field-my-field.html.twig)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h4 id="same-field-used-twice"> <a aria-labelledby="same-field-used-twice" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#same-field-used-twice"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Same field used twice</h4><p>Note. If you use the same field twice in a view i.e. if you need to display different parts of the same field in different places, views names them something like this: field_library_media and field_library_media_1. In that circumstance, you have to refer to them in the function like this:</p><p>// if($variables[‘field’]-&gt;field == ‘field_library_media’) { if($variables[‘field’]-&gt;options[‘id’] == ‘field_library_media_1’) {</p><p>Here is a real example where a media field id is being displayed and I switch it out with the formatted size of the media file.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cd">/**
 * Implements hook_preprocess_views_view_field().
 */</span>
<span class="k">function</span> <span class="n">dirt_bootstrap_preprocess_views_view_field</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$variables</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$view</span> <span class="o">=</span> <span class="nv">$variables</span><span class="p">[</span><span class="s1">'view'</span><span class="p">];</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$view</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'resource_library'</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//    if($variables['field']-&gt;field == 'field_library_media') {</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$variables</span><span class="p">[</span><span class="s1">'field'</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">options</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'field_library_media_1'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$target_id</span> <span class="o">=</span> <span class="nv">$variables</span><span class="p">[</span><span class="s1">'field'</span><span class="p">]</span><span class="o">-&gt;</span><span class="nf">getValue</span><span class="p">(</span><span class="nv">$variables</span><span class="p">[</span><span class="s1">'row'</span><span class="p">]);</span>
      <span class="nv">$file_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$target_id</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$media_item</span> <span class="o">=</span> <span class="nc">Media</span><span class="o">::</span><span class="nf">load</span><span class="p">(</span><span class="nv">$target_id</span><span class="p">);</span>
        <span class="c1">// Get the file.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$media_item</span><span class="o">-&gt;</span><span class="nf">hasField</span><span class="p">(</span><span class="s1">'field_media_document'</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$file_id</span> <span class="o">=</span> <span class="nv">$media_item</span><span class="o">-&gt;</span><span class="n">field_media_document</span><span class="o">-&gt;</span><span class="nf">getValue</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'target_id'</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$media_item</span><span class="o">-&gt;</span><span class="nf">hasField</span><span class="p">(</span><span class="s1">'field_media_image'</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$file_id</span> <span class="o">=</span> <span class="nv">$media_item</span><span class="o">-&gt;</span><span class="n">field_media_image</span><span class="o">-&gt;</span><span class="nf">getValue</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'target_id'</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$media_item</span><span class="o">-&gt;</span><span class="nf">hasField</span><span class="p">(</span><span class="s1">'field_media_audio_file'</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$file_id</span> <span class="o">=</span> <span class="nv">$media_item</span><span class="o">-&gt;</span><span class="n">field_media_audio_file</span><span class="o">-&gt;</span><span class="nf">getValue</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'target_id'</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$media_item</span><span class="o">-&gt;</span><span class="nf">hasField</span><span class="p">(</span><span class="s1">'field_media_video_file'</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$file_id</span> <span class="o">=</span> <span class="nv">$media_item</span><span class="o">-&gt;</span><span class="n">field_media_video_file</span><span class="o">-&gt;</span><span class="nf">getValue</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'target_id'</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$file_id</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$file</span> <span class="o">=</span> <span class="nc">File</span><span class="o">::</span><span class="nf">load</span><span class="p">(</span><span class="nv">$file_id</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Get file size.</span>
            <span class="nv">$file_size</span> <span class="o">=</span> <span class="nf">format_size</span><span class="p">(</span><span class="nv">$file</span><span class="o">-&gt;</span><span class="nf">getSize</span><span class="p">());</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nv">$variables</span><span class="p">[</span><span class="s1">'output'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$file_size</span><span class="p">;</span> <span class="c1">// Default variable in Twig file is "output"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="concatenate-values-into-a-string-with-join-1"> <a aria-labelledby="concatenate-values-into-a-string-with-join-1" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#concatenate-values-into-a-string-with-join-1"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Concatenate values into a string with join</h3><p>This would typically be used when passing a series of node id's to a view to filter its output.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="p">[</span><span class="nv">node.field_ref_unit.0.target_id</span><span class="p">,</span><span class="nv">node.field_ref_unit.1.target_id</span><span class="p">,</span><span class="nv">node.field_ref_unit.2.target_id</span><span class="p">,</span><span class="nv">node.field_ref_unit.3.target_id</span><span class="p">]</span><span class="o">|</span><span class="nf">join</span><span class="p">(</span><span class="s1">'+'</span><span class="p">)</span> <span class="cp">%}</span>
</code></pre></div></div><p>This produces 1+2+3+4</p><h3 id="loop-through-entity-reference-items-1"> <a aria-labelledby="loop-through-entity-reference-items-1" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#loop-through-entity-reference-items-1"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Loop through entity reference items</h3><p>In <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/templates/content/node--news-story.html.twig</code> I need to loop through a bunch of entity reference values and build a string of id+id+id… (with an undefined number) so:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">node.field_ref_unit</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="nv">blah</span> <span class="err">~</span> <span class="nv">item.target_id</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">loop.last</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">set</span> <span class="nv">blah</span> <span class="o">=</span> <span class="nv">blah</span> <span class="err">~</span> <span class="s1">'+'</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>

<span class="nt">&lt;div&gt;</span>blah:<span class="cp">{{</span> <span class="nv">blah</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>node id: <span class="cp">{{</span> <span class="nv">node.id</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'related_news_for_news_story'</span><span class="p">,</span> <span class="s1">'block_unit'</span><span class="p">,</span> <span class="nv">node.id</span><span class="p">,</span> <span class="nv">blah</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h2 id="twig-filters-and-functions"> <a aria-labelledby="twig-filters-and-functions" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#twig-filters-and-functions"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Twig filters and functions</h2><p>Use these to do almost anything with variables in your twig templates.</p><p>See cheat sheet at <a href="https://www.drupal.org/docs/contributed-modules/twig-tweak/cheat-sheet#s-view-filter">https://www.drupal.org/docs/contributed-modules/twig-tweak/cheat-sheet#s-view-filter</a> also <a href="https://twig.symfony.com/doc/3.x/">https://twig.symfony.com/doc/3.x/</a> for filters and functions</p><p>Here are some examples. A complete list is included below:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="o">&lt;</span><span class="nv">span</span><span class="o">&gt;</span><span class="nv">Hello</span> <span class="nv">I</span> <span class="nv">am</span> <span class="nv">an</span> <span class="nv">html</span> <span class="nv">twig</span><span class="p">,</span> <span class="nv">but</span> <span class="nv">my</span> <span class="nv">html</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">stripped</span><span class="o">&lt;/</span><span class="nv">span</span><span class="o">&gt;</span> <span class="o">| </span><span class="nf">striptags</span> <span class="cp">}}</span>

<span class="cp">{{</span><span class="s1">'welcome'</span> <span class="o">| </span><span class="nf">upper</span> <span class="cp">}}</span>

<span class="cp">{{</span> <span class="nv">data</span> <span class="o">| </span><span class="nf">json_encode</span><span class="p">()</span> <span class="cp">}}</span>

<span class="cp">{%</span><span class="k">filter</span> <span class="nv">upper</span> <span class="cp">%}</span>
 This test becomes uppercase
<span class="cp">{%</span> <span class="k">endfilter</span> <span class="cp">%}</span>
</code></pre></div></div><p>Filters</p><ul><li><a href="https://twig.symfony.com/doc/3.x/filters/abs.html">abs</a><li><a href="https://twig.symfony.com/doc/3.x/filters/batch.html">batch</a><li><a href="https://twig.symfony.com/doc/3.x/filters/capitalize.html">capitalize</a><li><a href="https://twig.symfony.com/doc/3.x/filters/column.html">column</a><li><a href="https://twig.symfony.com/doc/3.x/filters/convert_encoding.html">convert_encoding</a><li><a href="https://twig.symfony.com/doc/3.x/filters/country_name.html">country_name</a><li><a href="https://twig.symfony.com/doc/3.x/filters/currency_name.html">currency_name</a><li><a href="https://twig.symfony.com/doc/3.x/filters/currency_symbol.html">currency_symbol</a><li><a href="https://twig.symfony.com/doc/3.x/filters/data_uri.html">data_uri</a><li><a href="https://twig.symfony.com/doc/3.x/filters/date.html">date</a><li><a href="https://twig.symfony.com/doc/3.x/filters/date_modify.html">date_modify</a><li><a href="https://twig.symfony.com/doc/3.x/filters/default.html">default</a><li><a href="https://twig.symfony.com/doc/3.x/filters/escape.html">escape</a><li><a href="https://twig.symfony.com/doc/3.x/filters/filter.html">filter</a><li><a href="https://twig.symfony.com/doc/3.x/filters/first.html">first</a><li><a href="https://twig.symfony.com/doc/3.x/filters/format.html">format</a><li><a href="https://twig.symfony.com/doc/3.x/filters/format_currency.html">format_currency</a><li><a href="https://twig.symfony.com/doc/3.x/filters/format_date.html">format_date</a><li><a href="https://twig.symfony.com/doc/3.x/filters/format_datetime.html">format_datetime</a><li><a href="https://twig.symfony.com/doc/3.x/filters/format_number.html">format_number</a><li><a href="https://twig.symfony.com/doc/3.x/filters/format_time.html">format_time</a><li><a href="https://twig.symfony.com/doc/3.x/filters/html_to_markdown.html">html_to_markdown</a><li><a href="https://twig.symfony.com/doc/3.x/filters/inky_to_html.html">inky_to_html</a><li><a href="https://twig.symfony.com/doc/3.x/filters/inline_css.html">inline_css</a><li><a href="https://twig.symfony.com/doc/3.x/filters/join.html">join</a><li><a href="https://twig.symfony.com/doc/3.x/filters/json_encode.html">json_encode</a><li><a href="https://twig.symfony.com/doc/3.x/filters/keys.html">keys</a><li><a href="https://twig.symfony.com/doc/3.x/filters/language_name.html">language_name</a><li><a href="https://twig.symfony.com/doc/3.x/filters/last.html">last</a><li><a href="https://twig.symfony.com/doc/3.x/filters/length.html">length</a><li><a href="https://twig.symfony.com/doc/3.x/filters/locale_name.html">locale_name</a><li><a href="https://twig.symfony.com/doc/3.x/filters/lower.html">lower</a><li><a href="https://twig.symfony.com/doc/3.x/filters/map.html">map</a><li><a href="https://twig.symfony.com/doc/3.x/filters/markdown_to_html.html">markdown_to_html</a><li><a href="https://twig.symfony.com/doc/3.x/filters/merge.html">merge</a><li><a href="https://twig.symfony.com/doc/3.x/filters/nl2br.html">nl2br</a><li><a href="https://twig.symfony.com/doc/3.x/filters/number_format.html">number_format</a><li><a href="https://twig.symfony.com/doc/3.x/filters/raw.html">raw</a><li><a href="https://twig.symfony.com/doc/3.x/filters/reduce.html">reduce</a><li><a href="https://twig.symfony.com/doc/3.x/filters/replace.html">replace</a><li><a href="https://twig.symfony.com/doc/3.x/filters/reverse.html">reverse</a><li><a href="https://twig.symfony.com/doc/3.x/filters/round.html">round</a><li><a href="https://twig.symfony.com/doc/3.x/filters/slice.html">slice</a><li><a href="https://twig.symfony.com/doc/3.x/filters/slug.html">slug</a><li><a href="https://twig.symfony.com/doc/3.x/filters/sort.html">sort</a><li><a href="https://twig.symfony.com/doc/3.x/filters/spaceless.html">spaceless</a><li><a href="https://twig.symfony.com/doc/3.x/filters/split.html">split</a><li><a href="https://twig.symfony.com/doc/3.x/filters/striptags.html">striptags</a><li><a href="https://twig.symfony.com/doc/3.x/filters/timezone_name.html">timezone_name</a><li><a href="https://twig.symfony.com/doc/3.x/filters/title.html">title</a><li><a href="https://twig.symfony.com/doc/3.x/filters/trim.html">trim</a><li><a href="https://twig.symfony.com/doc/3.x/filters/u.html">u</a><li><a href="https://twig.symfony.com/doc/3.x/filters/upper.html">upper</a><li><a href="https://twig.symfony.com/doc/3.x/filters/url_encode.html">url_encode</a></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><p>Functions</p><ul><li><a href="https://twig.symfony.com/doc/3.x/functions/attribute.html">attribute</a><li><a href="https://twig.symfony.com/doc/3.x/functions/block.html">block</a><li><a href="https://twig.symfony.com/doc/3.x/functions/constant.html">constant</a><li><a href="https://twig.symfony.com/doc/3.x/functions/country_names.html">country_names</a><li><a href="https://twig.symfony.com/doc/3.x/functions/country_timezones.html">country_timezones</a><li><a href="https://twig.symfony.com/doc/3.x/functions/currency_names.html">currency_names</a><li><a href="https://twig.symfony.com/doc/3.x/functions/cycle.html">cycle</a><li><a href="https://twig.symfony.com/doc/3.x/functions/date.html">date</a><li><a href="https://twig.symfony.com/doc/3.x/functions/dump.html">dump</a><li><a href="https://twig.symfony.com/doc/3.x/functions/html_classes.html">html_classes</a><li><a href="https://twig.symfony.com/doc/3.x/functions/include.html">include</a><li><a href="https://twig.symfony.com/doc/3.x/functions/language_names.html">language_names</a><li><a href="https://twig.symfony.com/doc/3.x/functions/locale_names.html">locale_names</a><li><a href="https://twig.symfony.com/doc/3.x/functions/max.html">max</a><li><a href="https://twig.symfony.com/doc/3.x/functions/min.html">min</a><li><a href="https://twig.symfony.com/doc/3.x/functions/parent.html">parent</a><li><a href="https://twig.symfony.com/doc/3.x/functions/random.html">random</a><li><a href="https://twig.symfony.com/doc/3.x/functions/range.html">range</a><li><a href="https://twig.symfony.com/doc/3.x/functions/script_names.html">script_names</a><li><a href="https://twig.symfony.com/doc/3.x/functions/source.html">source</a><li><a href="https://twig.symfony.com/doc/3.x/functions/template_from_string.html">template_from_string</a><li><a href="https://twig.symfony.com/doc/3.x/functions/timezone_names.html">timezone_names</a></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><h2 id="twig-tweak"> <a aria-labelledby="twig-tweak" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#twig-tweak"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Twig Tweak</h2><p>This is an <strong>essential</strong> module to add to all projects.</p><h3 id="documentation"> <a aria-labelledby="documentation" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#documentation"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Documentation</h3><p>There are some docs at <a href="https://www.drupal.org/docs/contributed-modules/twig-tweak/rendering-blocks-with-twig-tweak">https://www.drupal.org/docs/contributed-modules/twig-tweak/rendering-blocks-with-twig-tweak</a></p><p>and a cheat sheet at <a href="https://git.drupalcode.org/project/twig_tweak/-/blob/3.x/docs/cheat-sheet.md">https://git.drupalcode.org/project/twig_tweak/-/blob/3.x/docs/cheat-sheet.md</a></p><h3 id="display-a-block-with-twig_tweak"> <a aria-labelledby="display-a-block-with-twig_tweak" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#display-a-block-with-twig_tweak"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Display a block with twig_tweak</h3><p>Here is a simple example:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">drupal_block</span><span class="p">(</span><span class="s1">'plugin_id'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>It looks like the best source of information is really in the <a href="https://git.drupalcode.org/project/twig_tweak/-/blob/3.x/src/TwigTweakExtension.php">source file</a> or at: web/modules/contrib/twig_tweak/src/TwigExtension.php</p><p>All the variations are listed there including the instructions to get drush to list all the blocks on your site.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>drush ev <span class="s2">"print_r(array_keys(</span><span class="se">\D</span><span class="s2">rupal::service('plugin.manager.block')-&gt;getDefinitions()));"</span>
</code></pre></div></div><p>It outputs something like:</p><p><img alt="Block listing" src="https://selwynpolit.github.io/d9book/assets/images/block_listing.png"/></p><h3 id="display-filter-form-block"> <a aria-labelledby="display-filter-form-block" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#display-filter-form-block"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Display filter form block</h3><p>You can then use this to display your ajax exposed filter form block</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="cp">{{</span> <span class="nv">drupal_block</span><span class="p">(</span><span class="s1">'views_exposed_filter_block:news_listing_for_news_landing-page_1'</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="embed-view-in-twig-template"> <a aria-labelledby="embed-view-in-twig-template" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#embed-view-in-twig-template"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Embed view in twig template</h3><p>In <code class="language-plaintext highlighter-rouge">inside-marthe/themes/custom/dprime/templates/content/node-overview.html.twig</code> there is a view rendered in the twig template. This requires the <a href="https://www.drupal.org/project/twig_tweak">twig tweak</a> module:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"l-sidebar-content"</span><span class="nt">&gt;</span>
  <span class="cp">{%</span> <span class="k">include</span> <span class="s1">'@danaprime/partials/subnav.html.twig'</span> <span class="cp">%}</span>
  <span class="cp">{{</span><span class="nv">content.field_ref_sidebars</span><span class="cp">}}</span>
  <span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'news'</span><span class="p">,</span> <span class="s1">'embed_page_sidebar'</span><span class="p">,</span> <span class="nv">content.field_news_categories</span><span class="o">|</span><span class="nf">render</span><span class="o">|</span><span class="nf">trim</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><p>You can, also specify additional parameters which map to contextual filters you have configured in your view.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">drupal_view</span><span class="p">(</span><span class="s1">'who_s_new'</span><span class="p">,</span> <span class="s1">'block_1'</span><span class="p">,</span> <span class="nv">arg_1</span><span class="p">,</span> <span class="nv">arg_2</span><span class="p">,</span> <span class="nv">arg_3</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="some-tricky-quotes-magic"> <a aria-labelledby="some-tricky-quotes-magic" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#some-tricky-quotes-magic"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Some tricky quotes magic</h3><p>Here I am trying to create a string <code class="language-plaintext highlighter-rouge">type="aof"</code> so I had to escape at least one of the quotes like this \" (backslash and double quote)</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">set</span> <span class="nv">office_type</span> <span class="o">=</span> <span class="s1">'type=\"'</span> <span class="err">~</span> <span class="nv">item.type</span> <span class="err">~</span> <span class="s1">'"'</span> <span class="cp">%}</span>
</code></pre></div></div><p>The entire piece of debug code is reproduced below:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div&gt;</span>
  <span class="cp">{%</span> <span class="k">for</span> <span class="k">filter</span> <span class="ow">in</span> <span class="nv">filter_data</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">filter.type</span> <span class="o">==</span> <span class="s1">'office'</span> <span class="cp">%}</span>
      <span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">filter.info</span> <span class="cp">%}</span>
        type=<span class="cp">{{</span> <span class="nv">filter.type</span> <span class="cp">}}</span>, title = <span class="cp">{{</span> <span class="nv">item.title</span> <span class="cp">}}</span>, value = <span class="cp">{{</span> <span class="nv">item.value</span> <span class="cp">}}</span>, selected= <span class="cp">{{</span> <span class="nv">item.selected</span> <span class="cp">}}</span>, item.type = <span class="cp">{{</span> <span class="nv">item.type</span> <span class="cp">}}</span><span class="nt">&lt;br&gt;</span>
        <span class="cp">{%</span> <span class="k">set</span> <span class="nv">officetype</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
        <span class="cp">{%</span> <span class="k">if</span> <span class="nv">item.type</span> <span class="ow">is</span> <span class="nb">defined</span> <span class="ow">and</span> <span class="nv">item.type</span> <span class="cp">%}</span>
          <span class="cp">{%</span> <span class="k">set</span> <span class="nv">office_type</span> <span class="o">=</span> <span class="s1">'type=\"'</span> <span class="err">~</span> <span class="nv">item.type</span> <span class="err">~</span> <span class="s1">'"'</span> <span class="cp">%}</span>
          Office_type:<span class="cp">{{</span> <span class="nv">office_type</span> <span class="cp">}}</span> <span class="nt">&lt;br&gt;</span>
        <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
      <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div><p>The real implementation is shown below:</p><p>From <code class="language-plaintext highlighter-rouge">txg/web/themes/custom/txg/templates/partials/searchfilterform.html.twig</code></p><p>See the line below that sets office_type = …</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="ow">in</span> <span class="nv">filter.info</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">selected</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">item.selected</span> <span class="ow">is</span> <span class="nb">defined</span> <span class="ow">and</span> <span class="nv">item.selected</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">set</span> <span class="nv">selected</span> <span class="o">=</span> <span class="s1">'selected'</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">set</span> <span class="nv">officetype</span> <span class="o">=</span> <span class="s1">''</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">item.type</span> <span class="ow">is</span> <span class="nb">defined</span> <span class="ow">and</span> <span class="nv">item.type</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">set</span> <span class="nv">office_type</span> <span class="o">=</span> <span class="s1">'type=\"'</span> <span class="err">~</span> <span class="nv">item.type</span> <span class="err">~</span> <span class="s1">'"'</span> <span class="cp">%}</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"/search-news?</span><span class="cp">{{</span> <span class="nv">filter.type</span> <span class="cp">}}</span><span class="s">=</span><span class="cp">{{</span> <span class="nv">item.value</span> <span class="cp">}}</span><span class="s"> </span><span class="cp">{{</span> <span class="nv">office_type</span> <span class="cp">}}</span><span class="s">"</span> <span class="cp">{{</span> <span class="nv">selected</span> <span class="cp">}}</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">item.title</span> <span class="cp">}}</span><span class="nt">&lt;/option&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</code></pre></div></div><h2 id="troubleshooting"> <a aria-labelledby="troubleshooting" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#troubleshooting"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Troubleshooting</h2><h3 id="enable-twig-debugging-and-disable-caches"> <a aria-labelledby="enable-twig-debugging-and-disable-caches" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#enable-twig-debugging-and-disable-caches"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Enable Twig debugging and disable caches</h3><p>This will cause twig debugging information to be displayed in the HTML code like the following:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- THEME DEBUG --&gt;</span>
<span class="c">&lt;!-- THEME HOOK: 'toolbar' --&gt;</span>
<span class="c">&lt;!-- BEGIN OUTPUT from 'core/themes/stable/templates/navigation/toolbar.html.twig' --&gt;</span>

</code></pre></div></div><p>and</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- THEME DEBUG --&gt;</span>
<span class="c">&lt;!-- THEME HOOK: 'page' --&gt;</span>
<span class="c">&lt;!-- FILE NAME SUGGESTIONS:
   * page--teks--admin--srp--program--expectation--correlation--vote-all.html.twig
   * page--teks--admin--srp--program--expectation--correlation--852136.html.twig
   * page--teks--admin--srp--program--expectation--correlation--%.html.twig
   * page--teks--admin--srp--program--expectation--correlation.html.twig
   * page--teks--admin--srp--program--expectation--852131.html.twig
   * page--teks--admin--srp--program--expectation--%.html.twig
   * page--teks--admin--srp--program--expectation.html.twig
   * page--teks--admin--srp--program--852061.html.twig
   * page--teks--admin--srp--program--%.html.twig
   * page--teks--admin--srp--program.html.twig
   * page--teks--admin--srp.html.twig
   x page--teks--admin.html.twig
   * page--teks.html.twig
   * page.html.twig
--&gt;</span>
</code></pre></div></div><p>In <code class="language-plaintext highlighter-rouge">sites/default/development.services.yml</code> in the <code class="language-plaintext highlighter-rouge">parameters</code>, <code class="language-plaintext highlighter-rouge">twig.config</code>, set <code class="language-plaintext highlighter-rouge">debug:true</code>. See <code class="language-plaintext highlighter-rouge">core.services.yml</code> for lots of other items to change for development.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Local development services.</span>
<span class="c1">#</span>
<span class="na">parameters</span><span class="pi">:</span>
  <span class="na">http.response.debug_cacheability_headers</span><span class="pi">:</span> <span class="kc">true</span>
  <span class="na">twig.config</span><span class="pi">:</span>
    <span class="na">debug</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">auto_reload</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">cache</span><span class="pi">:</span> <span class="kc">false</span>

<span class="c1"># To disable caching, you need this and a few other items</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">cache.backend.null</span><span class="pi">:</span>
    <span class="na">class</span><span class="pi">:</span> <span class="s">Drupal\Core\Cache\NullBackendFactory</span>
</code></pre></div></div><p>You also need this in <code class="language-plaintext highlighter-rouge">settings.local.php</code>:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cd">/**
 * Enable local development services.
 */</span>
<span class="nv">$settings</span><span class="p">[</span><span class="s1">'container_yamls'</span><span class="p">][]</span> <span class="o">=</span> <span class="no">DRUPAL_ROOT</span> <span class="mf">.</span> <span class="s1">'/sites/development.services.yml'</span><span class="p">;</span>
</code></pre></div></div><p>You also need to disable the render cache in <code class="language-plaintext highlighter-rouge">settings.local.php</code>. Here all caching is disabled with:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$config</span><span class="p">[</span><span class="s1">'system.performance'</span><span class="p">][</span><span class="s1">'css'</span><span class="p">][</span><span class="s1">'preprocess'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">;</span>
<span class="nv">$config</span><span class="p">[</span><span class="s1">'system.performance'</span><span class="p">][</span><span class="s1">'js'</span><span class="p">][</span><span class="s1">'preprocess'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">;</span>
<span class="nv">$settings</span><span class="p">[</span><span class="s1">'cache'</span><span class="p">][</span><span class="s1">'bins'</span><span class="p">][</span><span class="s1">'render'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cache.backend.null'</span><span class="p">;</span>
<span class="nv">$settings</span><span class="p">[</span><span class="s1">'cache'</span><span class="p">][</span><span class="s1">'bins'</span><span class="p">][</span><span class="s1">'page'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cache.backend.null'</span><span class="p">;</span>
<span class="nv">$settings</span><span class="p">[</span><span class="s1">'cache'</span><span class="p">][</span><span class="s1">'bins'</span><span class="p">][</span><span class="s1">'dynamic_page_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cache.backend.null'</span><span class="p">;</span>
</code></pre></div></div><h3 id="debugging---dump-a-variable"> <a aria-labelledby="debugging---dump-a-variable" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#debugging---dump-a-variable"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Debugging - Dump a variable</h3><p>When troubleshooting or trying to make sense of what is being output, use dump.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;</span>
Dump node.created.value:
<span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">node.created.value</span><span class="p">)</span> <span class="cp">}}</span>
Dump node.changed.value:
<span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">node.changed.value</span><span class="p">)</span> <span class="cp">}}</span>
Dump node.published_at.value:
<span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">node.published_at.value</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/pre&gt;</span>
</code></pre></div></div><p>The output might look like this. Note the published value may be null as I didn’t use Drupal scheduling to publish the node:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dump node.created.value:
string(10) \"1604034000\"

Dump node.changed.value:
string(10) \"1604528207\"

Dump node.published_at.value:
NULL
</code></pre></div></div><h3 id="dump-taxonomy-reference-field"> <a aria-labelledby="dump-taxonomy-reference-field" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#dump-taxonomy-reference-field"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Dump taxonomy reference field</h3><p>Here we dump a taxonomy reference field which is useful for debugging purposes. The pre tags format it a little nicer than if we don’t have them.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;</span>
  <span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">paragraph.field_ref_tax.value</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/pre&gt;</span>
</code></pre></div></div><p>And get ouput:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(2) {
  [0]=&gt;
  array(4) {
    ["target_id"]=&gt;
    string(2) "13"
    ["_attributes"]=&gt;
    array(0) {
    }
    ["_loaded"]=&gt;
    bool(true)
    ["_accessCacheability"]=&gt;
    object(Drupal\Core\Cache\CacheableMetadata)#7683 (3) {
      ["cacheContexts":protected]=&gt;
      array(1) {
        [0]=&gt;
        string(16) "user.permissions"
      }
      ["cacheTags":protected]=&gt;
      array(0) {
      }
      ["cacheMaxAge":protected]=&gt;
      int(-1)
    }
  }
  [1]=&gt;
  array(4) {
    ["target_id"]=&gt;
    string(2) "16"
    ["_attributes"]=&gt;
    array(0) {
    }
    ["_loaded"]=&gt;
    bool(true)
    ["_accessCacheability"]=&gt;
    object(Drupal\Core\Cache\CacheableMetadata)#7705 (3) {
      ["cacheContexts":protected]=&gt;
      array(1) {
        [0]=&gt;
        string(16) "user.permissions"
      }
      ["cacheTags":protected]=&gt;
      array(0) {
      }
      ["cacheMaxAge":protected]=&gt;
      int(-1)
    }
  }
}
</code></pre></div></div><h3 id="using-kint-or-dump-to-display-variable-in-a-template"> <a aria-labelledby="using-kint-or-dump-to-display-variable-in-a-template" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#using-kint-or-dump-to-display-variable-in-a-template"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Using kint or dump to display variable in a template</h3><p>With <code class="language-plaintext highlighter-rouge">devel</code> and <code class="language-plaintext highlighter-rouge">devel: kint</code> enabled, you can display variables in templates. Here we show the content variable from the above block template. Note. There is also a built in <code class="language-plaintext highlighter-rouge">dump()</code> function which is super useful.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">kint</span><span class="p">(</span><span class="nv">content</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>You can also</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">content</span><span class="p">)</span> <span class="cp">}}</span>
</code></pre></div></div><p>And dump a value from a paragraph field. The pre tags will format the output a little more sanely.</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;</span>
<span class="cp">{{</span> <span class="nv">dump</span><span class="p">(</span><span class="nv">paragraph.field_ref_tax.value</span><span class="p">)</span> <span class="cp">}}</span>
<span class="nt">&lt;/pre&gt;</span>
</code></pre></div></div><p>Or the body field:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">kint</span><span class="p">(</span><span class="nv">content</span><span class="p">[</span><span class="s1">'body'</span><span class="p">])</span> <span class="cp">}}</span>
</code></pre></div></div><p>Or the tags field content[‘field_tags’]</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{{</span> <span class="nv">kint</span><span class="p">(</span><span class="nv">content</span><span class="p">[</span><span class="s1">'field_tags'</span><span class="p">])</span> <span class="cp">}}</span>
</code></pre></div></div><h3 id="502-bad-gateway-error"> <a aria-labelledby="502-bad-gateway-error" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#502-bad-gateway-error"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> 502 bad gateway error</h3><p>While working on Twig changes, if you ever see a 502 bad gateway error, try commenting out the twig template code you just added and see if it displays. I know, it’s not a friendly error at all!</p><h3 id="views-error"> <a aria-labelledby="views-error" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#views-error"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Views error</h3><p>If you ever see a 502 bad gateway error when embedding a drupal_view, delete the display and create a new one and it may just work fine.</p><h3 id="striptags-when-twig-debug-info-causes-if-to-fail"> <a aria-labelledby="striptags-when-twig-debug-info-causes-if-to-fail" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#striptags-when-twig-debug-info-causes-if-to-fail"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Striptags (when twig debug info causes if to fail)</h3><p>When you care about the output being affected by twig debugging, you need to use <code class="language-plaintext highlighter-rouge">striptags</code>. In this case, because I enabled twig debugging, the content.field_landing_opinion_page_type was not ever <code class="language-plaintext highlighter-rouge">'ORD</code>’</p><p>So here I compare a field value so I have to use striptags to remove all html. I ended up using the combination of <code class="language-plaintext highlighter-rouge">render|striptags|trim</code>:</p><div class="language-twig highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span> <span class="k">if</span> <span class="nv">content.field_landing_opinion_page_type</span><span class="o">|</span><span class="nf">render</span><span class="o">|</span><span class="nf">striptags</span><span class="o">|</span><span class="nf">trim</span> <span class="o">==</span> <span class="s1">'ORD'</span> <span class="cp">%}</span>
  <span class="cp">{{</span> <span class="nv">drupal_block</span><span class="p">(</span><span class="s1">'opinion_landing'</span><span class="p">,</span> <span class="nv">wrapper</span><span class="o">=</span><span class="nv">false</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></div><h2 id="reference"> <a aria-labelledby="reference" class="anchor-heading" href="https://selwynpolit.github.io/d9book/twig#reference"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Reference</h2><ul><li><p>Drupal 10 uses <strong>Twig 3</strong>. Drupal 9 uses Twig 2. Drupal 8 used Twig 1.</p><li><p><a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21theme.api.php/group/themeable/10">Theme system overview on api.drupal.org</a></p><li><p><a href="https://twig.symfony.com/doc/3.x/">Twig 3 documentation</a></p><li><p><a href="https://www.drupal.org/docs/theming-drupal">Drupal.org Theming documentation</a></p><li><p><a href="https://www.drupal.org/docs/theming-drupal/twig-in-drupal/functions-in-twig-templates">Handy Twig functions you can use directly in templates - Updated Jan 2023</a></p><li><p><a href="https://git.drupalcode.org/project/twig_tweak/-/blob/3.x/docs/cheat-sheet.md">Twig Tweak 3 cheat sheet Updated October 2022</a></p><li><p><a href="https://www.drupal.org/docs/contributed-modules/twig-tweak-2x/cheat-sheet#s-view-filter">Twig Tweak 2 cheat sheet Updated May 2022</a></p><li><p><a href="https://www.drupal.org/docs/8/theming-drupal-8/using-attributes-in-templates">Using attributes in templates updated March 2023</a></p><li><p><a href="https://www.drupal.org/docs/8/modules/twig-tweak/twig-tweak-and-views">Twig tweaks and Views has some useful notes on using twig tweak with views - Updated November 2020</a></p></li></li></li></li></li></li></li></li></li></ul><hr/> <script async="" crossorigin="anonymous" data-category="Q&amp;A" data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyMjY2NDE4" data-emit-metadata="0" data-input-position="bottom" data-lang="en" data-mapping="title" data-reactions-enabled="1" data-repo="selwynpolit/d9book" data-repo-id="MDEwOlJlcG9zaXRvcnkzMjUxNTQ1Nzg=" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"> </script><hr/><footer><p><a href="https://selwynpolit.github.io/d9book/twig#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0"><span xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"> <a href="http://www.selwynpolit.github.io/d9book" property="dct:title" rel="cc:attributionURL">Drupal at your fingertips</a> by <a href="http://www.drupal.org/u/selwynpolit" property="cc:attributionName" rel="cc:attributionURL dct:creator">Selwyn Polit</a> is licensed under <a href="http://creativecommons.org/licenses/by/4.0/" rel="license noopener noreferrer" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height:16px!important;vertical-align:text-bottom;"/> <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height:16px!important;vertical-align:text-bottom;"/> </a></span></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0 mr-2"> Page last modified: <span class="d-inline-block">Apr 28 2023</span>.</p><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/selwynpolit/d9book/tree/gh-pages/book/twig.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
</body></link></meta></meta></meta></head></html>