<!DOCTYPE html>
<html lang="en-US"><head><meta charset="utf-8"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><link href="https://selwynpolit.github.io/d9book/assets/css/just-the-docs-default.css" rel="stylesheet"/> <script async="" src="https://www.googletagmanager.com/gtag/js?id=8V22RQEJ71"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '8V22RQEJ71', { 'anonymize_ip': true }); </script> <script src="https://selwynpolit.github.io/d9book/assets/js/vendor/lunr.min.js"></script> <script src="https://selwynpolit.github.io/d9book/assets/js/just-the-docs.js"></script><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://selwynpolit.github.io/d9book/assets/images/favicon.ico" rel="icon" type="image/x-icon"/><title>Modals | Drupal Book</title><meta content="Jekyll v4.3.2" name="generator"><meta content="Modals" property="og:title"><meta content="en_US" property="og:locale"><meta content="Drupal at your fingertips" name="description"/><meta content="Drupal at your fingertips" property="og:description"/><link href="https://selwynpolit.github.io/d9book/d9book/modals" rel="canonical"><meta content="https://selwynpolit.github.io/d9book/d9book/modals" property="og:url"/><meta content="Drupal Book" property="og:site_name"/><meta content="website" property="og:type"/><meta content="summary" name="twitter:card"/><meta content="Modals" property="twitter:title"/> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Drupal at your fingertips","headline":"Modals","url":"https://selwynpolit.github.io/d9book/d9book/modals"}</script><body> <a class="skip-to-main" href="https://selwynpolit.github.io/d9book/modals#main-content">Skip to main content</a> <svg class="d-none" xmlns="http://www.w3.org/2000/svg"> <symbol id="svg-link" viewbox="0 0 24 24"><title>Link</title><svg class="feather feather-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"><title>Menu</title><svg class="feather feather-menu" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><line x1="3" x2="21" y1="12" y2="12"></line><line x1="3" x2="21" y1="6" y2="6"></line><line x1="3" x2="21" y1="18" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"><title>Expand</title><svg class="feather feather-chevron-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol class="feather feather-external-link" fill="none" height="24" id="svg-external-link" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"><title>Document</title><svg class="feather feather-file" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"><title>Search</title><svg class="feather feather-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"> <circle cx="11" cy="11" r="8"></circle><line x1="21" x2="16.65" y1="21" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewbox="0 0 16 16"><title>Copy</title><svg class="bi bi-clipboard" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewbox="0 0 16 16"><title>Copied</title><svg class="bi bi-clipboard-check-fill" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a class="site-title lh-tight" href="https://selwynpolit.github.io/d9book/"> Drupal Book </a> <a class="site-button" href="https://selwynpolit.github.io/d9book/modals" id="menu-button"> <svg class="icon" viewbox="0 0 24 24"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" class="site-nav" id="site-nav"><ul class="nav-list"><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/">Home</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/actions">Actions</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/attribution">Attribution</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/bq">Batch and Queue</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/blocks">Blocks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/caching">Caching</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/composer">Composer</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/config">Config</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/cron">Cron</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dates">Dates and Times</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/debugging">Debugging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/development">Development</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/drush">Drush</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/email">Email</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/entities">Entities</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/forms">Forms</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/general">General</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/off-island">Getting off the Island</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/hooks">Hooks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/learn">Learning</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/links">Links</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/logging">Logging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/menus">Menus</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/migrate">Migrate</a><li class="nav-list-item active"><a class="nav-list-link active" href="https://selwynpolit.github.io/d9book/modals">Modals</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/nodes-and-fields">Nodes and Fields</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/queries">Queries</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/redirects">Redirects</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/render">Render Arrays</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/routes">Routes</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/security">Security</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/services">Services</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/state">State</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/taxonomy">Taxonomy</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dtt">Tests</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/twig">Twig</a></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><ul class="nav-list"><li class="nav-list-item external"> <a class="nav-list-link external" href="https://github.com/selwynpolit/d9book/fork"> Fork me on GitHub <svg aria-labelledby="svg-external-link-title" viewbox="0 0 24 24"><use xlink:href="#svg-external-link"></use></svg> </a></li></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div class="main-header" id="main-header"><div class="search"><div class="search-input-wrap"> <input aria-label="Search Drupal Book" autocomplete="off" class="search-input" id="search-input" placeholder="Search Drupal Book" tabindex="0" type="text"/> <label class="search-label" for="search-input"><svg class="search-icon" viewbox="0 0 24 24"><use xlink:href="#svg-search"></use></svg></label></div><div class="search-results" id="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a class="site-button" href="https://twitter.com/selwynpolit" rel="noopener noreferrer" target="_blank"> <img alt="Twitter logo" src="https://atuin.ru/demo/simple-icons/icons/twitter.svg" style="width: 30px; height: 30px;" title="Author in Twitter"/> </a><li class="aux-nav-list-item"> <a class="site-button" href="https://github.com/selwynpolit/d9book/tree/gh-pages" rel="noopener noreferrer" target="_blank"> <img alt="GitHub logo" src="https://atuin.ru/demo/simple-icons/icons/github.svg" style="width: 30px; height: 30px;" title="D9Book on GitHub"/> </a></li></li></ul></nav></div><div class="main-content-wrap" id="main-content-wrap"><div class="main-content" id="main-content" role="main"><h1 class="no_toc fw-500" id="modal-dialogs"> <a aria-labelledby="modal-dialogs" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#modal-dialogs"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Modal Dialogs</h1><h2 class="no_toc text-delta" id="table-of-contents"> <a aria-labelledby="table-of-contents" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#table-of-contents"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ul id="markdown-toc"><li><a href="https://selwynpolit.github.io/d9book/modals#overview" id="markdown-toc-overview">Overview</a><li><a href="https://selwynpolit.github.io/d9book/modals#dialog-title" id="markdown-toc-dialog-title">Dialog title</a><li><a href="https://selwynpolit.github.io/d9book/modals#links-to-slide-in-dialogs" id="markdown-toc-links-to-slide-in-dialogs">Links to slide-in dialogs</a><li><a href="https://selwynpolit.github.io/d9book/modals#modal-dialog-example" id="markdown-toc-modal-dialog-example">Modal dialog example</a><ul><li><a href="https://selwynpolit.github.io/d9book/modals#passing-entities-as-parameters" id="markdown-toc-passing-entities-as-parameters">Passing entities as parameters</a></li></ul><li><a href="https://selwynpolit.github.io/d9book/modals#modal-form-example" id="markdown-toc-modal-form-example">Modal form example</a><li><a href="https://selwynpolit.github.io/d9book/modals#slide-in-dialogoff-canvas-dialog" id="markdown-toc-slide-in-dialogoff-canvas-dialog">Slide-in dialog/Off-canvas dialog</a><li><a href="https://selwynpolit.github.io/d9book/modals#slide-in-dialog-example" id="markdown-toc-slide-in-dialog-example">Slide-in Dialog Example</a><li><a href="https://selwynpolit.github.io/d9book/modals#block-with-a-link-to-popup-a-custom-modal-dialog" id="markdown-toc-block-with-a-link-to-popup-a-custom-modal-dialog">Block with a link to popup a custom modal dialog</a><li><a href="https://selwynpolit.github.io/d9book/modals#no-code-modal-dialogs" id="markdown-toc-no-code-modal-dialogs">No-code modal dialogs</a><li><a href="https://selwynpolit.github.io/d9book/modals#resources" id="markdown-toc-resources">Resources</a></li></li></li></li></li></li></li></li></li></li></ul><p><img alt="views" src="https://api.visitor.plantree.me/visitor-badge/pv?label=views&amp;color=informational&amp;namespace=d9book&amp;key=modals.md"/></p><hr/><h2 id="overview"> <a aria-labelledby="overview" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#overview"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Overview</h2><p>There are several ways to create modal dialogs in Drupal. Modal dialogs provide a way to display additional information without having to reload the entire page. These dialogs can display anything you can imagine including static text, an image, a node, a form, a view or any custom markup.</p><h2 id="dialog-title"> <a aria-labelledby="dialog-title" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#dialog-title"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Dialog title</h2><p>You define the title for the dialog by specifying it in the *.routing.yml file. In the file below the title is in the _title key:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">taa.srp_delete_citation</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/taa/admin</span><span class="nv"> </span><span class="s">/citation/delete/citation/{citation}'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Delete</span><span class="nv"> </span><span class="s">Citation'</span>
    <span class="na">_form</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Drupal\taa\Form\DeleteCitationForm'</span>
</code></pre></div></div><p><img alt="Modal dialog title" src="https://selwynpolit.github.io/d9book/assets/images/dialog-title.png"/></p><h2 id="links-to-slide-in-dialogs"> <a aria-labelledby="links-to-slide-in-dialogs" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#links-to-slide-in-dialogs"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Links to slide-in dialogs</h2><p>In your controller (or in a form) you can define links in your render array which can fire off the slide-in dialogs. E.g.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">Drupal\Component\Serialization\Json</span><span class="p">;</span>

<span class="nv">$submit_for_review_link</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
  <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nf">t</span><span class="p">(</span><span class="s1">'Submit for Review'</span><span class="p">),</span>
  <span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'taa_teks_publisher.submit_for_review'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'node'</span> <span class="o">=&gt;</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">(),</span> <span class="s1">'return_type'</span> <span class="o">=&gt;</span> <span class="s1">'program'</span><span class="p">]),</span>
  <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">,</span> <span class="s1">'button'</span><span class="p">],</span>
    <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'edit-program-'</span> <span class="mf">.</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">(),</span>
    <span class="s1">'data-dialog-renderer'</span> <span class="o">=&gt;</span> <span class="s1">'off_canvas'</span><span class="p">,</span>
    <span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'dialog'</span><span class="p">,</span>
    <span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">(</span>
      <span class="p">[</span>
        <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'600'</span><span class="p">,</span>
      <span class="p">]</span>
    <span class="p">),</span>
  <span class="p">],</span>
<span class="p">];</span>
</code></pre></div></div><p>Notice the data-dialog- options. ‘off_canvas’ is the magic sauce. Also note that the parameters that are passed to the form are ‘node’ and ‘return_type’ which are specified in the route below also.</p><p>Note the class ‘button’ will make this link show up as a button. If you remove it, this will instead just be a link.</p><p>You could easily make this a modal dialog by specifying:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'modal'</span><span class="p">,</span>
<span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">([</span> <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'auto'</span><span class="p">,]),</span>
</code></pre></div></div><h2 id="modal-dialog-example"> <a aria-labelledby="modal-dialog-example" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#modal-dialog-example"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Modal dialog example</h2><p>This example displays a page with links to pop up two different modal dialogs. Clicking on either of the links will display a slightly different modal dialogs. The page looks like this: <img alt="modal example 1" src="https://selwynpolit.github.io/d9book/assets/images/modal-example1.png"/></p><p>Here is the routing file at web/modules/custom/modal_examples/modal_examples.routing.yml.</p><p>The first route (modal_examples.example1) displays the links. The second route (modal_examples.modal1) allows the modal be displayed on a page on its own. This route also has parameters which can be useful when you want to display some relevant variable information in the dialog.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Controller with buttons to open modals</span>
<span class="na">modal_examples.example1</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/example1'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Modal</span><span class="nv"> </span><span class="s">Examples</span><span class="nv"> </span><span class="s">(example1)'</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\modal_examples\Controller\ModalExamplesController::buildExample1'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">access</span><span class="nv"> </span><span class="s">content'</span>
<span class="c1"># first modal</span>
<span class="na">modal_examples.modal1</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/modal1/{program_id}/{type}'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Modal</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">parameters'</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\modal_examples\Controller\ModalExamplesController::buildModal1'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">access</span><span class="nv"> </span><span class="s">content'</span>
  <span class="na">options</span><span class="pi">:</span>
    <span class="na">parameters</span><span class="pi">:</span>
      <span class="na">program_id</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span>
    <span class="na">no_cache</span><span class="pi">:</span> <span class="s1">'</span><span class="s">TRUE'</span>


<span class="c1"># Second modal </span>
<span class="c1"># You can't use this route directly</span>
<span class="c1"># route for modal to display a teaser of a node in a dialog</span>
<span class="na">modal_examples.modal2</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/create-my-dialog'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\modal_examples\Controller\ModalExamplesController2::createDialogFromNode'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_access</span><span class="pi">:</span> <span class="s1">'</span><span class="s">TRUE'</span>
</code></pre></div></div><p>In web/modules/custom/modal_examples/src/Controller/ModalExamplesController.php are the functions for both the page (which displays the link) and first modal.</p><p>Add the parameters to the end of the <code class="language-plaintext highlighter-rouge">Url::fromRoute()</code> call to pass them to the modal. You will probably do this a lot.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'modal_examples.modal1'</span><span class="p">,</span> <span class="p">[</span>
  <span class="s1">'program_id'</span>     <span class="o">=&gt;</span> <span class="mi">123</span><span class="p">,</span>
  <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'all'</span><span class="p">,</span>
 <span class="p">]),</span>
</code></pre></div></div><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">Drupal\modal_examples\Controller</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Drupal\Component\Serialization\Json</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Controller\ControllerBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Url</span><span class="p">;</span>

<span class="cd">/**
 * Returns responses for Modal Examples routes.
 */</span>
<span class="kd">class</span> <span class="nc">ModalExamplesController</span> <span class="kd">extends</span> <span class="nc">ControllerBase</span> <span class="p">{</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">buildExample1</span><span class="p">()</span> <span class="p">{</span>

    <span class="nv">$route_name</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">routeMatch</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getRouteName</span><span class="p">();</span>
    <span class="nv">$build</span><span class="p">[</span><span class="s1">'content'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'item'</span><span class="p">,</span>
      <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Route: %route'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'%route'</span> <span class="o">=&gt;</span> <span class="nv">$route_name</span><span class="p">]),</span>
    <span class="p">];</span>

    <span class="nv">$build</span><span class="p">[</span><span class="s1">'link-to-modal1'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span>       <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
      <span class="s1">'#title'</span>      <span class="o">=&gt;</span> <span class="nf">t</span><span class="p">(</span><span class="s1">'Link to a custom modal (modal1)'</span><span class="p">),</span>
      <span class="s1">'#url'</span>        <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'modal_examples.modal1'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'program_id'</span>     <span class="o">=&gt;</span> <span class="mi">123</span><span class="p">,</span>
        <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'all'</span><span class="p">,</span>
      <span class="p">]),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'view-correlation-'</span> <span class="mf">.</span> <span class="mi">12345</span><span class="p">,</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">],</span>
        <span class="s1">'aria-label'</span> <span class="o">=&gt;</span> <span class="s1">'View useful information pertaining to item '</span> <span class="mf">.</span> <span class="s1">'12345'</span><span class="p">,</span>
        <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="abcdef"&gt;'</span><span class="p">,</span>
        <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
        <span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'modal'</span><span class="p">,</span>
        <span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">(</span>
          <span class="p">[</span>
            <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'auto'</span><span class="p">,</span>
          <span class="p">]</span>
        <span class="p">),</span>
      <span class="p">],</span>
    <span class="p">];</span>

    <span class="nv">$build</span><span class="p">[</span><span class="s1">'link-to-modal2'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
      <span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nc">Url</span><span class="p">(</span><span class="s1">'modal_examples.modal2'</span><span class="p">),</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="s1">'Link to a node in a dialog (modal2)'</span><span class="p">,</span>
      <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="pqrst"&gt;'</span><span class="p">,</span>
      <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">],</span>
      <span class="p">],</span>
    <span class="p">];</span>

    <span class="nv">$build</span><span class="p">[</span><span class="s1">'#attached'</span><span class="p">][</span><span class="s1">'library'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'core/drupal.dialog.ajax'</span><span class="p">;</span>

    <span class="k">return</span> <span class="nv">$build</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">buildModal1</span><span class="p">(</span><span class="kt">int</span> <span class="nv">$program_id</span><span class="p">,</span> <span class="kt">string</span> <span class="nv">$type</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$build</span><span class="p">[</span><span class="s1">'content'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'item'</span><span class="p">,</span>
      <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Some useful information!'</span><span class="p">),</span>
    <span class="p">];</span>
    <span class="nv">$build</span><span class="p">[</span><span class="s1">'other_content'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'item'</span><span class="p">,</span>
      <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Program id: @program_id. Type: @type'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'@program_id'</span> <span class="o">=&gt;</span> <span class="nv">$program_id</span><span class="p">,</span>
        <span class="s1">'@type'</span> <span class="o">=&gt;</span> <span class="nv">$type</span><span class="p">,</span>
      <span class="p">]),</span>
    <span class="p">];</span>

    <span class="k">return</span> <span class="nv">$build</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><p>The second modal is in ModalExamplesController2.php. This dialog uses the example from an example at <a href="https://www.hashbangcode.com/article/drupal-9-creating-ajax-dialogs">https://www.hashbangcode.com/article/drupal-9-creating-ajax-dialogs</a> which displays a teaser view of a node:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="cd">/**
 * @file
 *
 * Contains \Drupal\modal_examples\Controller\ModalExamplesController2.
 */</span>
<span class="kn">namespace</span> <span class="nn">Drupal\modal_examples\Controller</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\OpenDialogCommand</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Entity\EntityTypeManagerInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\DependencyInjection\ContainerInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\AjaxResponse</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\OpenModalDialogCommand</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Controller\ControllerBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormBuilder</span><span class="p">;</span>


<span class="cd">/**
 * ModalExamplesController2 class.
 */</span>
<span class="kd">class</span> <span class="nc">ModalExamplesController2</span> <span class="kd">extends</span> <span class="nc">ControllerBase</span> <span class="p">{</span>

  <span class="cd">/**
   * The form builder.
   *
   * @var \Drupal\Core\Form\FormBuilder
   */</span>
  <span class="k">protected</span> <span class="nv">$formBuilder</span><span class="p">;</span>

  <span class="cd">/**
   * The entity type manager.
   *
   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$entityTypeManager</span><span class="p">;</span>

  <span class="cd">/**
   * The ModalFormExampleController constructor.
   *
   * @param \Drupal\Core\Form\FormBuilder $formBuilder
   *   The form builder.
   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
   *   The entity type manager.
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">FormBuilder</span> <span class="nv">$formBuilder</span><span class="p">,</span> <span class="kt">EntityTypeManagerInterface</span> <span class="nv">$entity_type_manager</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">formBuilder</span> <span class="o">=</span> <span class="nv">$formBuilder</span><span class="p">;</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">entityTypeManager</span> <span class="o">=</span> <span class="nv">$entity_type_manager</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   *
   * @param \Symfony\Component\DependencyInjection\ContainerInterface $container
   *   The Drupal service container.
   *
   * @return static
   */</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">create</span><span class="p">(</span><span class="kt">ContainerInterface</span> <span class="nv">$container</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nc">static</span><span class="p">(</span>
      <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'form_builder'</span><span class="p">),</span>
      <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'entity_type.manager'</span><span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>


  <span class="cm">/*
   * Phil's open a dialog to display a node teaser.
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">createDialogFromNode</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Load a specific node.</span>
    <span class="nv">$node</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">entityTypeManager</span><span class="o">-&gt;</span><span class="nf">getStorage</span><span class="p">(</span><span class="s1">'node'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">load</span><span class="p">(</span><span class="mi">34</span><span class="p">);</span>

    <span class="c1">// Convert node into a render array.</span>
    <span class="nv">$viewBuilder</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">entityTypeManager</span><span class="o">-&gt;</span><span class="nf">getViewBuilder</span><span class="p">(</span><span class="s1">'node'</span><span class="p">);</span>
    <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$viewBuilder</span><span class="o">-&gt;</span><span class="nf">view</span><span class="p">(</span><span class="nv">$node</span><span class="p">,</span> <span class="s1">'teaser'</span><span class="p">);</span>

    <span class="c1">// Get the title of the node.</span>
    <span class="nv">$title</span> <span class="o">=</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="nf">getTitle</span><span class="p">();</span>

    <span class="c1">// Create the AjaxResponse object.</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AjaxResponse</span><span class="p">();</span>

    <span class="c1">// Attach the library needed to use the OpenDialogCommand response.</span>
    <span class="nv">$attachments</span><span class="p">[</span><span class="s1">'library'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'core/drupal.dialog.ajax'</span><span class="p">;</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">setAttachments</span><span class="p">(</span><span class="nv">$attachments</span><span class="p">);</span>

    <span class="c1">// Add the open dialog command to the ajax response.</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">addCommand</span><span class="p">(</span><span class="k">new</span> <span class="nc">OpenDialogCommand</span><span class="p">(</span><span class="s1">'#my-dialog-selector'</span><span class="p">,</span> <span class="nv">$title</span><span class="p">,</span> <span class="nv">$content</span><span class="p">,</span> <span class="p">[</span><span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'70%'</span><span class="p">]));</span>
    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><p>Here is the first modal dialog as it appears on the site when the modal1 link is clicked:</p><p><img alt="First dialog" src="https://selwynpolit.github.io/d9book/assets/images/first-dialog.png"/></p><p>And the second</p><p><img alt="Second dialog" src="https://selwynpolit.github.io/d9book/assets/images/second-dialog.png"/></p><h3 id="passing-entities-as-parameters"> <a aria-labelledby="passing-entities-as-parameters" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#passing-entities-as-parameters"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Passing entities as parameters</h3><p>Sometimes it is useful to pass a node as a parameter so you can quickly grab fields from it. To do this, specify type: entity: node (or other type of entity) in the *.routing.yml file. See the example below where parameters: program and correlation are identified as nodes. In your code, you pass the node id (not the entire node) and Drupal will automatically load the node for you and pass it to the controller:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">taa.view_votes</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/srp/program/{program}/vote-view/correlation/{correlation}/{type}'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\taa\Controller\ViewVotesController::content'</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Votes</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">Citation'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">view</span><span class="nv"> </span><span class="s">any</span><span class="nv"> </span><span class="s">saa</span><span class="nv"> </span><span class="s">item+view</span><span class="nv"> </span><span class="s">own</span><span class="nv"> </span><span class="s">saa</span><span class="nv"> </span><span class="s">item'</span>
  <span class="na">options</span><span class="pi">:</span>
    <span class="na">parameters</span><span class="pi">:</span>
      <span class="na">program</span><span class="pi">:</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">entity:node</span>
      <span class="na">correlation</span><span class="pi">:</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">entity:node</span>
    <span class="na">no_cache</span><span class="pi">:</span> <span class="s1">'</span><span class="s">TRUE'</span>
</code></pre></div></div><p>The controller will look like this. Notice how we can call entity functions on the $program and $correlation entities.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">function</span> <span class="n">content</span><span class="p">(</span><span class="kt">EntityInterface</span> <span class="nv">$program</span><span class="p">,</span> <span class="kt">EntityInterface</span> <span class="nv">$correlation</span><span class="p">,</span> <span class="kt">string</span> <span class="nv">$type</span> <span class="o">=</span> <span class="s1">'all'</span><span class="p">):</span> <span class="kt">array</span> <span class="p">{</span>
  <span class="nv">$program_nid</span> <span class="o">=</span> <span class="nv">$program</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">();</span>
  <span class="nv">$correlation_nid</span> <span class="o">=</span> <span class="nv">$correlation</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">();</span>
  <span class="nv">$vote_number</span> <span class="o">=</span> <span class="nv">$program</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'field_srp_vote_number'</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
</code></pre></div></div><h2 id="modal-form-example"> <a aria-labelledby="modal-form-example" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#modal-form-example"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Modal form example</h2><p>This example displays a form with a button. When a user presses the button, a dialog containing another form appears.</p><p>This code is a little convoluted as the link you click to open the modal form calls a controller function, <code class="language-plaintext highlighter-rouge">ModalExamplesController2::openModalForm()</code>, which loads the form and opens it with an ajax command, <code class="language-plaintext highlighter-rouge">OpenModalDialogCommand</code>. You can directly point a link to a form route (as you can find in other examples below.)</p><p>Also notice that controller uses dependency injection to load the form builder (which <em>is</em> the recommended way to do things.).</p><p>In web/modules/custom/modal_examples/modal_examples.routing.yml we first set up a route for the form which will be initially displayed. This is identified as <code class="language-plaintext highlighter-rouge">modal_examples.form1.</code></p><p>Secondly, we set up a route for the popup form, <code class="language-plaintext highlighter-rouge">modal_examples.modal_form.</code></p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">modal_examples.form1</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/form1'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_form</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Drupal\modal_examples\Form\ExampleForm'</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Form</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">button</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">popup</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">modal</span><span class="nv"> </span><span class="s">form'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">administer</span><span class="nv"> </span><span class="s">site</span><span class="nv"> </span><span class="s">configuration'</span>

<span class="na">modal_examples.modal_form</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/modal_form'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">The</span><span class="nv"> </span><span class="s">Modal</span><span class="nv"> </span><span class="s">Form'</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\modal_examples\Controller\ModalExamplesController2::openModalForm'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">administer</span><span class="nv"> </span><span class="s">site</span><span class="nv"> </span><span class="s">configuration'</span>
  <span class="na">options</span><span class="pi">:</span>
    <span class="na">_admin_route</span><span class="pi">:</span> <span class="s">TRUE</span>
</code></pre></div></div><p>When we navigate to <code class="language-plaintext highlighter-rouge">/modal-example/form</code>, we see the following form. If we click the button labelled, "Click to see the Modal Form", a modal dialog will appear with a form in it.</p><p>Here is the initial form:</p><p><img alt="Initial form" src="https://selwynpolit.github.io/d9book/assets/images/initial-form.png"/></p><p>And here is the modal popped up over it:</p><p><img alt="Modal over initial form" src="https://selwynpolit.github.io/d9book/assets/images/modal-over-initial-form.png"/></p><p>Here is the code for the first form in <code class="language-plaintext highlighter-rouge">web/modules/custom/modal_examples/src/Form/ExampleForm.php</code>. Notice the link at <code class="language-plaintext highlighter-rouge">$form['actions']['open_modal']</code> which is used to invoke the modal form. Note. It is essential that you specify the use-ajax class for this link.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">Drupal\modal_examples\Form</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormStateInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Url</span><span class="p">;</span>

<span class="cd">/**
 * ExampleForm class.
 */</span>
<span class="kd">class</span> <span class="nc">ExampleForm</span> <span class="kd">extends</span> <span class="nc">FormBase</span> <span class="p">{</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">buildForm</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">,</span> <span class="nv">$options</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'#prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'&lt;div id="example_form"&gt;'</span><span class="p">;</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'#suffix'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'info'</span><span class="p">][</span><span class="s1">'instructions'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'markup'</span><span class="p">,</span>
      <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Please fill out the form below and click the button for more info.'</span><span class="p">),</span>
    <span class="p">];</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'info'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'textfield'</span><span class="p">,</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">),</span>
      <span class="s1">'#size'</span> <span class="o">=&gt;</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s1">'#default_value'</span> <span class="o">=&gt;</span> <span class="s1">'Mary Vasquez'</span><span class="p">,</span>
      <span class="s1">'#required'</span> <span class="o">=&gt;</span> <span class="kc">FALSE</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">][</span><span class="s1">'open_modal'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Click to see the Modal Form'</span><span class="p">),</span>
      <span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'modal_examples.modal_form'</span><span class="p">),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span>
          <span class="s1">'use-ajax'</span><span class="p">,</span>
          <span class="s1">'button'</span><span class="p">,</span>
        <span class="p">],</span>
      <span class="p">],</span>
    <span class="p">];</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">][</span><span class="s1">'submit'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'submit'</span><span class="p">,</span>
      <span class="s1">'#value'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Submit'</span><span class="p">),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="p">],</span>
    <span class="p">];</span>

    <span class="k">return</span> <span class="nv">$form</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">submitForm</span><span class="p">(</span><span class="kt">array</span> <span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// @TODO.</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">getFormId</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'modal_examples_example_form'</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><p>Here is the controller that is used to load the modal form at <code class="language-plaintext highlighter-rouge">web/modules/custom/modal_examples/src/Controller/ModalExamplesController2.php</code></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="cd">/**
 * @file
 *
 * Contains \Drupal\modal_examples\Controller\ModalExamplesController2.
 */</span>
<span class="kn">namespace</span> <span class="nn">Drupal\modal_examples\Controller</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Symfony\Component\DependencyInjection\ContainerInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\AjaxResponse</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\OpenModalDialogCommand</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Controller\ControllerBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormBuilder</span><span class="p">;</span>

<span class="cd">/**
 * ModalExamplesController2 class.
 */</span>
<span class="kd">class</span> <span class="nc">ModalExamplesController2</span> <span class="kd">extends</span> <span class="nc">ControllerBase</span> <span class="p">{</span>

  <span class="cd">/**
   * The form builder.
   *
   * @var \Drupal\Core\Form\FormBuilder
   */</span>
  <span class="k">protected</span> <span class="nv">$formBuilder</span><span class="p">;</span>

  <span class="cd">/**
   * The ModalFormExampleController constructor.
   *
   * @param \Drupal\Core\Form\FormBuilder $formBuilder
   *   The form builder.
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">FormBuilder</span> <span class="nv">$formBuilder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">formBuilder</span> <span class="o">=</span> <span class="nv">$formBuilder</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   *
   * @param \Symfony\Component\DependencyInjection\ContainerInterface $container
   *   The Drupal service container.
   *
   * @return static
   */</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">create</span><span class="p">(</span><span class="kt">ContainerInterface</span> <span class="nv">$container</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nc">static</span><span class="p">(</span>
      <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'form_builder'</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="cd">/**
   * Callback for opening the modal form.
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">openModalForm</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AjaxResponse</span><span class="p">();</span>

    <span class="c1">// Get the modal form using the form builder.</span>
    <span class="nv">$modal_form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">formBuilder</span><span class="o">-&gt;</span><span class="nf">getForm</span><span class="p">(</span><span class="s1">'Drupal\modal_examples\Form\ExampleModalForm'</span><span class="p">);</span>

    <span class="c1">// Add an AJAX command to open a modal dialog with the form as the content.</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">addCommand</span><span class="p">(</span><span class="k">new</span> <span class="nc">OpenModalDialogCommand</span><span class="p">(</span><span class="s1">'My Modal Form'</span><span class="p">,</span> <span class="nv">$modal_form</span><span class="p">,</span> <span class="p">[</span><span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'800'</span><span class="p">]));</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><p>And finally, here is the "modal" form itself at <code class="language-plaintext highlighter-rouge">web/modules/custom/modal_examples/src/Form/ExampleModalForm.php</code></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">Drupal\modal_examples\Form</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\CloseModalDialogCommand</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormStateInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\AjaxResponse</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\OpenModalDialogCommand</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\ReplaceCommand</span><span class="p">;</span>

<span class="cd">/**
 * ModalForm class.
 */</span>
<span class="kd">class</span> <span class="nc">ExampleModalForm</span> <span class="kd">extends</span> <span class="nc">FormBase</span> <span class="p">{</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">getFormId</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'modal_form_example_modal_form'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">buildForm</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">,</span> <span class="nv">$options</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'#prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'&lt;div id="modal_example_form"&gt;'</span><span class="p">;</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'#suffix'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span>

    <span class="c1">// The status messages that will contain any form errors.</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'status_messages'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'status_messages'</span><span class="p">,</span>
      <span class="s1">'#weight'</span> <span class="o">=&gt;</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="c1">// A required checkbox field.</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'our_checkbox'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'checkbox'</span><span class="p">,</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'I Agree: modal forms are awesome!'</span><span class="p">),</span>
      <span class="s1">'#default_value'</span> <span class="o">=&gt;</span> <span class="kc">TRUE</span><span class="p">,</span>
      <span class="s1">'#required'</span> <span class="o">=&gt;</span> <span class="kc">TRUE</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'textfield'</span><span class="p">,</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">),</span>
      <span class="s1">'#size'</span> <span class="o">=&gt;</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s1">'#default_value'</span> <span class="o">=&gt;</span> <span class="s1">'Jane Martinez'</span><span class="p">,</span>
      <span class="s1">'#required'</span> <span class="o">=&gt;</span> <span class="kc">FALSE</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'email'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'email'</span><span class="p">,</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Email'</span><span class="p">),</span>
      <span class="s1">'#size'</span> <span class="o">=&gt;</span> <span class="mi">30</span><span class="p">,</span>
      <span class="s1">'#default_value'</span> <span class="o">=&gt;</span> <span class="s1">'Jane@example.com'</span><span class="p">,</span>
      <span class="s1">'#required'</span> <span class="o">=&gt;</span> <span class="kc">FALSE</span><span class="p">,</span>
    <span class="p">];</span>


    <span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'actions'</span><span class="p">);</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">][</span><span class="s1">'send'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'submit'</span><span class="p">,</span>
      <span class="s1">'#value'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Submit'</span><span class="p">),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span>
          <span class="s1">'use-ajax'</span><span class="p">,</span>
        <span class="p">],</span>
      <span class="p">],</span>
      <span class="s1">'#ajax'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'callback'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">'submitModalFormAjax'</span><span class="p">],</span>
        <span class="s1">'event'</span> <span class="o">=&gt;</span> <span class="s1">'click'</span><span class="p">,</span>
      <span class="p">],</span>
    <span class="p">];</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">][</span><span class="s1">'cancel'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'submit'</span><span class="p">,</span>
      <span class="s1">'#value'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'cancel'</span><span class="p">),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span>
          <span class="s1">'use-ajax'</span><span class="p">,</span>
        <span class="p">],</span>
      <span class="p">],</span>
      <span class="s1">'#ajax'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'callback'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">'closeModalForm'</span><span class="p">],</span>
        <span class="s1">'event'</span> <span class="o">=&gt;</span> <span class="s1">'click'</span><span class="p">,</span>
      <span class="p">],</span>
    <span class="p">];</span>

    <span class="nv">$form</span><span class="p">[</span><span class="s1">'#attached'</span><span class="p">][</span><span class="s1">'library'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'core/drupal.dialog.ajax'</span><span class="p">;</span>

    <span class="k">return</span> <span class="nv">$form</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * AJAX callback handler that displays any errors or a success message.
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">submitModalFormAjax</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AjaxResponse</span><span class="p">();</span>

    <span class="c1">// If there are any form errors, re-display the form.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">hasAnyErrors</span><span class="p">())</span> <span class="p">{</span>
      <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">addCommand</span><span class="p">(</span><span class="k">new</span> <span class="nc">ReplaceCommand</span><span class="p">(</span><span class="s1">'#modal_example_form'</span><span class="p">,</span> <span class="nv">$form</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="c1">//Close the modal.</span>
      <span class="nv">$command</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CloseModalDialogCommand</span><span class="p">();</span>
      <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">addCommand</span><span class="p">(</span><span class="nv">$command</span><span class="p">);</span>

      <span class="c1">// Pop up a new modal with a title success etc.</span>
      <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">addCommand</span><span class="p">(</span><span class="k">new</span> <span class="nc">OpenModalDialogCommand</span><span class="p">(</span><span class="s2">"Success!"</span><span class="p">,</span> <span class="s1">'The modal form has been submitted.'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="mi">800</span><span class="p">]));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="cd">/**
   * @return \Drupal\Core\Ajax\AjaxResponse
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">closeModalForm</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$command</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CloseModalDialogCommand</span><span class="p">();</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AjaxResponse</span><span class="p">();</span>

    <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">addCommand</span><span class="p">(</span><span class="nv">$command</span><span class="p">);</span>
    <span class="c1">// $response-&gt;addCommand(new OpenModalDialogCommand("Cancel!", 'Why did you cancel me?', ['width' =&gt; 400]));</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">validateForm</span><span class="p">(</span><span class="kt">array</span> <span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// @TODO.</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">submitForm</span><span class="p">(</span><span class="kt">array</span> <span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// @TODO.</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><h2 id="slide-in-dialogoff-canvas-dialog"> <a aria-labelledby="slide-in-dialogoff-canvas-dialog" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#slide-in-dialogoff-canvas-dialog"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Slide-in dialog/Off-canvas dialog</h2><p>Slide in dialogs are modals that appear to slide-in from the right side or top of the screen. Like any modal dialogs they can contain forms</p><h2 id="slide-in-dialog-example"> <a aria-labelledby="slide-in-dialog-example" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#slide-in-dialog-example"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Slide-in Dialog Example</h2><p>This example shows 4 different types of links which fire off variations of slide-in dialogs. Check out the links below:</p><p><img alt="Slide-in example" src="https://selwynpolit.github.io/d9book/assets/images/slide-in-example.png"/></p><p>In <code class="language-plaintext highlighter-rouge">web/modules/custom/modal_examples/modal_examples.routing.yml</code> we specify the routes for our controller, <code class="language-plaintext highlighter-rouge">example2</code> as well as <code class="language-plaintext highlighter-rouge">modal1</code>, <code class="language-plaintext highlighter-rouge">form2</code> and <code class="language-plaintext highlighter-rouge">login_form</code>:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Controller with buttons to open modals</span>
<span class="na">modal_examples.example2</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/example2'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Modal</span><span class="nv"> </span><span class="s">Examples</span><span class="nv"> </span><span class="s">(example2)'</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\modal_examples\Controller\ModalExamplesController2::buildExample2'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">access</span><span class="nv"> </span><span class="s">content'</span>

<span class="c1"># modal1</span>
<span class="na">modal_examples.modal1</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/modal1/{program_id}/{type}'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Modal</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">parameters'</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\modal_examples\Controller\ModalExamplesController::buildModal1'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">access</span><span class="nv"> </span><span class="s">content'</span>
  <span class="na">options</span><span class="pi">:</span>
    <span class="na">parameters</span><span class="pi">:</span>
      <span class="na">program_id</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span>
    <span class="na">no_cache</span><span class="pi">:</span> <span class="s1">'</span><span class="s">TRUE'</span>


<span class="c1"># Simple form for slide-in modals</span>
<span class="na">modal_examples.form2</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/form2'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_form</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Drupal\modal_examples\Form\ExampleForm2'</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Simple</span><span class="nv"> </span><span class="s">example</span><span class="nv"> </span><span class="s">form</span><span class="nv"> </span><span class="s">(form2)'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">access</span><span class="nv"> </span><span class="s">content'</span>

<span class="c1"># Form with buttons to open modals</span>
<span class="na">modal_examples.login_form</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/modal-examples/login-form'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Simple</span><span class="nv"> </span><span class="s">example</span><span class="nv"> </span><span class="s">form</span><span class="nv"> </span><span class="s">(form2)'</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Drupal\modal_examples\Controller\ModalExamplesController2::buildLoginForm'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">access</span><span class="nv"> </span><span class="s">content'</span>
</code></pre></div></div><p>Here is the controller for example2, <code class="language-plaintext highlighter-rouge">web/modules/custom/modal_examples/src/Controller/ModalExamplesController2.php</code>. You will find the functions <code class="language-plaintext highlighter-rouge">buildExample2()</code> which creates the 4 links and <code class="language-plaintext highlighter-rouge">buildLoginForm()</code> which uses Drupal’s formbuilder to build the login form.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="cd">/**
 * @file
 *
 * Contains \Drupal\modal_examples\Controller\ModalExamplesController2.
 */</span>
<span class="kn">namespace</span> <span class="nn">Drupal\modal_examples\Controller</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Drupal\Component\Serialization\Json</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\OpenDialogCommand</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Entity\EntityTypeManagerInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Url</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Symfony\Component\DependencyInjection\ContainerInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\AjaxResponse</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Ajax\OpenModalDialogCommand</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Controller\ControllerBase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Form\FormBuilder</span><span class="p">;</span>


<span class="cd">/**
 * ModalExamplesController2 class.
 */</span>
<span class="kd">class</span> <span class="nc">ModalExamplesController2</span> <span class="kd">extends</span> <span class="nc">ControllerBase</span> <span class="p">{</span>

  <span class="cd">/**
   * The form builder.
   *
   * @var \Drupal\Core\Form\FormBuilder
   */</span>
  <span class="k">protected</span> <span class="nv">$formBuilder</span><span class="p">;</span>

  <span class="cd">/**
   * The entity type manager.
   *
   * @var \Drupal\Core\Entity\EntityTypeManagerInterface
   */</span>
  <span class="k">protected</span> <span class="nv">$entityTypeManager</span><span class="p">;</span>

  <span class="cd">/**
   * The ModalFormExampleController constructor.
   *
   * @param \Drupal\Core\Form\FormBuilder $formBuilder
   *   The form builder.
   * @param \Drupal\Core\Entity\EntityTypeManagerInterface $entity_type_manager
   *   The entity type manager.
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">FormBuilder</span> <span class="nv">$formBuilder</span><span class="p">,</span> <span class="kt">EntityTypeManagerInterface</span> <span class="nv">$entity_type_manager</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">formBuilder</span> <span class="o">=</span> <span class="nv">$formBuilder</span><span class="p">;</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">entityTypeManager</span> <span class="o">=</span> <span class="nv">$entity_type_manager</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cd">/**
   * {@inheritdoc}
   *
   * @param \Symfony\Component\DependencyInjection\ContainerInterface $container
   *   The Drupal service container.
   *
   * @return static
   */</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">create</span><span class="p">(</span><span class="kt">ContainerInterface</span> <span class="nv">$container</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nc">static</span><span class="p">(</span>
      <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'form_builder'</span><span class="p">),</span>
      <span class="nv">$container</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'entity_type.manager'</span><span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>


  <span class="k">public</span> <span class="k">function</span> <span class="n">buildExample2</span><span class="p">()</span> <span class="p">{</span>

    <span class="nv">$route_name</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">routeMatch</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getRouteName</span><span class="p">();</span>
    <span class="nv">$build</span><span class="p">[</span><span class="s1">'content'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'item'</span><span class="p">,</span>
      <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Route: %route'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'%route'</span> <span class="o">=&gt;</span> <span class="nv">$route_name</span><span class="p">]),</span>
    <span class="p">];</span>

    <span class="nv">$build</span><span class="p">[</span><span class="s1">'link-to-modal1'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
      <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="pqrst"&gt;'</span><span class="p">,</span>
      <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nf">t</span><span class="p">(</span><span class="s1">'Link to off canvas/slide-in custom modal dialog (modal1)'</span><span class="p">),</span>
      <span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'modal_examples.modal1'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'program_id'</span>     <span class="o">=&gt;</span> <span class="mi">123</span><span class="p">,</span>
        <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'all'</span><span class="p">,</span>
      <span class="p">]),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'view-correlation-'</span> <span class="mf">.</span> <span class="mi">12345</span><span class="p">,</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">],</span>
        <span class="s1">'aria-label'</span> <span class="o">=&gt;</span> <span class="s1">'View useful information pertaining to item '</span> <span class="mf">.</span> <span class="s1">'12345'</span><span class="p">,</span>
        <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="abcdef"&gt;'</span><span class="p">,</span>
        <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
        <span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'dialog.off_canvas'</span><span class="p">,</span>
        <span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">(</span>
          <span class="p">[</span>
            <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'auto'</span><span class="p">,</span>
          <span class="p">]</span>
        <span class="p">),</span>
      <span class="p">],</span>
    <span class="p">];</span>

    <span class="nv">$build</span><span class="p">[</span><span class="s1">'link-to-modal1-top'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
      <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="pqrst"&gt;'</span><span class="p">,</span>
      <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
      <span class="s1">'#title'</span> <span class="o">=&gt;</span> <span class="nf">t</span><span class="p">(</span><span class="s1">'Link to off canvas/slide-in custom modal dialog (modal1) from top'</span><span class="p">),</span>
      <span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'modal_examples.modal1'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'program_id'</span>     <span class="o">=&gt;</span> <span class="mi">123</span><span class="p">,</span>
        <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'all'</span><span class="p">,</span>
      <span class="p">]),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'view-correlation-'</span> <span class="mf">.</span> <span class="mi">12345</span><span class="p">,</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">],</span>
        <span class="s1">'aria-label'</span> <span class="o">=&gt;</span> <span class="s1">'View useful information pertaining to item '</span> <span class="mf">.</span> <span class="s1">'12345'</span><span class="p">,</span>
        <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="abcdef"&gt;'</span><span class="p">,</span>
        <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
        <span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'dialog.off_canvas_top'</span><span class="p">,</span>
        <span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">(</span>
          <span class="p">[</span>
            <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'auto'</span><span class="p">,</span>
          <span class="p">]</span>
        <span class="p">),</span>
      <span class="p">],</span>
    <span class="p">];</span>


    <span class="nv">$build</span><span class="p">[</span><span class="s1">'link-to-example2-form'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
      <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="pqrst"&gt;'</span><span class="p">,</span>
      <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
      <span class="s1">'#title'</span><span class="o">=&gt;</span> <span class="nf">t</span><span class="p">(</span><span class="s1">'Link to off canvas/slide-in form (form2) '</span><span class="p">),</span>
      <span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'modal_examples.form2'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'program_id'</span>     <span class="o">=&gt;</span> <span class="mi">123</span><span class="p">,</span>
        <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'all'</span><span class="p">,</span>
      <span class="p">]),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'important-id-'</span> <span class="mf">.</span> <span class="mi">12345</span><span class="p">,</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">],</span>
        <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="abcdef"&gt;'</span><span class="p">,</span>
        <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
        <span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'dialog.off_canvas'</span><span class="p">,</span>
        <span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">(</span>
          <span class="p">[</span>
            <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'auto'</span><span class="p">,</span>
          <span class="p">]</span>
        <span class="p">),</span>
      <span class="p">],</span>
    <span class="p">];</span>

    <span class="nv">$build</span><span class="p">[</span><span class="s1">'link-to-example-login-form'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
      <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="pqrst"&gt;'</span><span class="p">,</span>
      <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
      <span class="s1">'#title'</span><span class="o">=&gt;</span> <span class="nf">t</span><span class="p">(</span><span class="s1">'Link to off canvas/slide-in login form (login_form) '</span><span class="p">),</span>
      <span class="s1">'#url'</span> <span class="o">=&gt;</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'modal_examples.login_form'</span><span class="p">),</span>
      <span class="s1">'#attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'important-id-'</span> <span class="mf">.</span> <span class="mi">12345</span><span class="p">,</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">],</span>
        <span class="s1">'#prefix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div class="abcdef"&gt;'</span><span class="p">,</span>
        <span class="s1">'#suffix'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
        <span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'dialog.off_canvas'</span><span class="p">,</span>
        <span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">(</span>
          <span class="p">[</span>
            <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'auto'</span><span class="p">,</span>
          <span class="p">]</span>
        <span class="p">),</span>
      <span class="p">],</span>
    <span class="p">];</span>


    <span class="nv">$build</span><span class="p">[</span><span class="s1">'#attached'</span><span class="p">][</span><span class="s1">'library'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'core/drupal.dialog.ajax'</span><span class="p">;</span>
    <span class="nv">$build</span><span class="p">[</span><span class="s1">'#attached'</span><span class="p">][</span><span class="s1">'library'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'core/drupal.dialog.off_canvas'</span><span class="p">;</span>

    <span class="k">return</span> <span class="nv">$build</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">buildLoginForm</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//$form = \Drupal::formBuilder()-&gt;getForm(\Drupal\user\Form\UserLoginForm::class);</span>
    <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">formBuilder</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getForm</span><span class="p">(</span><span class="nc">\Drupal\user\Form\UserLoginForm</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$form</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><p><code class="language-plaintext highlighter-rouge">BuildModal1()</code> is in ModalExamplesController.php (above):</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">function</span> <span class="n">buildModal1</span><span class="p">(</span><span class="kt">int</span> <span class="nv">$program_id</span><span class="p">,</span> <span class="kt">string</span> <span class="nv">$type</span><span class="p">)</span> <span class="p">{</span>

  <span class="nv">$build</span><span class="p">[</span><span class="s1">'content'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'item'</span><span class="p">,</span>
    <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Some useful information!'</span><span class="p">),</span>
  <span class="p">];</span>
  <span class="nv">$build</span><span class="p">[</span><span class="s1">'other_content'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'item'</span><span class="p">,</span>
    <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Program id: @program_id. Type: @type'</span><span class="p">,</span> <span class="p">[</span>
      <span class="s1">'@program_id'</span> <span class="o">=&gt;</span> <span class="nv">$program_id</span><span class="p">,</span>
      <span class="s1">'@type'</span> <span class="o">=&gt;</span> <span class="nv">$type</span><span class="p">,</span>
    <span class="p">]),</span>
  <span class="p">];</span>

  <span class="k">return</span> <span class="nv">$build</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>This is what to expect when you click the first link:</p><p><img alt="First slide-in modal" src="https://selwynpolit.github.io/d9book/assets/images/first-modal.png"/></p><p>And the second which shows the dialog sliding in from the top:</p><p><img alt="Second slide-in modal" src="https://selwynpolit.github.io/d9book/assets/images/second-modal.png"/></p><p>Here is our custom form sliding in:</p><p><img alt="Third slide-in modal" src="https://selwynpolit.github.io/d9book/assets/images/third-modal.png"/></p><p>And finally the login form sliding in:</p><p><img alt="Fourth slide-in modal" src="https://selwynpolit.github.io/d9book/assets/images/fourth-modal.png"/></p><h2 id="block-with-a-link-to-popup-a-custom-modal-dialog"> <a aria-labelledby="block-with-a-link-to-popup-a-custom-modal-dialog" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#block-with-a-link-to-popup-a-custom-modal-dialog"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Block with a link to popup a custom modal dialog</h2><p>This is an example from <a href="http://befused.com/drupal/modal-module">http://befused.com/drupal/modal-module</a></p><p>In the module custom_modal, there is a custom_modal.routing.yml which specifies the route and controller.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">custom_modal.modal</span><span class="pi">:</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">modal-example/modal'</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="na">_title</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Modal'</span>
    <span class="na">_controller</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\Drupal\custom_modal\Controller\CustomModalController::modal'</span>
  <span class="na">requirements</span><span class="pi">:</span>
    <span class="na">_permission</span><span class="pi">:</span> <span class="s1">'</span><span class="s">access</span><span class="nv"> </span><span class="s">content'</span>
</code></pre></div></div><p>Here we define a block in <code class="language-plaintext highlighter-rouge">ModalBlock.php</code> that will present a button, which when clicked, will bring up a modal dialog. Note in the <code class="language-plaintext highlighter-rouge">build()</code> method that we get the route using <code class="language-plaintext highlighter-rouge">Url::fromRoute('custom_modal.modal')</code>.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cd">/**
 * Provides a 'Modal' Block
 *
 * @Block(
 *   id = "modal_block",
 *   admin_label = @Translation("Modal block"),
 * )
 */</span>
<span class="kd">class</span> <span class="nc">ModalBlock</span> <span class="kd">extends</span> <span class="nc">BlockBase</span> <span class="p">{</span>
  <span class="cd">/**
   * {@inheritdoc}
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">build</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$link_url</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'custom_modal.modal'</span><span class="p">);</span>
    <span class="nv">$link_url</span><span class="o">-&gt;</span><span class="nf">setOptions</span><span class="p">([</span>
      <span class="s1">'attributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'use-ajax'</span><span class="p">,</span> <span class="s1">'button'</span><span class="p">,</span> <span class="s1">'button--small'</span><span class="p">],</span>
        <span class="s1">'data-dialog-type'</span> <span class="o">=&gt;</span> <span class="s1">'modal'</span><span class="p">,</span>
        <span class="s1">'data-dialog-options'</span> <span class="o">=&gt;</span> <span class="nc">Json</span><span class="o">::</span><span class="nf">encode</span><span class="p">([</span><span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="mi">400</span><span class="p">]),</span>
      <span class="p">]</span>
    <span class="p">]);</span>

    <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">'#type'</span> <span class="o">=&gt;</span> <span class="s1">'markup'</span><span class="p">,</span>
      <span class="s1">'#markup'</span> <span class="o">=&gt;</span> <span class="nc">Link</span><span class="o">::</span><span class="nf">fromTextAndUrl</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Open modal'</span><span class="p">),</span> <span class="nv">$link_url</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">toString</span><span class="p">(),</span>
      <span class="s1">'#attached'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'library'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'core/drupal.dialog.ajax'</span><span class="p">]]</span>
    <span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><p>Then in the controller, <code class="language-plaintext highlighter-rouge">CustomModalController.php</code> the <code class="language-plaintext highlighter-rouge">modal()</code> function builds the dialog using a new <code class="language-plaintext highlighter-rouge">AjaxResponse()</code> object.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">CustomModalController</span> <span class="kd">extends</span> <span class="nc">ControllerBase</span> <span class="p">{</span>

  <span class="k">public</span> <span class="k">function</span> <span class="n">modal</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$options</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'dialogClass'</span> <span class="o">=&gt;</span> <span class="s1">'popup-dialog-class'</span><span class="p">,</span>
      <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="s1">'50%'</span><span class="p">,</span>
    <span class="p">];</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AjaxResponse</span><span class="p">();</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">addCommand</span><span class="p">(</span><span class="k">new</span> <span class="nc">OpenModalDialogCommand</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="s1">'Modal title'</span><span class="p">),</span> <span class="nf">t</span><span class="p">(</span><span class="s1">'The modal text'</span><span class="p">),</span> <span class="nv">$options</span><span class="p">));</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div><p>To see this work, place the “modal block” in a region via the u/i, then view a page. When you click the button, a modal dialog will pop up showing “the modal text.”</p><h2 id="no-code-modal-dialogs"> <a aria-labelledby="no-code-modal-dialogs" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#no-code-modal-dialogs"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> No-code modal dialogs</h2><p>Modal dialogs are incredibly useful on websites as they allow the user to do something without having to leave the web page they are on. Drupal has a Dialog API in core, which greatly reduces the amount of code you need to write to create a modal dialog. Dialogs in Drupal 8 leverage jQuery UI. This is from an article at <a href="http://befused.com/drupal/modal">http://befused.com/drupal/modal</a> .</p><p>This capability puts some awesome power in the hands of site builders.</p><p>In a custom block with full HTML enabled use the following HTML.</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;&lt;a</span> <span class="na">class=</span><span class="s">"use-ajax"</span> <span class="na">data-dialog-type=</span><span class="s">"modal"</span> <span class="na">href=</span><span class="s">"/search/node"</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>
</code></pre></div></div><p>Or to make this dialog a little wider. E.g. 800 pixels.</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;&lt;a</span> <span class="na">class=</span><span class="s">"use-ajax"</span> <span class="na">data-dialog-options=</span><span class="s">"{&amp;quot;width&amp;quot;:800}"</span> <span class="na">data-dialog-type=</span><span class="s">"modal"</span> <span class="na">href=</span><span class="s">"/search/node"</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>
</code></pre></div></div><p>And to show a node instead of the search dialog (any valid drupal path will do here)</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;&lt;a</span> <span class="na">class=</span><span class="s">"use-ajax"</span> <span class="na">data-dialog-options=</span><span class="s">"{&amp;quot;width&amp;quot;:800}"</span> <span class="na">data-dialog-type=</span><span class="s">"modal"</span> <span class="na">href=</span><span class="s">"/node/2"</span><span class="nt">&gt;</span>See node 2<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>
</code></pre></div></div><h2 id="resources"> <a aria-labelledby="resources" class="anchor-heading" href="https://selwynpolit.github.io/d9book/modals#resources"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Resources</h2><ul><li><a href="https://www.mediacurrent.com/blog/loading-and-rendering-modal-forms-drupal-8/">Excellent tutorial on using modal forms in Drupal from March 2014</a><li><a href="https://www.hashbangcode.com/article/drupal-9-creating-ajax-dialogs">Phil Norton's great article on Creating AJAX dialogs from October 2022 at</a><li><a href="http://befused.com/drupal/modal-module">Article about creating a modal dialog in a custom module from Jan 2018</a></li></li></li></ul><hr/> <script async="" crossorigin="anonymous" data-category="Q&amp;A" data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyMjY2NDE4" data-emit-metadata="0" data-input-position="bottom" data-lang="en" data-mapping="title" data-reactions-enabled="1" data-repo="selwynpolit/d9book" data-repo-id="MDEwOlJlcG9zaXRvcnkzMjUxNTQ1Nzg=" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"> </script><hr/><footer><p><a href="https://selwynpolit.github.io/d9book/modals#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0"><span xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"> <a href="http://www.selwynpolit.github.io/d9book" property="dct:title" rel="cc:attributionURL">Drupal at your fingertips</a> by <a href="http://www.drupal.org/u/selwynpolit" property="cc:attributionName" rel="cc:attributionURL dct:creator">Selwyn Polit</a> is licensed under <a href="http://creativecommons.org/licenses/by/4.0/" rel="license noopener noreferrer" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height:16px!important;vertical-align:text-bottom;"/> <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height:16px!important;vertical-align:text-bottom;"/> </a></span></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0 mr-2"> Page last modified: <span class="d-inline-block">Apr 13 2023</span>.</p><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/selwynpolit/d9book/tree/gh-pages/book/modals.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
</body></link></meta></meta></meta></head></html>