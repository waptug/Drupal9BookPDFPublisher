<!DOCTYPE html>
<html lang="en-US"><head><meta charset="utf-8"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><link href="https://selwynpolit.github.io/d9book/assets/css/just-the-docs-default.css" rel="stylesheet"/> <script async="" src="https://www.googletagmanager.com/gtag/js?id=8V22RQEJ71"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '8V22RQEJ71', { 'anonymize_ip': true }); </script> <script src="https://selwynpolit.github.io/d9book/assets/js/vendor/lunr.min.js"></script> <script src="https://selwynpolit.github.io/d9book/assets/js/just-the-docs.js"></script><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://selwynpolit.github.io/d9book/assets/images/favicon.ico" rel="icon" type="image/x-icon"/><title>Redirects | Drupal Book</title><meta content="Jekyll v4.3.2" name="generator"><meta content="Redirects" property="og:title"><meta content="en_US" property="og:locale"><meta content="Drupal at your fingertips" name="description"/><meta content="Drupal at your fingertips" property="og:description"/><link href="https://selwynpolit.github.io/d9book/d9book/redirects" rel="canonical"><meta content="https://selwynpolit.github.io/d9book/d9book/redirects" property="og:url"/><meta content="Drupal Book" property="og:site_name"/><meta content="website" property="og:type"/><meta content="summary" name="twitter:card"/><meta content="Redirects" property="twitter:title"/> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Drupal at your fingertips","headline":"Redirects","url":"https://selwynpolit.github.io/d9book/d9book/redirects"}</script><body> <a class="skip-to-main" href="https://selwynpolit.github.io/d9book/redirects#main-content">Skip to main content</a> <svg class="d-none" xmlns="http://www.w3.org/2000/svg"> <symbol id="svg-link" viewbox="0 0 24 24"><title>Link</title><svg class="feather feather-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"><title>Menu</title><svg class="feather feather-menu" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><line x1="3" x2="21" y1="12" y2="12"></line><line x1="3" x2="21" y1="6" y2="6"></line><line x1="3" x2="21" y1="18" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"><title>Expand</title><svg class="feather feather-chevron-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol class="feather feather-external-link" fill="none" height="24" id="svg-external-link" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"><title>Document</title><svg class="feather feather-file" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"><title>Search</title><svg class="feather feather-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"> <circle cx="11" cy="11" r="8"></circle><line x1="21" x2="16.65" y1="21" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewbox="0 0 16 16"><title>Copy</title><svg class="bi bi-clipboard" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewbox="0 0 16 16"><title>Copied</title><svg class="bi bi-clipboard-check-fill" fill="currentColor" height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a class="site-title lh-tight" href="https://selwynpolit.github.io/d9book/"> Drupal Book </a> <a class="site-button" href="https://selwynpolit.github.io/d9book/redirects" id="menu-button"> <svg class="icon" viewbox="0 0 24 24"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" class="site-nav" id="site-nav"><ul class="nav-list"><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/">Home</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/actions">Actions</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/attribution">Attribution</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/bq">Batch and Queue</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/blocks">Blocks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/caching">Caching</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/composer">Composer</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/config">Config</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/cron">Cron</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dates">Dates and Times</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/debugging">Debugging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/development">Development</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/drush">Drush</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/email">Email</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/entities">Entities</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/forms">Forms</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/general">General</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/off-island">Getting off the Island</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/hooks">Hooks</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/learn">Learning</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/links">Links</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/logging">Logging</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/menus">Menus</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/migrate">Migrate</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/modals">Modals</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/nodes-and-fields">Nodes and Fields</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/queries">Queries</a><li class="nav-list-item active"><a class="nav-list-link active" href="https://selwynpolit.github.io/d9book/redirects">Redirects</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/render">Render Arrays</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/routes">Routes</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/security">Security</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/services">Services</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/state">State</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/taxonomy">Taxonomy</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/dtt">Tests</a><li class="nav-list-item"><a class="nav-list-link" href="https://selwynpolit.github.io/d9book/twig">Twig</a></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></ul><ul class="nav-list"><li class="nav-list-item external"> <a class="nav-list-link external" href="https://github.com/selwynpolit/d9book/fork"> Fork me on GitHub <svg aria-labelledby="svg-external-link-title" viewbox="0 0 24 24"><use xlink:href="#svg-external-link"></use></svg> </a></li></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div class="main-header" id="main-header"><div class="search"><div class="search-input-wrap"> <input aria-label="Search Drupal Book" autocomplete="off" class="search-input" id="search-input" placeholder="Search Drupal Book" tabindex="0" type="text"/> <label class="search-label" for="search-input"><svg class="search-icon" viewbox="0 0 24 24"><use xlink:href="#svg-search"></use></svg></label></div><div class="search-results" id="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a class="site-button" href="https://twitter.com/selwynpolit" rel="noopener noreferrer" target="_blank"> <img alt="Twitter logo" src="https://atuin.ru/demo/simple-icons/icons/twitter.svg" style="width: 30px; height: 30px;" title="Author in Twitter"/> </a><li class="aux-nav-list-item"> <a class="site-button" href="https://github.com/selwynpolit/d9book/tree/gh-pages" rel="noopener noreferrer" target="_blank"> <img alt="GitHub logo" src="https://atuin.ru/demo/simple-icons/icons/github.svg" style="width: 30px; height: 30px;" title="D9Book on GitHub"/> </a></li></li></ul></nav></div><div class="main-content-wrap" id="main-content-wrap"><div class="main-content" id="main-content" role="main"><h1 class="no_toc fw-500" id="redirects"> <a aria-labelledby="redirects" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirects"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirects</h1><h2 class="no_toc text-delta" id="table-of-contents"> <a aria-labelledby="table-of-contents" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#table-of-contents"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ul id="markdown-toc"><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-to-an-internal-url" id="markdown-toc-redirect-to-an-internal-url">Redirect to an internal url</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-in-a-form" id="markdown-toc-redirect-in-a-form">Redirect in a form</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-off-site-to-a-third-party-url" id="markdown-toc-redirect-off-site-to-a-third-party-url">Redirect off-site (to a third-party URL)</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-to-an-existing-route-with-an-anchor-or-fragment" id="markdown-toc-redirect-to-an-existing-route-with-an-anchor-or-fragment">Redirect to an existing route with an anchor (or fragment)</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-to-a-complex-route" id="markdown-toc-redirect-to-a-complex-route">Redirect to a complex route</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-in-a-controller" id="markdown-toc-redirect-in-a-controller">Redirect in a controller</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-user-after-login" id="markdown-toc-redirect-user-after-login">Redirect user after login</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-to-the-403-or-404-page" id="markdown-toc-redirect-to-the-403-or-404-page">Redirect to the 403 or 404 page</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-to-a-new-page-after-node-operation" id="markdown-toc-redirect-to-a-new-page-after-node-operation">Redirect to a new page after node operation</a><li><a href="https://selwynpolit.github.io/d9book/redirects#redirect-dynamically-to-wherever-you-came-from" id="markdown-toc-redirect-dynamically-to-wherever-you-came-from">Redirect dynamically to wherever you came from</a></li></li></li></li></li></li></li></li></li></li></ul><p><img alt="views" src="https://api.visitor.plantree.me/visitor-badge/pv?label=views&amp;color=informational&amp;namespace=d9book&amp;key=redirects.md"/></p><hr/><h2 id="redirect-to-an-internal-url"> <a aria-labelledby="redirect-to-an-internal-url" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-to-an-internal-url"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect to an internal url</h2><p>In a controller when we return a RedirectResponse instead of a render array, Symfony redirects to the URL specified in the RedirectResponse.</p><p>For example:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">\Symfony\Component\HttpFoundation\RedirectResponse</span><span class="p">;</span>

<span class="k">return</span> <span class="k">new</span> <span class="nc">RedirectResponse</span><span class="p">(</span><span class="s1">'node/1'</span><span class="p">);</span>

<span class="c1">// Or to redirect to the front page of the site.</span>

<span class="nv">$url</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'&lt;front&gt;'</span><span class="p">);</span>
<span class="k">return</span> <span class="k">new</span> <span class="nc">RedirectResponse</span><span class="p">(</span><span class="nv">$url</span><span class="o">-&gt;</span><span class="nf">toString</span><span class="p">());</span>
</code></pre></div></div><h2 id="redirect-in-a-form"> <a aria-labelledby="redirect-in-a-form" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-in-a-form"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect in a form</h2><p>In a form, you can redirect to a route by its name:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">setRedirect</span><span class="p">(</span><span class="s1">'entity.bike_part.canonical'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'bike_part'</span> <span class="o">=&gt;</span> <span class="nv">$entity</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">()]);</span>
</code></pre></div></div><p>Note. You can also redirect to a specific id (anchor) on the page by adding the fragment parameter</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">setRedirect</span><span class="p">(</span><span class="s1">'tea_teks_admin.timeline_detail'</span><span class="p">,</span> 
  <span class="p">[</span><span class="s1">'node'</span><span class="o">=&gt;</span><span class="nv">$parent_nid</span><span class="p">],</span> 
  <span class="p">[</span><span class="s1">'fragment'</span> <span class="o">=&gt;</span> <span class="s1">'milestone-'</span> <span class="mf">.</span> <span class="nv">$nid</span><span class="p">,]</span>
<span class="p">);</span>
</code></pre></div></div><p>Or here in submitForm():</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$url</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'user_account.user_register'</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">'query'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'destination'</span> <span class="o">=&gt;</span> <span class="nv">$shippingUrl</span><span class="p">]]);</span>
<span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">setRedirectUrl</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</code></pre></div></div><h2 id="redirect-off-site-to-a-third-party-url"> <a aria-labelledby="redirect-off-site-to-a-third-party-url" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-off-site-to-a-third-party-url"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect off-site (to a third-party URL)</h2><p>From <a href="https://drupal.stackexchange.com/questions/136641/how-do-i-redirect-to-an-external-url">https://drupal.stackexchange.com/questions/136641/how-do-i-redirect-to-an-external-url</a></p><p>Redirect to a third party website with Redirect permanent status. The URL must have absolute path like <a href="http://www.google.com">http://www.google.com</a></p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="k">new</span> <span class="nc">RedirectResponse</span><span class="p">(</span><span class="s1">'https://google.com'</span><span class="p">);</span>
</code></pre></div></div><p>e.g.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">Use</span> <span class="nc">Drupal\Core\Routing\TrustedRedirectResponse</span><span class="p">;</span>

<span class="nv">$absolute_url</span> <span class="o">=</span> <span class="s1">'https://google.com'</span><span class="p">;</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RedirectResponse</span><span class="p">(</span><span class="nv">$absolute_url</span><span class="p">,</span> <span class="mi">301</span><span class="p">);</span>
<span class="c1">//OR</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">\Drupal\Core\Routing\TrustedRedirectResponse</span><span class="p">(</span><span class="nv">$absolute_url</span><span class="p">,</span> <span class="mi">301</span><span class="p">);</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">send</span><span class="p">();</span>

<span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre></div></div><h2 id="redirect-to-an-existing-route-with-an-anchor-or-fragment"> <a aria-labelledby="redirect-to-an-existing-route-with-an-anchor-or-fragment" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-to-an-existing-route-with-an-anchor-or-fragment"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect to an existing route with an anchor (or fragment)</h2><p>You can specify the route using the route name from your module.routing.yml file.</p><p>Note. You can also redirect to a specific id (anchor) on the page by adding the fragment parameter</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">setRedirect</span><span class="p">(</span><span class="s1">'tra_teks_admin.timeline_detail'</span><span class="p">,</span> 
  <span class="p">[</span><span class="s1">'node'</span><span class="o">=&gt;</span><span class="nv">$parent_nid</span><span class="p">],</span> 
  <span class="p">[</span><span class="s1">'fragment'</span> <span class="o">=&gt;</span> <span class="s1">'milestone-'</span> <span class="mf">.</span> <span class="nv">$nid</span><span class="p">,]</span>
<span class="p">);</span>
</code></pre></div></div><h2 id="redirect-to-a-complex-route"> <a aria-labelledby="redirect-to-a-complex-route" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-to-a-complex-route"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect to a complex route</h2><p>Here the route requires four arguments so they all need to be passed in.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">setRedirectUrl</span><span class="p">(</span><span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'tra_teks_srp.confidential_voting'</span><span class="p">,</span> <span class="p">[</span>
  <span class="s1">'citadel_nid'</span> <span class="o">=&gt;</span> <span class="nv">$citadel_nid</span><span class="p">,</span>
  <span class="s1">'performance_nid'</span> <span class="o">=&gt;</span> <span class="nv">$performance_nid</span><span class="p">,</span>
  <span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s1">'vote'</span><span class="p">,</span>
  <span class="s1">'type'</span> <span class="o">=&gt;</span><span class="nv">$type</span><span class="p">,</span>
<span class="p">]));</span>
</code></pre></div></div><h2 id="redirect-in-a-controller"> <a aria-labelledby="redirect-in-a-controller" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-in-a-controller"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect in a controller</h2><p>When you need to send the user to a different page on your site based on some logic, you might use code something like this. Lots of processing happens and if the conditions are met, instead of returning a render array, we return a RedirectResponse and the browser will load that page.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">protected</span> <span class="k">function</span> <span class="n">reloadOperations</span><span class="p">():</span> <span class="kt">?RedirectResponse</span> <span class="p">{</span>
  <span class="nv">$program_nid</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">programNode</span><span class="o">-&gt;</span><span class="nf">id</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">action</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">===</span> <span class="s1">'reload'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$new_type</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$action</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">votingProcessor</span><span class="o">-&gt;</span><span class="nf">buildVotingPath</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">programNode</span><span class="p">,</span> <span class="nv">$new_type</span><span class="p">);</span>
    <span class="nv">$valid_voting_path</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">votingProcessor</span><span class="o">-&gt;</span><span class="nf">loadYourVotingPathFromTempStore</span><span class="p">(</span><span class="nv">$program_nid</span><span class="p">);</span>
    <span class="nv">$empty_voting_path</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">votingProcessor</span><span class="o">-&gt;</span><span class="nf">isEmptyVotingPath</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$valid_voting_path</span> <span class="o">&amp;&amp;</span> <span class="nv">$empty_voting_path</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Redirect to kss overview.</span>
      <span class="nv">$message</span> <span class="o">=</span> <span class="s2">"No eligible items found. Redirected to KSS overview"</span><span class="p">;</span>
      <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">messenger</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">addMessage</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
      <span class="nv">$url</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'tea_teks_srp.kss_overview'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'program'</span> <span class="o">=&gt;</span> <span class="nv">$program_nid</span><span class="p">,</span>
        <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'all'</span><span class="p">,</span>
        <span class="s1">'userid'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">persona</span><span class="o">-&gt;</span><span class="nf">getUserId</span><span class="p">(),</span>
      <span class="p">]);</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nc">RedirectResponse</span><span class="p">(</span><span class="nv">$url</span><span class="o">-&gt;</span><span class="nf">toString</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$valid_voting_path</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$empty_voting_path</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//redirect to the first item in the path.</span>
      <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">votingProcessor</span><span class="o">-&gt;</span><span class="nf">getFirstVotingPathItem</span><span class="p">();</span>
      <span class="nv">$vote_type</span> <span class="o">=</span> <span class="s1">'narrative'</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$item</span><span class="p">[</span><span class="s1">'narrative'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$vote_type</span> <span class="o">=</span> <span class="s1">'activity'</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nv">$url</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromRoute</span><span class="p">(</span><span class="s1">'tea_teks_srp.correlation_voting'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'program'</span> <span class="o">=&gt;</span> <span class="nv">$program_nid</span><span class="p">,</span>
        <span class="s1">'expectation'</span> <span class="o">=&gt;</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'expectation_nid'</span><span class="p">],</span>
        <span class="s1">'correlation'</span> <span class="o">=&gt;</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'correlation_nid'</span><span class="p">],</span>
        <span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s2">"vote-</span><span class="nv">$new_type</span><span class="s2">"</span><span class="p">,</span>
        <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="nv">$vote_type</span><span class="p">,</span>
      <span class="p">]);</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nc">RedirectResponse</span><span class="p">(</span><span class="nv">$url</span><span class="o">-&gt;</span><span class="nf">toString</span><span class="p">());</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div><h2 id="redirect-user-after-login"> <a aria-labelledby="redirect-user-after-login" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-user-after-login"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect user after login</h2><p>From: <a href="https://www.drupal.org/forum/support/module-development-and-code-questions/2013-08-18/how-to-redirect-user-after-login-in">https://www.drupal.org/forum/support/module-development-and-code-questions/2013-08-18/how-to-redirect-user-after-login-in</a> This example checks both the route and user role to conditionally redirect.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">Drupal\Core\Session\AccountInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Drupal\Core\Url</span><span class="p">;</span>

<span class="cd">/**
 * Implements hook_user_login().
 */</span>
<span class="k">function</span> <span class="n">greenacorn_user_login</span><span class="p">(</span><span class="kt">AccountInterface</span> <span class="nv">$account</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$roles</span> <span class="o">=</span> <span class="nv">$account</span><span class="o">-&gt;</span><span class="nf">getRoles</span><span class="p">();</span>
  <span class="nv">$route_name</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">routeMatch</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getRouteName</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$route_name</span> <span class="o">!=</span> <span class="s1">'user.reset.login'</span> <span class="o">&amp;&amp;</span> <span class="nb">in_array</span><span class="p">(</span><span class="s1">'client'</span><span class="p">,</span> <span class="nv">$roles</span><span class="p">))</span> 
  <span class="p">{</span>
    <span class="nv">$destination</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromUserInput</span><span class="p">(</span><span class="s1">'/my-issues'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">toString</span><span class="p">();</span>
    <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">service</span><span class="p">(</span><span class="s1">'request_stack'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">getCurrentRequest</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">query</span><span class="o">-&gt;</span><span class="nf">set</span><span class="p">(</span><span class="s1">'destination'</span><span class="p">,</span> <span class="nv">$destination</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="redirect-to-the-403-or-404-page"> <a aria-labelledby="redirect-to-the-403-or-404-page" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-to-the-403-or-404-page"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect to the 403 or 404 page</h2><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Redirect to the 403 page.</span>
<span class="k">throw</span> <span class="k">new</span> <span class="nc">\Symfony\Component\HttpKernel\Exception\AccessDeniedHttpException</span><span class="p">();</span>

<span class="c1">// Redirect to the 404 page.</span>
<span class="k">throw</span> <span class="k">new</span> <span class="nc">\Symfony\Component\HttpKernel\Exception\NotFoundHttpException</span><span class="p">();</span>
</code></pre></div></div><h2 id="redirect-to-a-new-page-after-node-operation"> <a aria-labelledby="redirect-to-a-new-page-after-node-operation" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-to-a-new-page-after-node-operation"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect to a new page after node operation</h2><p>This was implemented in a module in a hook_form_alter call. Here we tell the form to call the special handler: cn_submit_handler() function in the form.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">obg_mods_form_alter</span><span class="p">(</span><span class="kt">array</span> <span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">,</span> <span class="nv">$form_id</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$accountProxy</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">currentUser</span><span class="p">();</span>
  <span class="nv">$account</span> <span class="o">=</span> <span class="nv">$accountProxy</span><span class="o">-&gt;</span><span class="nf">getAccount</span><span class="p">();</span>

  <span class="c1">// Add special validation for anonymous users only.</span>
  <span class="k">if</span> <span class="p">((</span><span class="nv">$accountProxy</span><span class="o">-&gt;</span><span class="nf">isAnonymous</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$form_id</span> <span class="o">==</span> <span class="s1">'node_catastrophe_notice_form'</span><span class="p">)))</span> <span class="p">{</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">'#validate'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'cn_form_validate'</span><span class="p">;</span>

    <span class="c1">// Submit handler to redirect to /thanks-your-submission.</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nb">array_keys</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">])</span> <span class="k">as</span> <span class="nv">$action</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$action</span> <span class="o">!=</span> <span class="s1">'preview'</span> <span class="o">&amp;&amp;</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">][</span><span class="nv">$action</span><span class="p">][</span><span class="s1">'#type'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">][</span><span class="nv">$action</span><span class="p">][</span><span class="s1">'#type'</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'submit'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$form</span><span class="p">[</span><span class="s1">'actions'</span><span class="p">][</span><span class="nv">$action</span><span class="p">][</span><span class="s1">'#submit'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'cn_submit_handler'</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div><p>And here is the submit handler where the work gets done and you are redirected to /thanks-your-submission.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cd">/**
 * Submit handler to redirect user to thank-you page.
 *
 * @param $form
 * @param \Drupal\Core\Form\FormStateInterface $form_state
 */</span>
<span class="k">function</span> <span class="n">cn_submit_handler</span><span class="p">(</span> <span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$url</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromUri</span><span class="p">(</span><span class="s1">'internal:/thanks-your-submission'</span><span class="p">);</span>
  <span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">setRedirectUrl</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>More at <a href="https://drupal.stackexchange.com/questions/163626/how-to-perform-a-redirect-to-custom-page-after-node-save-or-delete">https://drupal.stackexchange.com/questions/163626/how-to-perform-a-redirect-to-custom-page-after-node-save-or-delete</a></p><h2 id="redirect-dynamically-to-wherever-you-came-from"> <a aria-labelledby="redirect-dynamically-to-wherever-you-came-from" class="anchor-heading" href="https://selwynpolit.github.io/d9book/redirects#redirect-dynamically-to-wherever-you-came-from"><svg aria-hidden="true" viewbox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a> Redirect dynamically to wherever you came from</h2><p>In this case, in a form, we grab the referrer url in the buildForm method using the following code:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">function</span> <span class="n">buildForm</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$form</span><span class="p">,</span> <span class="kt">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">,</span> <span class="kt">int</span> <span class="nv">$program_nid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="nv">$feedback_error_nid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="nv">$citation_nid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span>
  <span class="nv">$form</span><span class="p">[</span><span class="s1">'#theme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'tea_teks_srp__vote_error'</span><span class="p">;</span>

  <span class="c1">// Get the referer.</span>
  <span class="nv">$request</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">request</span><span class="p">();</span>
  <span class="nv">$referer</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="n">headers</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'referer'</span><span class="p">);</span>
  <span class="c1">//$base_url = Request::createFromGlobals()-&gt;getSchemeAndHttpHost();</span>
  <span class="nv">$base_url</span> <span class="o">=</span> <span class="nc">\Drupal</span><span class="o">::</span><span class="nf">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">getSchemeAndHttpHost</span><span class="p">();</span>
  <span class="nv">$alias</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$referer</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$alias</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$referer</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$base_url</span><span class="p">));</span>
  <span class="p">}</span>  
  <span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">set</span><span class="p">(</span><span class="s1">'referrer_alias'</span><span class="p">,</span> <span class="nv">$alias</span><span class="p">);</span>
  <span class="mf">...</span>
<span class="p">}</span>

</code></pre></div></div><p>Then in the submitForm() method, once we’ve completed the work we needed to do, we can redirect back to where we came from using the code below. We can optionally add a fragment which refers to an ID on the page.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nv">$referrer_alias</span> <span class="o">=</span> <span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'referrer_alias'</span><span class="p">);</span>

    <span class="c1">// Add the fragment so they drop back on the item they came from.</span>
    <span class="nv">$url</span> <span class="o">=</span> <span class="nc">Url</span><span class="o">::</span><span class="nf">fromUri</span><span class="p">(</span><span class="s1">'internal:'</span> <span class="mf">.</span> <span class="nv">$referrer_alias</span><span class="p">,</span> <span class="p">[</span><span class="s1">'fragment'</span> <span class="o">=&gt;</span> <span class="s2">"item_</span><span class="nv">$feedback_error_nid</span><span class="s2">"</span><span class="p">]);</span>
    <span class="nv">$form_state</span><span class="o">-&gt;</span><span class="nf">setRedirectUrl</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</code></pre></div></div><hr/> <script async="" crossorigin="anonymous" data-category="Q&amp;A" data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyMjY2NDE4" data-emit-metadata="0" data-input-position="bottom" data-lang="en" data-mapping="title" data-reactions-enabled="1" data-repo="selwynpolit/d9book" data-repo-id="MDEwOlJlcG9zaXRvcnkzMjUxNTQ1Nzg=" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js"> </script><hr/><footer><p><a href="https://selwynpolit.github.io/d9book/redirects#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0"><span xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"> <a href="http://www.selwynpolit.github.io/d9book" property="dct:title" rel="cc:attributionURL">Drupal at your fingertips</a> by <a href="http://www.drupal.org/u/selwynpolit" property="cc:attributionName" rel="cc:attributionURL dct:creator">Selwyn Polit</a> is licensed under <a href="http://creativecommons.org/licenses/by/4.0/" rel="license noopener noreferrer" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height:16px!important;vertical-align:text-bottom;"/> <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height:16px!important;vertical-align:text-bottom;"/> </a></span></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0 mr-2"> Page last modified: <span class="d-inline-block">Jun 22 2023</span>.</p><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/selwynpolit/d9book/tree/gh-pages/book/redirects.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
</body></link></meta></meta></meta></head></html>